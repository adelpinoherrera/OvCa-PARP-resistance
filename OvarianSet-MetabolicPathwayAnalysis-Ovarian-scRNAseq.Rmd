---
title: "OvarianSet-MetabolicPathwayAnalysis-Ovarian-scRNAseq"
output: pdf_document
---

OvarianSet with both approach 1 and 2 

#Approach 1 with and without harmony
##Import data

```{r}
#changes
library(future)
library(ggplot2)
library(bigmemory)
library(Seurat)
library(data.table)
library(dplyr)
library(rdetools)
# library(clustree)
sessionInfo()

plan("multiprocess", workers=16)

options(future.globals.maxSize=134217728000) ### for 128GB * 1024*1024

date = "_2022-04-11"
#figdirOrg = "./Resolution-of-1/OvarianSet_All-Samples_"
figdir <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Resolution-of-1/OvarianSet_Cell-Lines_'
metadir <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/OvarianSet_Approach1_Seurat-Metabolic-Analysis_'
metadir.H <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/OvarianSet_H_Approach1_Seurat-Metabolic-Analysis_'


#Approach 1
## Ovarian Set
OvarianSet.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Cell Cycle analysis/Approach 1/OvarianSet_after-CC-genes_SeuratObj_post-diversity-score_Approach1_2022-04-08.rds") #this does not have the CC difference
names(OvarianSet.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident"  
### Setting a cluster tab
OvarianSet.1$Cluster <- OvarianSet.1$RNA_snn_res.0.6
OvarianSet.1$name <- OvarianSet.1$orig.ident
names(OvarianSet.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident"       "Cluster"         "name"   

### Labelling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.1$name)
tmp1 <- as.matrix(OvarianSet.1$name)
numCells <- 5091
for (val in 1:numCells) {
### check name
   tmpname <- OvarianSet.1[[]][val,'name']
## from name set CMML or normal
  if (isTRUE(tmpname == "OVCA3_R" || tmpname == "OVCAR4_R")) {
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }


OvarianSetGrpd.1 <- OvarianSet.1
OvarianSetGrpd.1$samptype <- tmp1


names(OvarianSetGrpd.1[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_S"))
OVCA3.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_R"))
OVCAR4.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.1 <- c(OVCA3.1_S_cells, OVCA3.1_R_cells, OVCAR4.1_S_cells, OVCAR4.1_R_cells)

OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)

OvarianCellLineGrpd.1@active.ident <- OvarianCellLineGrpd.1$Cluster

Sonly.1 <- c(OVCA3.1_S_cells,OVCAR4.1_S_cells)
Ronly.1 <- c(OVCA3.1_R_cells,OVCAR4.1_R_cells)

OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))



##Ovarian Set Harmony
OvarianSet.H.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Cell Cycle analysis/Approach 1/OvarianSet_after_H-CC-genes_SeuratObj_post-diversity-score_Approach1_2022-04-08.rds")
names(OvarianSet.H.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident" 
### Setting a cluster tab
OvarianSet.H.1$Cluster <- OvarianSet.H.1$RNA_snn_res.0.6
OvarianSet.H.1$name <- OvarianSet.H.1$orig.ident
names(OvarianSet.H.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident"       "Cluster"         "name" 

### Labeling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.H.1$name)
tmp1 <- as.matrix(OvarianSet.H.1$name)
numCells <- 22710
for (val in 1:numCells) {
### check name
tmpname <- OvarianSet.H.1[[]][val,'name']
## from name set CMML or normal
if (tmpname == tmpname == "OVCA3_R" || tmpname == "OVCAR4_R"){
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }

OvarianSetGrpd.H.1 <- OvarianSet.H.1
OvarianSetGrpd.H.1$samptype <- tmp1

names(OvarianSetGrpd.H.1[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.H.1_S_cells <- WhichCells(OvarianSetGrpd.H.1, expression = (orig.ident=="OVCA3_S"))
OVCA3.H.1_R_cells <- WhichCells(OvarianSetGrpd.H.1, expression = (orig.ident=="OVCA3_R"))
OVCAR4.H.1_S_cells <- WhichCells(OvarianSetGrpd.H.1, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.H.1_R_cells <- WhichCells(OvarianSetGrpd.H.1, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.H.1 <- c(OVCA3.H.1_S_cells, OVCA3.H.1_R_cells, OVCAR4.H.1_S_cells, OVCAR4.H.1_R_cells)

OvarianCellLineGrpd.H.1 <- subset(x=OvarianSetGrpd.H.1, cells=celllinesonly.H.1)

OvarianCellLineGrpd.H.1@active.ident <- OvarianCellLineGrpd.H.1$Cluster

Sonly.H.1 <- c(OVCA3.H.1_S_cells,OVCAR4.H.1_S_cells)
Ronly.H.1 <- c(OVCA3.H.1_R_cells,OVCAR4.H.1_R_cells)

OvarianSensitiveCellLines.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=Sonly.H.1)
OvarianResistantCellLines.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=Ronly.H.1)

OVCAR4pair.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=c(OVCAR4.H.1_S_cells,OVCAR4.H.1_R_cells))
OVCA3pair.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=c(OVCA3.H.1_S_cells,OVCA3.H.1_R_cells))

```

##Metabolic pathway score analysis 
```{r}
OXPHOSgenes <- c('ATP12A', 'ATP4A', 'ATP4B', 'ATP5A1', 'ATP5B', 'ATP5C1', 'ATP5D', 'ATP5E', 'ATP5F1', 'ATP5G1', 'ATP5G1P5', 'ATP5G2', 'ATP5G3', 'ATP5H', 'ATP5I', 'ATP5J', 'ATP5J2', 'ATP5L', 'ATP5O', 'ATP6', 'ATP6AP1', 'ATP6V0A1', 'ATP6V0A2', 'ATP6V0A4', 'ATP6V0B', 'ATP6V0C', 'ATP6V0D1', 'ATP6V0D2', 'ATP6V0E1', 'ATP6V0E2', 'ATP6V1A', 'ATP6V1B1', 'ATP6V1B2', 'ATP6V1C1', 'ATP6V1C2', 'ATP6V1D', 'ATP6V1E1', 'ATP6V1E2', 'ATP6V1F', 'ATP6V1G1', 'ATP6V1G2', 'ATP6V1G3', 'ATP6V1H', 'ATP8', 'COX1', 'COX10', 'COX11', 'COX15', 'COX17', 'COX2', 'COX3', 'COX4I1', 'COX4I2', 'COX5A', 'COX5B', 'COX6A1', 'COX6A2', 'COX6B1', 'COX6B2', 'COX6C', 'COX6CP3', 'COX7A1', 'COX7A2', 'COX7A2L', 'COX7B', 'COX7B2', 'COX7C', 'COX8A', 'COX8C', 'CYC1', 'CYTB', 'LHPP', 'LOC100133737', 'LOC642502', 'LOC644310', 'LOC727947', 'ND1', 'ND2', 'ND3', 'ND4', 'ND4L', 'ND5', 'ND6', 'NDUFA1', 'NDUFA10', 'NDUFA11', 'NDUFA2', 'NDUFA3', 'NDUFA4', 'NDUFA4L2', 'NDUFA5', 'NDUFA6', 'NDUFA7', 'NDUFA8', 'NDUFA9', 'NDUFAB1', 'NDUFB1', 'NDUFB10', 'NDUFB2', 'NDUFB3', 'NDUFB4', 'NDUFB5', 'NDUFB6', 'NDUFB7', 'NDUFB8', 'NDUFB9', 'NDUFC1', 'NDUFC2', 'NDUFS1', 'NDUFS2', 'NDUFS3', 'NDUFS4', 'NDUFS5', 'NDUFS6', 'NDUFS7', 'NDUFS8', 'NDUFV1', 'NDUFV2', 'NDUFV3', 'PPA1', 'PPA2', 'SDHA', 'SDHB', 'SDHC', 'SDHD', 'TCIRG1', 'UQCR10', 'UQCR11', 'UQCRB', 'UQCRC1', 'UQCRC2', 'UQCRFS1', 'UQCRH', 'UQCRHL', 'UQCRQ')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(OXPHOSgenes), name = "OXPHOS", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: ATP5A1, ATP5B, ATP5C1, ATP5D, ATP5E, ATP5F1, ATP5G1, ATP5G1P5, ATP5G2, ATP5G3, ATP5H, ATP5I, ATP5J, ATP5J2, ATP5L, ATP5O, ATP6, ATP8, COX1, COX2, COX3, COX6CP3, CYTB, LOC100133737, LOC642502, LOC644310, LOC727947, ND1, ND2, ND3, ND4, ND4L, ND5, ND6, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(OXPHOSgenes), name = "OXPHOS", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: ATP5A1, ATP5B, ATP5C1, ATP5D, ATP5E, ATP5F1, ATP5G1, ATP5G1P5, ATP5G2, ATP5G3, ATP5H, ATP5I, ATP5J, ATP5J2, ATP5L, ATP5O, ATP6, ATP8, COX1, COX2, COX3, COX6CP3, CYTB, LOC100133737, LOC642502, LOC644310, LOC727947, ND1, ND2, ND3, ND4, ND4L, ND5, ND6, attempting to find updated synonyms


glycolysisGenes <- c('ACSS1', 'ACSS2', 'ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'AKR1A1', 'ALDH1A3', 'ALDH1B1', 'ALDH2', 'ALDH3A1', 'ALDH3A2', 'ALDH3B1', 'ALDH3B2', 'ALDH7A1', 'ALDH9A1', 'ALDOA', 'ALDOB', 'ALDOC', 'BPGM', 'DLAT', 'DLD', 'ENO1', 'ENO2', 'ENO3', 'FBP1', 'FBP2', 'G6PC', 'G6PC2', 'GALM', 'GAPDH', 'GCK', 'GPI', 'HK1', 'HK2', 'HK3', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'PFKL', 'PFKM', 'PFKP', 'PGAM1', 'PGAM2', 'PGAM4', 'PGK1', 'PGK2', 'PGM1', 'PGM2', 'PKLR', 'PKM2', 'TPI1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glycolysisGenes), name = "glycolysis", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glycolysisGenes), name = "glycolysis", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms


citricAcidGenes <- c('ACLY', 'ACO1', 'ACO2', 'CS', 'DLAT', 'DLD', 'DLST', 'FH', 'IDH1', 'IDH2', 'IDH3A', 'IDH3B', 'IDH3G', 'LOC283398', 'LOC642502', 'MDH1', 'MDH2', 'OGDH', 'OGDHL', 'PC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'SDHA', 'SDHB', 'SDHC', 'SDHD', 'SUCLA2', 'SUCLG1', 'SUCLG2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(citricAcidGenes), name = "citricAcid", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: LOC283398, LOC642502, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(citricAcidGenes), name = "citricAcid", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: LOC283398, LOC642502, attempting to find updated synonyms


ascorbAldarMet <- c('ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'MIOX', 'UGDH', 'UGT1A1', 'UGT1A10', 'UGT1A3', 'UGT1A4', 'UGT1A5', 'UGT1A6', 'UGT1A7', 'UGT1A8', 'UGT1A9', 'UGT2A1', 'UGT2A3', 'UGT2B10', 'UGT2B11', 'UGT2B15', 'UGT2B17', 'UGT2B28', 'UGT2B4', 'UGT2B7')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(ascorbAldarMet), name = "ascorbateAldarate", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(ascorbAldarMet), name = "ascorbateAldarate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


chondroitinSulfateBios <- c('B3GALT6', 'B3GAT1', 'B3GAT2', 'B3GAT3', 'B4GALT7', 'CHPF', 'CHPF2', 'CHST11', 'CHST12', 'CHST13', 'CHST14', 'CHST15', 'CHST3', 'CHST7', 'CHSY1', 'CHSY3', 'CSGALNACT1', 'CSGALNACT2', 'DSE', 'UST', 'XYLT1', 'XYLT2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(chondroitinSulfateBios), name = "chondroitinSulfate", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(chondroitinSulfateBios), name = "chondroitinsulfate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


fructMannMet <- c('AKR1B1', 'AKR1B10', 'ALDOA', 'ALDOB', 'ALDOC', 'FBP1', 'FBP2', 'FPGT', 'FUK', 'GMDS', 'GMPPA', 'GMPPB', 'HK1', 'HK2', 'HK3', 'KHK', 'MPI', 'MTMR1', 'MTMR2', 'MTMR6', 'MTMR7', 'PFKFB1', 'PFKFB2', 'PFKFB3', 'PFKFB4', 'PFKL', 'PFKM', 'PFKP', 'PHPT1', 'PMM1', 'PMM2', 'SORD', 'TPI1', 'TSTA3')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(fructMannMet), name = "fructoseMannose", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(fructMannMet), name = "fructoseMannose", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


galactose <- c('AKR1B1', 'B4GALT1', 'B4GALT2', 'G6PC', 'G6PC2', 'GAA', 'GALE', 'GALK1', 'GALK2', 'GALT', 'GANC', 'GCK', 'GLA', 'GLB1', 'HK1', 'HK2', 'HK3', 'LALBA', 'LCT', 'MGAM', 'PFKL', 'PFKM', 'PFKP', 'PGM1', 'PGM2', 'UGP2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(galactose), name = "galactose", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(galactose), name = "galactose", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


keratanSulfate <- c('B3GNT1', 'B3GNT2', 'B3GNT7', 'B4GALT1', 'B4GALT2', 'B4GALT3', 'B4GALT4', 'CHST1', 'CHST2', 'CHST4', 'CHST6', 'FUT8', 'ST3GAL1', 'ST3GAL2', 'ST3GAL3')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(keratanSulfate), name = "keratanSulfate", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: B3GNT1, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(keratanSulfate), name = "keratanSulfate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: B3GNT1, attempting to find updated synonyms


heparanSulfate <- c('B3GALT6', 'B3GAT1', 'B3GAT2', 'B3GAT3', 'B4GALT7', 'EXT1', 'EXT2', 'EXTL1', 'EXTL2', 'EXTL3', 'GLCE', 'HS2ST1', 'HS3ST1', 'HS3ST2', 'HS3ST3A1', 'HS3ST3B1', 'HS3ST5', 'HS6ST1', 'HS6ST2', 'HS6ST3', 'NDST1', 'NDST2', 'NDST3', 'NDST4', 'XYLT1', 'XYLT2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(heparanSulfate), name = "heparanSulfate", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(heparanSulfate), name = "heparanSulfate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


pentosePhosphate <- c('ALDOA', 'ALDOB', 'ALDOC', 'DERA', 'FBP1', 'FBP2', 'G6PD', 'GPI', 'H6PD', 'LOC729020', 'PFKL', 'PFKM', 'PFKP', 'PGD', 'PGLS', 'PGM1', 'PGM2', 'PRPS1', 'PRPS1L1', 'PRPS2', 'RBKS', 'RPE', 'RPIA', 'TALDO1', 'TKT', 'TKTL1', 'TKTL2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(pentosePhosphate), name = "pentosePhosphate", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: LOC729020, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(pentosePhosphate), name = "pentosePhosphate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: LOC729020, attempting to find updated synonyms


pyruvateMet <- c('ACACA', 'ACACB', 'ACAT1', 'ACAT2', 'ACOT12', 'ACSS1', 'ACSS2', 'ACYP1', 'ACYP2', 'AKR1B1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'DLAT', 'DLD', 'GLO1', 'GRHPR', 'HAGH', 'HAGHL', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'LDHD', 'MDH1', 'MDH2', 'ME1', 'ME2', 'ME3', 'PC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'PKLR', 'PKM2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(pyruvateMet), name = "pyruvateMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(pyruvateMet), name = "pyruvateMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms


starchSucrose <- c('AGL', 'AMY1A', 'AMY1B', 'AMY1C', 'AMY2A', 'AMY2B', 'ENPP1', 'ENPP3', 'G6PC', 'G6PC2', 'GAA', 'GANC', 'GBA3', 'GBE1', 'GCK', 'GPI', 'GUSB', 'GYS1', 'GYS2', 'HK1', 'HK2', 'HK3', 'MGAM', 'PGM1', 'PGM2', 'PGM2L1', 'PYGB', 'PYGL', 'PYGM', 'SI', 'TREH', 'UGDH', 'UGP2', 'UGT1A1', 'UGT1A10', 'UGT1A3', 'UGT1A4', 'UGT1A5', 'UGT1A6', 'UGT1A7', 'UGT1A8', 'UGT1A9', 'UGT2A1', 'UGT2A3', 'UGT2B10', 'UGT2B11', 'UGT2B15', 'UGT2B17', 'UGT2B28', 'UGT2B4', 'UGT2B7', 'UXS1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(starchSucrose), name = "starchSucrose", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: GBA3, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(starchSucrose), name = "starchSucrose", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: GBA3, attempting to find updated synonyms


etherLipidMet <- c('AGPS', 'CHPT1', 'ENPP2', 'ENPP6', 'JMJD7-PLA2G4B', 'LPCAT1', 'LPCAT2', 'LPCAT4', 'PAFAH1B1', 'PAFAH1B2', 'PAFAH1B3', 'PAFAH2', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PLA2G7', 'PLD1', 'PLD2', 'PPAP2A', 'PPAP2B', 'PPAP2C')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(etherLipidMet), name = "etherLipidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(etherLipidMet), name = "etherLipidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


arachidonicAcidMet <- c('AKR1C3', 'ALOX12', 'ALOX12B', 'ALOX15', 'ALOX15B', 'ALOX5', 'CBR1', 'CBR3', 'CYP2B6', 'CYP2C18', 'CYP2C19', 'CYP2C8', 'CYP2C9', 'CYP2E1', 'CYP2J2', 'CYP2U1', 'CYP4A11', 'CYP4A22', 'CYP4F2', 'CYP4F3', 'EPHX2', 'GGT1', 'GGT5', 'GGT6', 'GGT7', 'GPX1', 'GPX2', 'GPX3', 'GPX4', 'GPX5', 'GPX6', 'GPX7', 'HPGDS', 'JMJD7-PLA2G4B', 'LTA4H', 'LTC4S', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PTGDS', 'PTGES', 'PTGES2', 'PTGIS', 'PTGS1', 'PTGS2', 'TBXAS1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(arachidonicAcidMet), name = "arachidonicAcidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: GPX1, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(arachidonicAcidMet), name = "arachidonicAcidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: GPX1, attempting to find updated synonyms


fattyAcidMet <- c('ACAA1', 'ACAA2', 'ACADL', 'ACADM', 'ACADS', 'ACADSB', 'ACADVL', 'ACAT1', 'ACAT2', 'ACOX1', 'ACOX3', 'ACSL1', 'ACSL3', 'ACSL4', 'ACSL5', 'ACSL6', 'ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'CPT1A', 'CPT1B', 'CPT1C', 'CPT2', 'CYP4A11', 'CYP4A22', 'ECHS1', 'ECI1', 'ECI2', 'EHHADH', 'GCDH', 'HADH', 'HADHA', 'HADHB')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(fattyAcidMet), name = "fattyAcidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(fattyAcidMet), name = "fattyAcidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


glycerolipidMet <- c('AGK', 'AGPAT1', 'AGPAT2', 'AGPAT3', 'AGPAT4', 'AGPAT6', 'AGPAT9', 'AKR1A1', 'AKR1B1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'AWAT2', 'CEL', 'DAK', 'DGAT1', 'DGAT2', 'DGKA', 'DGKB', 'DGKD', 'DGKE', 'DGKG', 'DGKH', 'DGKI', 'DGKQ', 'DGKZ', 'GK', 'GK2', 'GLA', 'GLYCTK', 'GPAM', 'GPAT2', 'LCLAT1', 'LIPC', 'LIPF', 'LIPG', 'LPL', 'MBOAT1', 'MBOAT2', 'MGLL', 'PNLIP', 'PNLIPRP1', 'PNLIPRP2', 'PNPLA3', 'PPAP2A', 'PPAP2B', 'PPAP2C')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glycerolipidMet), name = "glycerolipidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, DAK, PNLIPRP2, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glycerolipidMet), name = "glycerolipidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, DAK, PNLIPRP2, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


glycerophospholipidMet <- c('ACHE', 'AGPAT1', 'AGPAT2', 'AGPAT3', 'AGPAT4', 'AGPAT6', 'AGPAT9', 'C17orf48', 'CDIPT', 'CDS1', 'CDS2', 'CHAT', 'CHKA', 'CHKB', 'CHPT1', 'CRLS1', 'DGKA', 'DGKB', 'DGKD', 'DGKE', 'DGKG', 'DGKH', 'DGKI', 'DGKQ', 'DGKZ', 'ETNK1', 'ETNK2', 'GNPAT', 'GPAM', 'GPAT2', 'GPD1', 'GPD1L', 'GPD2', 'JMJD7-PLA2G4B', 'LCAT', 'LCLAT1', 'LPCAT1', 'LPCAT2', 'LPCAT3', 'LPCAT4', 'LPGAT1', 'LYPLA1', 'LYPLA2', 'MBOAT1', 'MBOAT2', 'MBOAT7', 'PCYT1A', 'PCYT1B', 'PCYT2', 'PEMT', 'PGS1', 'PHOSPHO1', 'PISD', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G15', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PLD1', 'PLD2', 'PPAP2A', 'PPAP2B', 'PPAP2C', 'PTDSS1', 'PTDSS2', 'TAZ')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glycerophospholipidMet), name = "glycerophospholipidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, C17orf48, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glycerophospholipidMet), name = "glycerophospholipidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, C17orf48, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


glyoxylateDicarbMet <- c('ACO1', 'ACO2', 'AFMID', 'CS', 'GLYCTK', 'GRHPR', 'HAO1', 'HAO2', 'HYI', 'MDH1', 'MDH2', 'MTHFD1', 'MTHFD1L', 'MTHFD2', 'MTHFD2L', 'PGP')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glyoxylateDicarbMet), name = "glyoxylateDicarbMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glyoxylateDicarbMet), name = "glyoxylateDicarbMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


linoleicAcidMet <- c('AKR1B10', 'ALOX15', 'CYP1A2', 'CYP2C18', 'CYP2C19', 'CYP2C8', 'CYP2C9', 'CYP2E1', 'CYP2J2', 'CYP3A4', 'CYP3A43', 'CYP3A5', 'CYP3A7', 'JMJD7-PLA2G4B', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(linoleicAcidMet), name = "linoleicAcidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(linoleicAcidMet), name = "linoleicAcidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


sphingolipidMet <- c('ACER1', 'ACER2', 'ACER3', 'ARSA', 'ASAH1', 'ASAH2', 'ASAH2C', 'B4GALT6', 'CERK', 'DEGS1', 'DEGS2', 'ENPP7', 'GAL3ST1', 'GALC', 'GBA', 'GLA', 'GLB1', 'KDSR', 'NEU1', 'NEU2', 'NEU3', 'NEU4', 'PPAP2A', 'PPAP2B', 'PPAP2C', 'SGMS1', 'SGMS2', 'SGPL1', 'SGPP1', 'SGPP2', 'SMPD1', 'SMPD2', 'SMPD3', 'SMPD4', 'SPHK1', 'SPHK2', 'SPTLC1', 'SPTLC2', 'UGCG', 'UGT8')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(sphingolipidMet), name = "sphingolipidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: ASAH2C, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(sphingolipidMet), name = "sphingolipidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: ASAH2C, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


propanoateMet <- c('ABAT', 'ACACA', 'ACACB', 'ACADM', 'ACAT1', 'ACAT2', 'ACSS1', 'ACSS2', 'ACSS3', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH6A1', 'ALDH7A1', 'ALDH9A1', 'ECHS1', 'EHHADH', 'HADHA', 'HIBCH', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'LOC283398', 'MCEE', 'MLYCD', 'MUT', 'PCCA', 'PCCB', 'SUCLA2', 'SUCLG1', 'SUCLG2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(propanoateMet), name = "propanoateMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: LOC283398, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(propanoateMet), name = "propanoateMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: LOC283398, attempting to find updated synonyms


pyrimidineMet <- c('AK3', 'CAD', 'CANT1', 'CDA', 'CMPK1', 'CMPK2', 'CTPS', 'CTPS2', 'DCK', 'DCTD', 'DHODH', 'DPYD', 'DPYS', 'DTYMK', 'DUT', 'ENTPD1', 'ENTPD3', 'ENTPD4', 'ENTPD5', 'ENTPD6', 'ENTPD8', 'ITPA', 'NME1', 'NME1-NME2', 'NME2', 'NME3', 'NME4', 'NME5', 'NME6', 'NME7', 'NT5C', 'NT5C1A', 'NT5C1B', 'NT5C2', 'NT5C3', 'NT5E', 'NT5M', 'NUDT2', 'PNP', 'PNPT1', 'POLA1', 'POLA2', 'POLD1', 'POLD2', 'POLD3', 'POLD4', 'POLE', 'POLE2', 'POLE3', 'POLE4', 'POLR1A', 'POLR1B', 'POLR1C', 'POLR1D', 'POLR1E', 'POLR2A', 'POLR2B', 'POLR2C', 'POLR2D', 'POLR2E', 'POLR2F', 'POLR2G', 'POLR2H', 'POLR2I', 'POLR2J', 'POLR2J2', 'POLR2J3', 'POLR2K', 'POLR2L', 'POLR3A', 'POLR3B', 'POLR3C', 'POLR3D', 'POLR3F', 'POLR3G', 'POLR3GL', 'POLR3H', 'POLR3K', 'PRIM1', 'PRIM2', 'RRM1', 'RRM2', 'RRM2B', 'TK1', 'TK2', 'TXNRD1', 'TXNRD2', 'TYMP', 'TYMS', 'UCK1', 'UCK2', 'UCKL1', 'UMPS', 'UPB1', 'UPP1', 'UPP2', 'UPRT', 'ZNRD1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(pyrimidineMet), name = "pyrimidineMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: CTPS, NT5C3, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(pyrimidineMet), name = "pyrimidineMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: CTPS, NT5C3, attempting to find updated synonyms


purineMet <- c('ADA', 'ADCY1', 'ADCY10', 'ADCY2', 'ADCY3', 'ADCY4', 'ADCY5', 'ADCY6', 'ADCY7', 'ADCY8', 'ADCY9', 'ADK', 'ADSL', 'ADSS', 'ADSSL1', 'AK1', 'AK2', 'AK4', 'AK5', 'AK7', 'ALLC', 'AMPD1', 'AMPD2', 'AMPD3', 'APRT', 'ATIC', 'C17orf48', 'CANT1', 'DCK', 'DGUOK', 'ENPP1', 'ENPP3', 'ENTPD1', 'ENTPD2', 'ENTPD3', 'ENTPD4', 'ENTPD5', 'ENTPD6', 'ENTPD8', 'FHIT', 'GART', 'GDA', 'GMPR', 'GMPR2', 'GMPS', 'GUCY1A2', 'GUCY1A3', 'GUCY1B3', 'GUCY2C', 'GUCY2D', 'GUCY2F', 'GUK1', 'HPRT1', 'IMPDH1', 'IMPDH2', 'ITPA', 'NME1', 'NME1-NME2', 'NME2', 'NME3', 'NME4', 'NME5', 'NME6', 'NME7', 'NPR1', 'NPR2', 'NT5C', 'NT5C1A', 'NT5C1B', 'NT5C2', 'NT5C3', 'NT5E', 'NT5M', 'NUDT2', 'NUDT5', 'NUDT9', 'PAICS', 'PAPSS1', 'PAPSS2', 'PDE10A', 'PDE11A', 'PDE1A', 'PDE1B', 'PDE1C', 'PDE2A', 'PDE3A', 'PDE3B', 'PDE4A', 'PDE4B', 'PDE4C', 'PDE4D', 'PDE5A', 'PDE6A', 'PDE6B', 'PDE6C', 'PDE6D', 'PDE6G', 'PDE6H', 'PDE7A', 'PDE7B', 'PDE8A', 'PDE8B', 'PDE9A', 'PFAS', 'PKLR', 'PKM2', 'PNP', 'PNPT1', 'POLA1', 'POLA2', 'POLD1', 'POLD2', 'POLD3', 'POLD4', 'POLE', 'POLE2', 'POLE3', 'POLE4', 'POLR1A', 'POLR1B', 'POLR1C', 'POLR1D', 'POLR1E', 'POLR2A', 'POLR2B', 'POLR2C', 'POLR2D', 'POLR2E', 'POLR2F', 'POLR2G', 'POLR2H', 'POLR2I', 'POLR2J', 'POLR2J2', 'POLR2J3', 'POLR2K', 'POLR2L', 'POLR3A', 'POLR3B', 'POLR3C', 'POLR3D', 'POLR3F', 'POLR3G', 'POLR3GL', 'POLR3H', 'POLR3K', 'PPAT', 'PRHOXNB', 'PRIM1', 'PRIM2', 'PRPS1', 'PRPS1L1', 'PRPS2', 'PRUNE', 'RRM1', 'RRM2', 'RRM2B', 'XDH', 'ZNRD1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(purineMet), name = "purineMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: C17orf48, GUCY1A3, GUCY1B3, NT5C3, PKM2, PRHOXNB, PRUNE, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(purineMet), name = "purineMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: C17orf48, GUCY1A3, GUCY1B3, NT5C3, PKM2, PRHOXNB, PRUNE, attempting to find updated synonyms


alaniAspratGlutamMet <- c('ABAT', 'ACY3', 'ADSL', 'ADSS', 'ADSSL1', 'AGXT', 'AGXT2', 'ALDH4A1', 'ALDH5A1', 'ASL', 'ASNS', 'ASPA', 'ASS1', 'CAD', 'CPS1', 'DDO', 'GAD1', 'GAD2', 'GFPT1', 'GFPT2', 'GLS', 'GLS2', 'GLUD1', 'GLUD2', 'GLUL', 'GOT1', 'GOT2', 'GPT', 'GPT2', 'IL4I1', 'NIT2', 'PPAT')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(alaniAspratGlutamMet), name = "alaniAspratGlutamMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(alaniAspratGlutamMet), name = "alaniAspratGlutamMet", search=TRUE)


arginineProlineMet <- c('ABP1', 'ACY1', 'ADC', 'AGMAT', 'ALDH18A1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH4A1', 'ALDH7A1', 'ALDH9A1', 'AMD1', 'ARG1', 'ARG2', 'ASL', 'ASS1', 'CKB', 'CKM', 'CKMT1A', 'CKMT1B', 'CKMT2', 'CPS1', 'DAO', 'GAMT', 'GATM', 'GLS', 'GLS2', 'GLUD1', 'GLUD2', 'GLUL', 'GOT1', 'GOT2', 'LAP3', 'MAOA', 'MAOB', 'NAGS', 'NOS1', 'NOS2', 'NOS3', 'OAT', 'ODC1', 'OTC', 'P4HA1', 'P4HA2', 'P4HA3', 'PRODH', 'PRODH2', 'PYCR1', 'PYCR2', 'PYCRL', 'SAT1', 'SAT2', 'SMS', 'SRM')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(arginineProlineMet), name = "arginineProlineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, ADC, PYCRL, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(arginineProlineMet), name = "arginineProlineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, ADC, PYCRL, attempting to find updated synonyms


butanoateMet <- c('AACS', 'ABAT', 'ACADS', 'ACAT1', 'ACAT2', 'ACSM1', 'ACSM2A', 'ACSM3', 'ACSM4', 'ACSM5', 'AKR1B10', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH5A1', 'ALDH7A1', 'ALDH9A1', 'BDH1', 'BDH2', 'ECHS1', 'EHHADH', 'GAD1', 'GAD2', 'HADH', 'HADHA', 'HMGCL', 'HMGCS1', 'HMGCS2', 'L2HGDH', 'OXCT1', 'OXCT2', 'PDHA1', 'PDHA2', 'PDHB')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(butanoateMet), name = "butanoateMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(butanoateMet), name = "butanoateMet", search=TRUE)


glutathioneMet <- c('ANPEP', 'G6PD', 'GCLC', 'GCLM', 'GGCT', 'GGT1', 'GGT5', 'GGT6', 'GGT7', 'GPX1', 'GPX2', 'GPX3', 'GPX4', 'GPX5', 'GPX6', 'GPX7', 'GSR', 'GSS', 'GSTA1', 'GSTA2', 'GSTA3', 'GSTA4', 'GSTA5', 'GSTK1', 'GSTM1', 'GSTM2', 'GSTM3', 'GSTM4', 'GSTM5', 'GSTO1', 'GSTO2', 'GSTP1', 'GSTT1', 'GSTT2', 'GSTZ1', 'IDH1', 'IDH2', 'LAP3', 'MGST1', 'MGST2', 'MGST3', 'ODC1', 'OPLAH', 'PGD', 'RRM1', 'RRM2', 'RRM2B', 'SMS', 'SRM', 'TXNDC12')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glutathioneMet), name = "glutathioneMet", search=TRUE)
#Warning: The following features are not present in the object: GPX1, GSTT1, GSTT2, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glutathioneMet), name = "glutathioneMet", search=TRUE)
#Warning: The following features are not present in the object: GPX1, GSTT1, GSTT2, attempting to find updated synonyms


glycineSerineThreonMet <- c('AGXT', 'AGXT2', 'ALAS1', 'ALAS2', 'AMT', 'AOC2', 'AOC3', 'BHMT', 'CBS', 'CHDH', 'CTH', 'DAO', 'DLD', 'DMGDH', 'GAMT', 'GATM', 'GCAT', 'GLDC', 'GLYCTK', 'GNMT', 'MAOA', 'MAOB', 'PHGDH', 'PIPOX', 'PSAT1', 'PSPH', 'SARDH', 'SDS', 'SHMT1', 'SHMT2', 'SRR')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glycineSerineThreonMet), name = "glycineSerineThreonMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glycineSerineThreonMet), name = "glycineSerineThreonMet", search=TRUE)


histidineMet <- c('ABP1', 'ACY3', 'ALDH1A3', 'ALDH1B1', 'ALDH2', 'ALDH3A1', 'ALDH3A2', 'ALDH3B1', 'ALDH3B2', 'ALDH7A1', 'ALDH9A1', 'AMDHD1', 'ASPA', 'CNDP1', 'DDC', 'FTCD', 'HAL', 'HDC', 'HEMK1', 'HNMT', 'LCMT1', 'LCMT2', 'MAOA', 'MAOB', 'METTL2B', 'METTL6', 'TRMT11', 'UROC1', 'WBSCR22')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(histidineMet), name = "histidineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, WBSCR22, attempting to find updated synonyms
OvarianSetGrpd.H.1<- AddModuleScore(OvarianSetGrpd.H.1, features = list(histidineMet), name = "histidineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, WBSCR22, attempting to find updated synonyms


lysineDeg <- c('AADAT', 'AASDH', 'AASDHPPT', 'AASS', 'ACAT1', 'ACAT2', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'ASH1L', 'BBOX1', 'DLST', 'DOT1L', 'ECHS1', 'EHHADH', 'EHMT1', 'EHMT2', 'GCDH', 'HADH', 'HADHA', 'NSD1', 'OGDH', 'OGDHL', 'PIPOX', 'PLOD1', 'PLOD2', 'PLOD3', 'SETD1A', 'SETD1B', 'SETD2', 'SETD7', 'SETD8', 'SETDB1', 'SETDB2', 'SETMAR', 'SUV39H1', 'SUV39H2', 'SUV420H1', 'SUV420H2', 'TMLHE', 'WHSC1', 'WHSC1L1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(lysineDeg), name = "lysineDeg", search=TRUE)
#Warning: The following features are not present in the object: SETD8, SUV420H1, SUV420H2, WHSC1, WHSC1L1, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(lysineDeg), name = "lysineDeg", search=TRUE)
#Warning: The following features are not present in the object: SETD8, SUV420H1, SUV420H2, WHSC1, WHSC1L1, attempting to find updated synonyms


cysteineMethionineMet <- c('ADI1', 'AHCY', 'AHCYL1', 'AHCYL2', 'AMD1', 'APIP', 'BHMT', 'CBS', 'CDO1', 'CTH', 'DNMT1', 'DNMT3A', 'DNMT3B', 'DNMT3L', 'ENOPH1', 'GOT1', 'GOT2', 'IL4I1', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'MAT1A', 'MAT2A', 'MAT2B', 'MPST', 'MTAP', 'MTR', 'SDS', 'SMS', 'SRM', 'TAT', 'TRDMT1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(cysteineMethionineMet), name = "cysteineMethionineMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(cysteineMethionineMet), name = "cysteineMethionineMet", search=TRUE)


phenylalanineMet <- c('ALDH1A3', 'ALDH3A1', 'ALDH3B1', 'ALDH3B2', 'AOC2', 'AOC3', 'DDC', 'GOT1', 'GOT2', 'HPD', 'IL4I1', 'MAOA', 'MAOB', 'MIF', 'NAT6', 'PAH', 'PRDX6', 'TAT')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(phenylalanineMet), name = "phenylalanineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(phenylalanineMet), name = "phenylalanineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, attempting to find updated synonyms


taurineHypotaurMet <- c('ADO', 'BAAT', 'CDO1', 'CSAD', 'GAD1', 'GAD2', 'GGT1', 'GGT5', 'GGT6', 'GGT7')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(taurineHypotaurMet), name = "taurineHypotaurMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(taurineHypotaurMet), name = "taurineHypotaurMet", search=TRUE)


aminoacyltRNAbios <- c('AARS', 'AARS2', 'CARS', 'CARS2', 'DARS', 'DARS2', 'EARS2', 'EPRS', 'FARS2', 'FARSA', 'FARSB', 'GARS', 'HARS', 'HARS2', 'IARS', 'IARS2', 'KARS', 'LARS', 'LARS2', 'MARS', 'MARS2', 'MTFMT', 'NARS', 'NARS2', 'PARS2', 'PSTK', 'QARS', 'RARS', 'RARS2', 'SARS', 'SARS2', 'SEPSECS', 'TARS', 'TARS2', 'TARSL2', 'VARS', 'VARS2', 'WARS', 'WARS2', 'YARS', 'YARS2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(aminoacyltRNAbios), name = "aminoacyltRNAbios", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(aminoacyltRNAbios), name = "aminoacyltRNAbios", search=TRUE)


tryptophanMet <- c('AADAT', 'AANAT', 'ABP1', 'ACAT1', 'ACAT2', 'ACMSD', 'AFMID', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'AOX1', 'ASMT', 'CAT', 'CYP1A1', 'CYP1A2', 'CYP1B1', 'DDC', 'ECHS1', 'EHHADH', 'GCDH', 'HAAO', 'HADH', 'HADHA', 'IDO1', 'IDO2', 'IL4I1', 'INMT', 'KMO', 'KYNU', 'MAOA', 'MAOB', 'OGDH', 'OGDHL', 'TDO2', 'TPH1', 'TPH2', 'WARS', 'WARS2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(tryptophanMet), name = "tryptophanMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(tryptophanMet), name = "tryptophanMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, attempting to find updated synonyms


tyrosineMet <- c('ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'ALDH1A3', 'ALDH3A1', 'ALDH3B1', 'ALDH3B2', 'AOC2', 'AOC3', 'AOX1', 'COMT', 'DBH', 'DCT', 'DDC', 'FAH', 'GOT1', 'GOT2', 'GSTZ1', 'HEMK1', 'HGD', 'HPD', 'IL4I1', 'LCMT1', 'LCMT2', 'MAOA', 'MAOB', 'METTL2B', 'METTL6', 'MIF', 'NAT6', 'PNMT', 'TAT', 'TH', 'TPO', 'TRMT11', 'TYR', 'TYRP1', 'WBSCR22')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(tyrosineMet), name = "tyrosineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, WBSCR22, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(tyrosineMet), name = "tyrosineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, WBSCR22, attempting to find updated synonyms


valineLeucineIsoleucBios <- c('BCAT1', 'BCAT2', 'IARS', 'IARS2', 'LARS', 'LARS2', 'PDHA1', 'PDHA2', 'PDHB', 'VARS', 'VARS2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(valineLeucineIsoleucBios), name = "valineLeucineIsoleucBios", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(valineLeucineIsoleucBios), name = "valineLeucineIsoleucBios", search=TRUE)

names(OvarianSetGrpd.1[[]])
names(OvarianSetGrpd.H.1[[]])

saveRDS(OvarianSetGrpd.1, paste(metadir,"SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))
saveRDS(OvarianSetGrpd.H.1, paste(metadir.H,"SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))



### Make per sample subsets and export all scores for the sample
OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)
OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))


OvarianCellLineGrpd.H.1 <- subset(x=OvarianSetGrpd.H.1, cells=celllinesonly.H.1)
OvarianSensitiveCellLines.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=Sonly.H.1)
OvarianResistantCellLines.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=Ronly.H.1)

OVCAR4pair.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=c(OVCAR4.H.1_S_cells,OVCAR4.H.1_R_cells))
OVCA3pair.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=c(OVCA3.H.1_S_cells,OVCA3.H.1_R_cells))
```

##AFTER CALCULATING SCORES, SUBSET BY TYPE, THEN COMPUTE AVERAGE SCORE PER CELL LINE & EXPORT INDIVIDUAL SCORES

```{r}
OVCAR4.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_S_cells)
OVCAR4.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_R_cells)
OVCA3.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_S_cells)
OVCA3.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_R_cells)

OVCAR4.H.1_S <- subset(x=OvarianSetGrpd.H.1, cells=OVCAR4.H.1_S_cells)
OVCAR4.H.1_R <- subset(x=OvarianSetGrpd.H.1, cells=OVCAR4.H.1_R_cells)
OVCA3.H.1_S <- subset(x=OvarianSetGrpd.H.1, cells=OVCA3.H.1_S_cells)
OVCA3.H.1_R <- subset(x=OvarianSetGrpd.H.1, cells=OVCA3.H.1_R_cells)

scores.1 <- c("OXPHOS1","glycolysis1","citricAcid1","ascorbateAldarate1","chondroitinSulfate1","fructoseMannose1","galactose1","keratanSulfate1","heparanSulfate1","pentosePhosphate1","pyruvateMet1","starchSucrose1","etherLipidMet1","arachidonicAcidMet1","fattyAcidMet1","glycerolipidMet1","glycerophospholipidMet1","glyoxylateDicarbMet1","linoleicAcidMet1","sphingolipidMet1","propanoateMet1","pyrimidineMet1","purineMet1","alaniAspratGlutamMet1","arginineProlineMet1","butanoateMet1","glutathioneMet1","glycineSerineThreonMet1","histidineMet1","lysineDeg1","cysteineMethionineMet1","phenylalanineMet1","taurineHypotaurMet1","aminoacyltRNAbios1","tryptophanMet1","tyrosineMet1","valineLeucineIsoleucBios1")

scores.H.1 <- c("OXPHOS1","glycolysis1","citricAcid1","ascorbateAldarate1","chondroitinsulfate1","fructoseMannose1","galactose1","keratanSulfate1","heparanSulfate1","pentosePhosphate1","pyruvateMet1","starchSucrose1","etherLipidMet1","arachidonicAcidMet1","fattyAcidMet1","glycerolipidMet1","glycerophospholipidMet1","glyoxylateDicarbMet1","linoleicAcidMet1","sphingolipidMet1","propanoateMet1","pyrimidineMet1","purineMet1","alaniAspratGlutamMet1","arginineProlineMet1","butanoateMet1","glutathioneMet1","glycineSerineThreonMet1","histidineMet1","lysineDeg1","cysteineMethionineMet1","phenylalanineMet1","taurineHypotaurMet1","aminoacyltRNAbios1","tryptophanMet1","tyrosineMet1","valineLeucineIsoleucBios1")


averageScores.1 <- function(arg_1, arg_2) {
   # arg_1 == Seurat object 
   # arg_2 == string for use in exporting scores

# export data
  data_scores.1 <- as.data.frame(as.matrix(arg_1[[scores.1]]))

  fwrite(x = data_scores.1, file = paste(metadir,arg_2,"_scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

  tmp <- list()
  for (val in 1:37)
  {
    tmp[[scores.1[val]]] <- mean(unlist(data_scores.1[val]))
  }
  tmp

  fwrite(x = as.data.frame(tmp), file = paste(metadir,arg_2,"_average-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

 }




rm(arg_1,arg_2,tmp,val)

averageScoresH.1 <- function(arg_1, arg_2) {
   # arg_1 == Seurat object 
   # arg_2 == string for use in exporting scores

# export data
  data_scores.1 <- as.data.frame(as.matrix(arg_1[[scores.H.1]]))

  fwrite(x = data_scores.1, file = paste(metadir.H,arg_2,"_scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

  tmp <- list()
  for (val in 1:36)
  {
    tmp[[scores.H.1[val]]] <- mean(unlist(data_scores.1[val]))
  }
  tmp

  fwrite(x = as.data.frame(tmp), file = paste(metadir.H,arg_2,"_average-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

 }

rm(arg_1,arg_2,tmp,val)

# Call the functions
averageScores.1(OVCAR4.1_S,"OVCAR4_S")
averageScores.1(OVCAR4.1_R,"OVCAR4_R")
averageScores.1(OVCA3.1_S,"OVCA3_S")
averageScores.1(OVCA3.1_R,"OVCA3_R")

averageScoresH.1(OVCAR4.H.1_S,"OVCAR4_S")
averageScoresH.1(OVCAR4.H.1_R,"OVCAR4_R")
averageScoresH.1(OVCA3.H.1_S,"OVCA3_S")
averageScoresH.1(OVCA3.H.1_R,"OVCA3_R")


```
##Do UMAPs
```{r}
#Ovarian Set 
pdf(paste(metadir,"UMAP_OXPHOS-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='OXPHOS1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Glycolysis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='glycolysis1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Citric-Acid-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='citricAcid1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Ascorbate-Aldarate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='ascorbateAldarate1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Chondroitin-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='chondroitinSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Fructose-Mannose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='fructoseMannose1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Galactose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='galactose1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Keratan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='keratanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Heparan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='heparanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Pentose-Phosphate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='pentosePhosphate1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Pyruvate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='pyruvateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Starch-Sucrose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='starchSucrose1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Ether-Lipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='etherLipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Arachidonic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='arachidonicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Fatty-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='fattyAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Glycerolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='glycerolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Glycerophospholipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='glycerophospholipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Glyoxylate-Dicarb-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='glyoxylateDicarbMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Linoleic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='linoleicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Sphingolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='sphingolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Propanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='propanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Pyrimidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='pyrimidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Purine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='purineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Alani-Asprat-Glutam-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='alaniAspratGlutamMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Arginine-Proline-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='arginineProlineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Butanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='butanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Glutathione-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='glutathioneMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Glycine-Serine-Threon-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='glycineSerineThreonMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Histidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='histidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Lysine-Degradation-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='lysineDeg1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Cysteine-Methionine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='cysteineMethionineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Phenylalanine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='phenylalanineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Taurine-Hypotaur-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='taurineHypotaurMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_aminoacyl-tRNA-biosynthesis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='aminoacyltRNAbios1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Tryptophan-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='tryptophanMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Tyrosine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='tyrosineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir,"UMAP_Valine-Leucine-Isoleucine-Biosynthesis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='valineLeucineIsoleucBios1') 
print(dPlot)
dev.off()



#Ovarian Set Harmony
pdf(paste(metadir.H,"UMAP_OXPHOS-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='OXPHOS1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Glycolysis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='glycolysis1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Citric-Acid-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='citricAcid1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Ascorbate-Aldarate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='ascorbateAldarate1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Chondroitin-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='chondroitinsulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Fructose-Mannose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='fructoseMannose1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Galactose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='galactose1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Keratan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='keratanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Heparan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='heparanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Pentose-Phosphate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='pentosePhosphate1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Pyruvate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='pyruvateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Starch-Sucrose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='starchSucrose1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Ether-Lipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='etherLipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Arachidonic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='arachidonicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Fatty-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='fattyAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Glycerolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='glycerolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Glycerophospholipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='glycerophospholipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Glyoxylate-Dicarb-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='glyoxylateDicarbMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Linoleic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='linoleicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Sphingolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='sphingolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Propanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='propanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Pyrimidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='pyrimidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Purine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='purineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Alani-Asprat-Glutam-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='alaniAspratGlutamMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Arginine-Proline-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='arginineProlineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Butanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='butanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Glutathione-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='glutathioneMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Glycine-Serine-Threon-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='glycineSerineThreonMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Histidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='histidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Lysine-Degradation-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='lysineDeg1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Cysteine-Methionine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='cysteineMethionineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Phenylalanine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='phenylalanineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Taurine-Hypotaur-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='taurineHypotaurMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_aminoacyl-tRNA-biosynthesis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='aminoacyltRNAbios1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Tryptophan-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='tryptophanMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Tyrosine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='tyrosineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir.H,"UMAP_Valine-Leucine-Isoleucine-Biosynthesis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.1, features='valineLeucineIsoleucBios1') 
print(dPlot)
dev.off()
```








#Approach 2 
## Import data 
```{r}
library(future)
library(ggplot2)
library(bigmemory)
library(Seurat)
library(data.table)
library(dplyr)
library(rdetools)
# library(clustree)
sessionInfo()

plan("multiprocess", workers=16)

options(future.globals.maxSize=134217728000) ### for 128GB * 1024*1024
#memory.limit(size = 35000)

date = "_2022-04-12"
#figdirOrg = "./Resolution-of-1/OvarianSet_All-Samples_"
figdir <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Resolution-of-1/OvarianSet_Cell-Lines_'
metadir2 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Approach 2/OvarianSet_Approach2_Seurat-Metabolic-Analysis_'
metadir2.H <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Approach 2/OvarianSet_H_Approach2_Seurat-Metabolic-Analysis_'


##Ovarian Set 
OvarianSet.2 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Purine Metabolism/OvarianSet_before-CC-genes_SeuratObj_thrStep8_post-res0.6-clustering_2022-04-08.rds")
names(OvarianSet.2[[]])
#[1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "S.Score"         "G2M.Score"       "Phase"           "old.ident"      
#[9] "CC.Difference"   "RNA_snn_res.0.6" "seurat_clusters"
OvarianSet.2$Cluster <- OvarianSet.2$RNA_snn_res.0.6
OvarianSet.2$name <- OvarianSet.2$orig.ident
names(OvarianSet.2[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "S.Score"         "G2M.Score"       "Phase"           "old.ident"      
# [9] "CC.Difference"   "RNA_snn_res.0.6" "seurat_clusters" "Cluster"         "name"   

### Labelling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.2$name)
tmp1 <- as.matrix(OvarianSet.2$name)
numCells <- 5091
for (val in 1:numCells) {
### check name
   tmpname <- OvarianSet.2[[]][val,'name']
## from name set CMML or normal
  if (isTRUE(tmpname == "OVCA3_R" || tmpname == "OVCAR4_R")) {
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }


OvarianSetGrpd.2 <- OvarianSet.2
OvarianSetGrpd.2$samptype <- tmp1

names(OvarianSetGrpd.2[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.2_S_cells <- WhichCells(OvarianSetGrpd.2, expression = (orig.ident=="OVCA3_S"))
OVCA3.2_R_cells <- WhichCells(OvarianSetGrpd.2, expression = (orig.ident=="OVCA3_R"))
OVCAR4.2_S_cells <- WhichCells(OvarianSetGrpd.2, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.2_R_cells <- WhichCells(OvarianSetGrpd.2, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.2 <- c(OVCA3.2_S_cells, OVCA3.2_R_cells, OVCAR4.2_S_cells, OVCAR4.2_R_cells)

OvarianCellLineGrpd.2 <- subset(x=OvarianSetGrpd.2, cells=celllinesonly.2)

OvarianCellLineGrpd.2@active.ident <- OvarianCellLineGrpd.2$Cluster

Sonly.2 <- c(OVCA3.2_S_cells,OVCAR4.2_S_cells)
Ronly.2 <- c(OVCA3.2_R_cells,OVCAR4.2_R_cells)

OvarianSensitiveCellLines.2 <- subset(x=OvarianCellLineGrpd.2, cells=Sonly.2)
OvarianResistantCellLines.2 <- subset(x=OvarianCellLineGrpd.2, cells=Ronly.2)

OVCAR4pair.2 <- subset(x=OvarianCellLineGrpd.2, cells=c(OVCAR4.2_S_cells,OVCAR4.2_R_cells))
OVCA3pair.2 <- subset(x=OvarianCellLineGrpd.2, cells=c(OVCA3.2_S_cells,OVCA3.2_R_cells))



##Ovarian Set Harmony
OvarianSet.H.2 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Cell Cycle analysis/Approach 2/OvarianSet_before_H-CC-genes_SeuratObj_thrStep8_post-res0.6-clustering_2022-04-08.rds")
names(OvarianSet.H.2[[]])
#[1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "S.Score"         "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  [10] "RNA_snn_res.0.6" "seurat_clusters"
OvarianSet.H.2$Cluster <- OvarianSet.H.2$RNA_snn_res.0.6
OvarianSet.H.2$name <- OvarianSet.H.2$orig.ident
names(OvarianSet.H.2[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "S.Score"         "G2M.Score"       "Phase"           "old.ident"      
# [9] "CC.Difference"   "RNA_snn_res.0.6" "seurat_clusters" "Cluster"         "name"  

### Labelling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.H.2$name)
tmp1 <- as.matrix(OvarianSet.H.2$name)
numCells <- 5091
for (val in 1:numCells) {
### check name
   tmpname <- OvarianSet.H.2[[]][val,'name']
## from name set CMML or normal
  if (isTRUE(tmpname == "OVCA3_R" || tmpname == "OVCAR4_R")) {
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }


OvarianSetGrpd.H.2 <- OvarianSet.H.2
OvarianSetGrpd.H.2$samptype <- tmp1

names(OvarianSetGrpd.H.2[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.H.2_S_cells <- WhichCells(OvarianSetGrpd.H.2, expression = (orig.ident=="OVCA3_S"))
OVCA3.H.2_R_cells <- WhichCells(OvarianSetGrpd.H.2, expression = (orig.ident=="OVCA3_R"))
OVCAR4.H.2_S_cells <- WhichCells(OvarianSetGrpd.H.2, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.H.2_R_cells <- WhichCells(OvarianSetGrpd.H.2, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.H.2 <- c(OVCA3.H.2_S_cells, OVCA3.H.2_R_cells, OVCAR4.H.2_S_cells, OVCAR4.H.2_R_cells)

OvarianCellLineGrpd.H.2 <- subset(x=OvarianSetGrpd.H.2, cells=celllinesonly.H.2)

OvarianCellLineGrpd.H.2@active.ident <- OvarianCellLineGrpd.H.2$Cluster

Sonly.H.2 <- c(OVCA3.H.2_S_cells,OVCAR4.H.2_S_cells)
Ronly.H.2 <- c(OVCA3.H.2_R_cells,OVCAR4.H.2_R_cells)

OvarianSensitiveCellLines.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=Sonly.H.2)
OvarianResistantCellLines.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=Ronly.H.2)

OVCAR4pair.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=c(OVCAR4.H.2_S_cells,OVCAR4.H.2_R_cells))
OVCA3pair.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=c(OVCA3.H.2_S_cells,OVCA3.H.2_R_cells))
```

##Metabolic pathway score analysis 
```{r}
OXPHOSgenes <- c('ATP12A', 'ATP4A', 'ATP4B', 'ATP5A1', 'ATP5B', 'ATP5C1', 'ATP5D', 'ATP5E', 'ATP5F1', 'ATP5G1', 'ATP5G1P5', 'ATP5G2', 'ATP5G3', 'ATP5H', 'ATP5I', 'ATP5J', 'ATP5J2', 'ATP5L', 'ATP5O', 'ATP6', 'ATP6AP1', 'ATP6V0A1', 'ATP6V0A2', 'ATP6V0A4', 'ATP6V0B', 'ATP6V0C', 'ATP6V0D1', 'ATP6V0D2', 'ATP6V0E1', 'ATP6V0E2', 'ATP6V1A', 'ATP6V1B1', 'ATP6V1B2', 'ATP6V1C1', 'ATP6V1C2', 'ATP6V1D', 'ATP6V1E1', 'ATP6V1E2', 'ATP6V1F', 'ATP6V1G1', 'ATP6V1G2', 'ATP6V1G3', 'ATP6V1H', 'ATP8', 'COX1', 'COX10', 'COX11', 'COX15', 'COX17', 'COX2', 'COX3', 'COX4I1', 'COX4I2', 'COX5A', 'COX5B', 'COX6A1', 'COX6A2', 'COX6B1', 'COX6B2', 'COX6C', 'COX6CP3', 'COX7A1', 'COX7A2', 'COX7A2L', 'COX7B', 'COX7B2', 'COX7C', 'COX8A', 'COX8C', 'CYC1', 'CYTB', 'LHPP', 'LOC100133737', 'LOC642502', 'LOC644310', 'LOC727947', 'ND1', 'ND2', 'ND3', 'ND4', 'ND4L', 'ND5', 'ND6', 'NDUFA1', 'NDUFA10', 'NDUFA11', 'NDUFA2', 'NDUFA3', 'NDUFA4', 'NDUFA4L2', 'NDUFA5', 'NDUFA6', 'NDUFA7', 'NDUFA8', 'NDUFA9', 'NDUFAB1', 'NDUFB1', 'NDUFB10', 'NDUFB2', 'NDUFB3', 'NDUFB4', 'NDUFB5', 'NDUFB6', 'NDUFB7', 'NDUFB8', 'NDUFB9', 'NDUFC1', 'NDUFC2', 'NDUFS1', 'NDUFS2', 'NDUFS3', 'NDUFS4', 'NDUFS5', 'NDUFS6', 'NDUFS7', 'NDUFS8', 'NDUFV1', 'NDUFV2', 'NDUFV3', 'PPA1', 'PPA2', 'SDHA', 'SDHB', 'SDHC', 'SDHD', 'TCIRG1', 'UQCR10', 'UQCR11', 'UQCRB', 'UQCRC1', 'UQCRC2', 'UQCRFS1', 'UQCRH', 'UQCRHL', 'UQCRQ')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(OXPHOSgenes), name = "OXPHOS", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: ATP5A1, ATP5B, ATP5C1, ATP5D, ATP5E, ATP5F1, ATP5G1, ATP5G1P5, ATP5G2, ATP5G3, ATP5H, ATP5I, ATP5J, ATP5J2, ATP5L, ATP5O, ATP6, ATP8, COX1, COX2, COX3, COX6CP3, CYTB, LOC100133737, LOC642502, LOC644310, LOC727947, ND1, ND2, ND3, ND4, ND4L, ND5, ND6, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(OXPHOSgenes), name = "OXPHOS", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: ATP5A1, ATP5B, ATP5C1, ATP5D, ATP5E, ATP5F1, ATP5G1, ATP5G1P5, ATP5G2, ATP5G3, ATP5H, ATP5I, ATP5J, ATP5J2, ATP5L, ATP5O, ATP6, ATP8, COX1, COX2, COX3, COX6CP3, CYTB, LOC100133737, LOC642502, LOC644310, LOC727947, ND1, ND2, ND3, ND4, ND4L, ND5, ND6, attempting to find updated synonyms


glycolysisGenes <- c('ACSS1', 'ACSS2', 'ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'AKR1A1', 'ALDH1A3', 'ALDH1B1', 'ALDH2', 'ALDH3A1', 'ALDH3A2', 'ALDH3B1', 'ALDH3B2', 'ALDH7A1', 'ALDH9A1', 'ALDOA', 'ALDOB', 'ALDOC', 'BPGM', 'DLAT', 'DLD', 'ENO1', 'ENO2', 'ENO3', 'FBP1', 'FBP2', 'G6PC', 'G6PC2', 'GALM', 'GAPDH', 'GCK', 'GPI', 'HK1', 'HK2', 'HK3', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'PFKL', 'PFKM', 'PFKP', 'PGAM1', 'PGAM2', 'PGAM4', 'PGK1', 'PGK2', 'PGM1', 'PGM2', 'PKLR', 'PKM2', 'TPI1')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glycolysisGenes), name = "glycolysis", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glycolysisGenes), name = "glycolysis", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms


citricAcidGenes <- c('ACLY', 'ACO1', 'ACO2', 'CS', 'DLAT', 'DLD', 'DLST', 'FH', 'IDH1', 'IDH2', 'IDH3A', 'IDH3B', 'IDH3G', 'LOC283398', 'LOC642502', 'MDH1', 'MDH2', 'OGDH', 'OGDHL', 'PC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'SDHA', 'SDHB', 'SDHC', 'SDHD', 'SUCLA2', 'SUCLG1', 'SUCLG2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(citricAcidGenes), name = "citricAcid", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: LOC283398, LOC642502, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(citricAcidGenes), name = "citricAcid", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: LOC283398, LOC642502, attempting to find updated synonyms


ascorbAldarMet <- c('ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'MIOX', 'UGDH', 'UGT1A1', 'UGT1A10', 'UGT1A3', 'UGT1A4', 'UGT1A5', 'UGT1A6', 'UGT1A7', 'UGT1A8', 'UGT1A9', 'UGT2A1', 'UGT2A3', 'UGT2B10', 'UGT2B11', 'UGT2B15', 'UGT2B17', 'UGT2B28', 'UGT2B4', 'UGT2B7')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(ascorbAldarMet), name = "ascorbateAldarate", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(ascorbAldarMet), name = "ascorbateAldarate", search=TRUE)
names(OvarianSetGrpd.H.2[[]])


chondroitinSulfateBios <- c('B3GALT6', 'B3GAT1', 'B3GAT2', 'B3GAT3', 'B4GALT7', 'CHPF', 'CHPF2', 'CHST11', 'CHST12', 'CHST13', 'CHST14', 'CHST15', 'CHST3', 'CHST7', 'CHSY1', 'CHSY3', 'CSGALNACT1', 'CSGALNACT2', 'DSE', 'UST', 'XYLT1', 'XYLT2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(chondroitinSulfateBios), name = "chondroitinSulfate", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(chondroitinSulfateBios), name = "chondroitinsulfate", search=TRUE)
names(OvarianSetGrpd.H.2[[]])


fructMannMet <- c('AKR1B1', 'AKR1B10', 'ALDOA', 'ALDOB', 'ALDOC', 'FBP1', 'FBP2', 'FPGT', 'FUK', 'GMDS', 'GMPPA', 'GMPPB', 'HK1', 'HK2', 'HK3', 'KHK', 'MPI', 'MTMR1', 'MTMR2', 'MTMR6', 'MTMR7', 'PFKFB1', 'PFKFB2', 'PFKFB3', 'PFKFB4', 'PFKL', 'PFKM', 'PFKP', 'PHPT1', 'PMM1', 'PMM2', 'SORD', 'TPI1', 'TSTA3')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(fructMannMet), name = "fructoseMannose", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(fructMannMet), name = "fructoseMannose", search=TRUE)
names(OvarianSetGrpd.H.2[[]])


galactose <- c('AKR1B1', 'B4GALT1', 'B4GALT2', 'G6PC', 'G6PC2', 'GAA', 'GALE', 'GALK1', 'GALK2', 'GALT', 'GANC', 'GCK', 'GLA', 'GLB1', 'HK1', 'HK2', 'HK3', 'LALBA', 'LCT', 'MGAM', 'PFKL', 'PFKM', 'PFKP', 'PGM1', 'PGM2', 'UGP2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(galactose), name = "galactose", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(galactose), name = "galactose", search=TRUE)
names(OvarianSetGrpd.H.2[[]])


keratanSulfate <- c('B3GNT1', 'B3GNT2', 'B3GNT7', 'B4GALT1', 'B4GALT2', 'B4GALT3', 'B4GALT4', 'CHST1', 'CHST2', 'CHST4', 'CHST6', 'FUT8', 'ST3GAL1', 'ST3GAL2', 'ST3GAL3')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(keratanSulfate), name = "keratanSulfate", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: B3GNT1, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(keratanSulfate), name = "keratanSulfate", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: B3GNT1, attempting to find updated synonyms


heparanSulfate <- c('B3GALT6', 'B3GAT1', 'B3GAT2', 'B3GAT3', 'B4GALT7', 'EXT1', 'EXT2', 'EXTL1', 'EXTL2', 'EXTL3', 'GLCE', 'HS2ST1', 'HS3ST1', 'HS3ST2', 'HS3ST3A1', 'HS3ST3B1', 'HS3ST5', 'HS6ST1', 'HS6ST2', 'HS6ST3', 'NDST1', 'NDST2', 'NDST3', 'NDST4', 'XYLT1', 'XYLT2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(heparanSulfate), name = "heparanSulfate", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(heparanSulfate), name = "heparanSulfate", search=TRUE)
names(OvarianSetGrpd.H.2[[]])


pentosePhosphate <- c('ALDOA', 'ALDOB', 'ALDOC', 'DERA', 'FBP1', 'FBP2', 'G6PD', 'GPI', 'H6PD', 'LOC729020', 'PFKL', 'PFKM', 'PFKP', 'PGD', 'PGLS', 'PGM1', 'PGM2', 'PRPS1', 'PRPS1L1', 'PRPS2', 'RBKS', 'RPE', 'RPIA', 'TALDO1', 'TKT', 'TKTL1', 'TKTL2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(pentosePhosphate), name = "pentosePhosphate", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: LOC729020, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(pentosePhosphate), name = "pentosePhosphate", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: LOC729020, attempting to find updated synonyms


pyruvateMet <- c('ACACA', 'ACACB', 'ACAT1', 'ACAT2', 'ACOT12', 'ACSS1', 'ACSS2', 'ACYP1', 'ACYP2', 'AKR1B1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'DLAT', 'DLD', 'GLO1', 'GRHPR', 'HAGH', 'HAGHL', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'LDHD', 'MDH1', 'MDH2', 'ME1', 'ME2', 'ME3', 'PC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'PKLR', 'PKM2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(pyruvateMet), name = "pyruvateMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(pyruvateMet), name = "pyruvateMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms


starchSucrose <- c('AGL', 'AMY1A', 'AMY1B', 'AMY1C', 'AMY2A', 'AMY2B', 'ENPP1', 'ENPP3', 'G6PC', 'G6PC2', 'GAA', 'GANC', 'GBA3', 'GBE1', 'GCK', 'GPI', 'GUSB', 'GYS1', 'GYS2', 'HK1', 'HK2', 'HK3', 'MGAM', 'PGM1', 'PGM2', 'PGM2L1', 'PYGB', 'PYGL', 'PYGM', 'SI', 'TREH', 'UGDH', 'UGP2', 'UGT1A1', 'UGT1A10', 'UGT1A3', 'UGT1A4', 'UGT1A5', 'UGT1A6', 'UGT1A7', 'UGT1A8', 'UGT1A9', 'UGT2A1', 'UGT2A3', 'UGT2B10', 'UGT2B11', 'UGT2B15', 'UGT2B17', 'UGT2B28', 'UGT2B4', 'UGT2B7', 'UXS1')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(starchSucrose), name = "starchSucrose", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: GBA3, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(starchSucrose), name = "starchSucrose", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: GBA3, attempting to find updated synonyms


etherLipidMet <- c('AGPS', 'CHPT1', 'ENPP2', 'ENPP6', 'JMJD7-PLA2G4B', 'LPCAT1', 'LPCAT2', 'LPCAT4', 'PAFAH1B1', 'PAFAH1B2', 'PAFAH1B3', 'PAFAH2', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PLA2G7', 'PLD1', 'PLD2', 'PPAP2A', 'PPAP2B', 'PPAP2C')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(etherLipidMet), name = "etherLipidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(etherLipidMet), name = "etherLipidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


arachidonicAcidMet <- c('AKR1C3', 'ALOX12', 'ALOX12B', 'ALOX15', 'ALOX15B', 'ALOX5', 'CBR1', 'CBR3', 'CYP2B6', 'CYP2C18', 'CYP2C19', 'CYP2C8', 'CYP2C9', 'CYP2E1', 'CYP2J2', 'CYP2U1', 'CYP4A11', 'CYP4A22', 'CYP4F2', 'CYP4F3', 'EPHX2', 'GGT1', 'GGT5', 'GGT6', 'GGT7', 'GPX1', 'GPX2', 'GPX3', 'GPX4', 'GPX5', 'GPX6', 'GPX7', 'HPGDS', 'JMJD7-PLA2G4B', 'LTA4H', 'LTC4S', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PTGDS', 'PTGES', 'PTGES2', 'PTGIS', 'PTGS1', 'PTGS2', 'TBXAS1')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(arachidonicAcidMet), name = "arachidonicAcidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: GPX1, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(arachidonicAcidMet), name = "arachidonicAcidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: GPX1, attempting to find updated synonyms


fattyAcidMet <- c('ACAA1', 'ACAA2', 'ACADL', 'ACADM', 'ACADS', 'ACADSB', 'ACADVL', 'ACAT1', 'ACAT2', 'ACOX1', 'ACOX3', 'ACSL1', 'ACSL3', 'ACSL4', 'ACSL5', 'ACSL6', 'ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'CPT1A', 'CPT1B', 'CPT1C', 'CPT2', 'CYP4A11', 'CYP4A22', 'ECHS1', 'ECI1', 'ECI2', 'EHHADH', 'GCDH', 'HADH', 'HADHA', 'HADHB')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(fattyAcidMet), name = "fattyAcidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(fattyAcidMet), name = "fattyAcidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])


glycerolipidMet <- c('AGK', 'AGPAT1', 'AGPAT2', 'AGPAT3', 'AGPAT4', 'AGPAT6', 'AGPAT9', 'AKR1A1', 'AKR1B1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'AWAT2', 'CEL', 'DAK', 'DGAT1', 'DGAT2', 'DGKA', 'DGKB', 'DGKD', 'DGKE', 'DGKG', 'DGKH', 'DGKI', 'DGKQ', 'DGKZ', 'GK', 'GK2', 'GLA', 'GLYCTK', 'GPAM', 'GPAT2', 'LCLAT1', 'LIPC', 'LIPF', 'LIPG', 'LPL', 'MBOAT1', 'MBOAT2', 'MGLL', 'PNLIP', 'PNLIPRP1', 'PNLIPRP2', 'PNPLA3', 'PPAP2A', 'PPAP2B', 'PPAP2C')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glycerolipidMet), name = "glycerolipidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, DAK, PNLIPRP2, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glycerolipidMet), name = "glycerolipidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, DAK, PNLIPRP2, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


glycerophospholipidMet <- c('ACHE', 'AGPAT1', 'AGPAT2', 'AGPAT3', 'AGPAT4', 'AGPAT6', 'AGPAT9', 'C17orf48', 'CDIPT', 'CDS1', 'CDS2', 'CHAT', 'CHKA', 'CHKB', 'CHPT1', 'CRLS1', 'DGKA', 'DGKB', 'DGKD', 'DGKE', 'DGKG', 'DGKH', 'DGKI', 'DGKQ', 'DGKZ', 'ETNK1', 'ETNK2', 'GNPAT', 'GPAM', 'GPAT2', 'GPD1', 'GPD1L', 'GPD2', 'JMJD7-PLA2G4B', 'LCAT', 'LCLAT1', 'LPCAT1', 'LPCAT2', 'LPCAT3', 'LPCAT4', 'LPGAT1', 'LYPLA1', 'LYPLA2', 'MBOAT1', 'MBOAT2', 'MBOAT7', 'PCYT1A', 'PCYT1B', 'PCYT2', 'PEMT', 'PGS1', 'PHOSPHO1', 'PISD', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G15', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PLD1', 'PLD2', 'PPAP2A', 'PPAP2B', 'PPAP2C', 'PTDSS1', 'PTDSS2', 'TAZ')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glycerophospholipidMet), name = "glycerophospholipidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, C17orf48, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glycerophospholipidMet), name = "glycerophospholipidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, C17orf48, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


glyoxylateDicarbMet <- c('ACO1', 'ACO2', 'AFMID', 'CS', 'GLYCTK', 'GRHPR', 'HAO1', 'HAO2', 'HYI', 'MDH1', 'MDH2', 'MTHFD1', 'MTHFD1L', 'MTHFD2', 'MTHFD2L', 'PGP')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glyoxylateDicarbMet), name = "glyoxylateDicarbMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glyoxylateDicarbMet), name = "glyoxylateDicarbMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])


linoleicAcidMet <- c('AKR1B10', 'ALOX15', 'CYP1A2', 'CYP2C18', 'CYP2C19', 'CYP2C8', 'CYP2C9', 'CYP2E1', 'CYP2J2', 'CYP3A4', 'CYP3A43', 'CYP3A5', 'CYP3A7', 'JMJD7-PLA2G4B', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(linoleicAcidMet), name = "linoleicAcidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(linoleicAcidMet), name = "linoleicAcidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])


sphingolipidMet <- c('ACER1', 'ACER2', 'ACER3', 'ARSA', 'ASAH1', 'ASAH2', 'ASAH2C', 'B4GALT6', 'CERK', 'DEGS1', 'DEGS2', 'ENPP7', 'GAL3ST1', 'GALC', 'GBA', 'GLA', 'GLB1', 'KDSR', 'NEU1', 'NEU2', 'NEU3', 'NEU4', 'PPAP2A', 'PPAP2B', 'PPAP2C', 'SGMS1', 'SGMS2', 'SGPL1', 'SGPP1', 'SGPP2', 'SMPD1', 'SMPD2', 'SMPD3', 'SMPD4', 'SPHK1', 'SPHK2', 'SPTLC1', 'SPTLC2', 'UGCG', 'UGT8')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(sphingolipidMet), name = "sphingolipidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: ASAH2C, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(sphingolipidMet), name = "sphingolipidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: ASAH2C, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


propanoateMet <- c('ABAT', 'ACACA', 'ACACB', 'ACADM', 'ACAT1', 'ACAT2', 'ACSS1', 'ACSS2', 'ACSS3', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH6A1', 'ALDH7A1', 'ALDH9A1', 'ECHS1', 'EHHADH', 'HADHA', 'HIBCH', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'LOC283398', 'MCEE', 'MLYCD', 'MUT', 'PCCA', 'PCCB', 'SUCLA2', 'SUCLG1', 'SUCLG2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(propanoateMet), name = "propanoateMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: LOC283398, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(propanoateMet), name = "propanoateMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: LOC283398, attempting to find updated synonyms


pyrimidineMet <- c('AK3', 'CAD', 'CANT1', 'CDA', 'CMPK1', 'CMPK2', 'CTPS', 'CTPS2', 'DCK', 'DCTD', 'DHODH', 'DPYD', 'DPYS', 'DTYMK', 'DUT', 'ENTPD1', 'ENTPD3', 'ENTPD4', 'ENTPD5', 'ENTPD6', 'ENTPD8', 'ITPA', 'NME1', 'NME1-NME2', 'NME2', 'NME3', 'NME4', 'NME5', 'NME6', 'NME7', 'NT5C', 'NT5C1A', 'NT5C1B', 'NT5C2', 'NT5C3', 'NT5E', 'NT5M', 'NUDT2', 'PNP', 'PNPT1', 'POLA1', 'POLA2', 'POLD1', 'POLD2', 'POLD3', 'POLD4', 'POLE', 'POLE2', 'POLE3', 'POLE4', 'POLR1A', 'POLR1B', 'POLR1C', 'POLR1D', 'POLR1E', 'POLR2A', 'POLR2B', 'POLR2C', 'POLR2D', 'POLR2E', 'POLR2F', 'POLR2G', 'POLR2H', 'POLR2I', 'POLR2J', 'POLR2J2', 'POLR2J3', 'POLR2K', 'POLR2L', 'POLR3A', 'POLR3B', 'POLR3C', 'POLR3D', 'POLR3F', 'POLR3G', 'POLR3GL', 'POLR3H', 'POLR3K', 'PRIM1', 'PRIM2', 'RRM1', 'RRM2', 'RRM2B', 'TK1', 'TK2', 'TXNRD1', 'TXNRD2', 'TYMP', 'TYMS', 'UCK1', 'UCK2', 'UCKL1', 'UMPS', 'UPB1', 'UPP1', 'UPP2', 'UPRT', 'ZNRD1')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(pyrimidineMet), name = "pyrimidineMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: CTPS, NT5C3, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(pyrimidineMet), name = "pyrimidineMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: CTPS, NT5C3, attempting to find updated synonyms


purineMet <- c('ADA', 'ADCY1', 'ADCY10', 'ADCY2', 'ADCY3', 'ADCY4', 'ADCY5', 'ADCY6', 'ADCY7', 'ADCY8', 'ADCY9', 'ADK', 'ADSL', 'ADSS', 'ADSSL1', 'AK1', 'AK2', 'AK4', 'AK5', 'AK7', 'ALLC', 'AMPD1', 'AMPD2', 'AMPD3', 'APRT', 'ATIC', 'C17orf48', 'CANT1', 'DCK', 'DGUOK', 'ENPP1', 'ENPP3', 'ENTPD1', 'ENTPD2', 'ENTPD3', 'ENTPD4', 'ENTPD5', 'ENTPD6', 'ENTPD8', 'FHIT', 'GART', 'GDA', 'GMPR', 'GMPR2', 'GMPS', 'GUCY1A2', 'GUCY1A3', 'GUCY1B3', 'GUCY2C', 'GUCY2D', 'GUCY2F', 'GUK1', 'HPRT1', 'IMPDH1', 'IMPDH2', 'ITPA', 'NME1', 'NME1-NME2', 'NME2', 'NME3', 'NME4', 'NME5', 'NME6', 'NME7', 'NPR1', 'NPR2', 'NT5C', 'NT5C1A', 'NT5C1B', 'NT5C2', 'NT5C3', 'NT5E', 'NT5M', 'NUDT2', 'NUDT5', 'NUDT9', 'PAICS', 'PAPSS1', 'PAPSS2', 'PDE10A', 'PDE11A', 'PDE1A', 'PDE1B', 'PDE1C', 'PDE2A', 'PDE3A', 'PDE3B', 'PDE4A', 'PDE4B', 'PDE4C', 'PDE4D', 'PDE5A', 'PDE6A', 'PDE6B', 'PDE6C', 'PDE6D', 'PDE6G', 'PDE6H', 'PDE7A', 'PDE7B', 'PDE8A', 'PDE8B', 'PDE9A', 'PFAS', 'PKLR', 'PKM2', 'PNP', 'PNPT1', 'POLA1', 'POLA2', 'POLD1', 'POLD2', 'POLD3', 'POLD4', 'POLE', 'POLE2', 'POLE3', 'POLE4', 'POLR1A', 'POLR1B', 'POLR1C', 'POLR1D', 'POLR1E', 'POLR2A', 'POLR2B', 'POLR2C', 'POLR2D', 'POLR2E', 'POLR2F', 'POLR2G', 'POLR2H', 'POLR2I', 'POLR2J', 'POLR2J2', 'POLR2J3', 'POLR2K', 'POLR2L', 'POLR3A', 'POLR3B', 'POLR3C', 'POLR3D', 'POLR3F', 'POLR3G', 'POLR3GL', 'POLR3H', 'POLR3K', 'PPAT', 'PRHOXNB', 'PRIM1', 'PRIM2', 'PRPS1', 'PRPS1L1', 'PRPS2', 'PRUNE', 'RRM1', 'RRM2', 'RRM2B', 'XDH', 'ZNRD1')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(purineMet), name = "purineMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: C17orf48, GUCY1A3, GUCY1B3, NT5C3, PKM2, PRHOXNB, PRUNE, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(purineMet), name = "purineMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: C17orf48, GUCY1A3, GUCY1B3, NT5C3, PKM2, PRHOXNB, PRUNE, attempting to find updated synonyms


alaniAspratGlutamMet <- c('ABAT', 'ACY3', 'ADSL', 'ADSS', 'ADSSL1', 'AGXT', 'AGXT2', 'ALDH4A1', 'ALDH5A1', 'ASL', 'ASNS', 'ASPA', 'ASS1', 'CAD', 'CPS1', 'DDO', 'GAD1', 'GAD2', 'GFPT1', 'GFPT2', 'GLS', 'GLS2', 'GLUD1', 'GLUD2', 'GLUL', 'GOT1', 'GOT2', 'GPT', 'GPT2', 'IL4I1', 'NIT2', 'PPAT')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(alaniAspratGlutamMet), name = "alaniAspratGlutamMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(alaniAspratGlutamMet), name = "alaniAspratGlutamMet", search=TRUE)


arginineProlineMet <- c('ABP1', 'ACY1', 'ADC', 'AGMAT', 'ALDH18A1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH4A1', 'ALDH7A1', 'ALDH9A1', 'AMD1', 'ARG1', 'ARG2', 'ASL', 'ASS1', 'CKB', 'CKM', 'CKMT1A', 'CKMT1B', 'CKMT2', 'CPS1', 'DAO', 'GAMT', 'GATM', 'GLS', 'GLS2', 'GLUD1', 'GLUD2', 'GLUL', 'GOT1', 'GOT2', 'LAP3', 'MAOA', 'MAOB', 'NAGS', 'NOS1', 'NOS2', 'NOS3', 'OAT', 'ODC1', 'OTC', 'P4HA1', 'P4HA2', 'P4HA3', 'PRODH', 'PRODH2', 'PYCR1', 'PYCR2', 'PYCRL', 'SAT1', 'SAT2', 'SMS', 'SRM')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(arginineProlineMet), name = "arginineProlineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, ADC, PYCRL, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(arginineProlineMet), name = "arginineProlineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, ADC, PYCRL, attempting to find updated synonyms


butanoateMet <- c('AACS', 'ABAT', 'ACADS', 'ACAT1', 'ACAT2', 'ACSM1', 'ACSM2A', 'ACSM3', 'ACSM4', 'ACSM5', 'AKR1B10', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH5A1', 'ALDH7A1', 'ALDH9A1', 'BDH1', 'BDH2', 'ECHS1', 'EHHADH', 'GAD1', 'GAD2', 'HADH', 'HADHA', 'HMGCL', 'HMGCS1', 'HMGCS2', 'L2HGDH', 'OXCT1', 'OXCT2', 'PDHA1', 'PDHA2', 'PDHB')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(butanoateMet), name = "butanoateMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(butanoateMet), name = "butanoateMet", search=TRUE)


glutathioneMet <- c('ANPEP', 'G6PD', 'GCLC', 'GCLM', 'GGCT', 'GGT1', 'GGT5', 'GGT6', 'GGT7', 'GPX1', 'GPX2', 'GPX3', 'GPX4', 'GPX5', 'GPX6', 'GPX7', 'GSR', 'GSS', 'GSTA1', 'GSTA2', 'GSTA3', 'GSTA4', 'GSTA5', 'GSTK1', 'GSTM1', 'GSTM2', 'GSTM3', 'GSTM4', 'GSTM5', 'GSTO1', 'GSTO2', 'GSTP1', 'GSTT1', 'GSTT2', 'GSTZ1', 'IDH1', 'IDH2', 'LAP3', 'MGST1', 'MGST2', 'MGST3', 'ODC1', 'OPLAH', 'PGD', 'RRM1', 'RRM2', 'RRM2B', 'SMS', 'SRM', 'TXNDC12')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glutathioneMet), name = "glutathioneMet", search=TRUE)
#Warning: The following features are not present in the object: GPX1, GSTT1, GSTT2, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glutathioneMet), name = "glutathioneMet", search=TRUE)
#Warning: The following features are not present in the object: GPX1, GSTT1, GSTT2, attempting to find updated synonyms


glycineSerineThreonMet <- c('AGXT', 'AGXT2', 'ALAS1', 'ALAS2', 'AMT', 'AOC2', 'AOC3', 'BHMT', 'CBS', 'CHDH', 'CTH', 'DAO', 'DLD', 'DMGDH', 'GAMT', 'GATM', 'GCAT', 'GLDC', 'GLYCTK', 'GNMT', 'MAOA', 'MAOB', 'PHGDH', 'PIPOX', 'PSAT1', 'PSPH', 'SARDH', 'SDS', 'SHMT1', 'SHMT2', 'SRR')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glycineSerineThreonMet), name = "glycineSerineThreonMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glycineSerineThreonMet), name = "glycineSerineThreonMet", search=TRUE)


histidineMet <- c('ABP1', 'ACY3', 'ALDH1A3', 'ALDH1B1', 'ALDH2', 'ALDH3A1', 'ALDH3A2', 'ALDH3B1', 'ALDH3B2', 'ALDH7A1', 'ALDH9A1', 'AMDHD1', 'ASPA', 'CNDP1', 'DDC', 'FTCD', 'HAL', 'HDC', 'HEMK1', 'HNMT', 'LCMT1', 'LCMT2', 'MAOA', 'MAOB', 'METTL2B', 'METTL6', 'TRMT11', 'UROC1', 'WBSCR22')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(histidineMet), name = "histidineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, WBSCR22, attempting to find updated synonyms
OvarianSetGrpd.H.2<- AddModuleScore(OvarianSetGrpd.H.2, features = list(histidineMet), name = "histidineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, WBSCR22, attempting to find updated synonyms


lysineDeg <- c('AADAT', 'AASDH', 'AASDHPPT', 'AASS', 'ACAT1', 'ACAT2', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'ASH1L', 'BBOX1', 'DLST', 'DOT1L', 'ECHS1', 'EHHADH', 'EHMT1', 'EHMT2', 'GCDH', 'HADH', 'HADHA', 'NSD1', 'OGDH', 'OGDHL', 'PIPOX', 'PLOD1', 'PLOD2', 'PLOD3', 'SETD1A', 'SETD1B', 'SETD2', 'SETD7', 'SETD8', 'SETDB1', 'SETDB2', 'SETMAR', 'SUV39H1', 'SUV39H2', 'SUV420H1', 'SUV420H2', 'TMLHE', 'WHSC1', 'WHSC1L1')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(lysineDeg), name = "lysineDeg", search=TRUE)
#Warning: The following features are not present in the object: SETD8, SUV420H1, SUV420H2, WHSC1, WHSC1L1, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(lysineDeg), name = "lysineDeg", search=TRUE)
#Warning: The following features are not present in the object: SETD8, SUV420H1, SUV420H2, WHSC1, WHSC1L1, attempting to find updated synonyms


cysteineMethionineMet <- c('ADI1', 'AHCY', 'AHCYL1', 'AHCYL2', 'AMD1', 'APIP', 'BHMT', 'CBS', 'CDO1', 'CTH', 'DNMT1', 'DNMT3A', 'DNMT3B', 'DNMT3L', 'ENOPH1', 'GOT1', 'GOT2', 'IL4I1', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'MAT1A', 'MAT2A', 'MAT2B', 'MPST', 'MTAP', 'MTR', 'SDS', 'SMS', 'SRM', 'TAT', 'TRDMT1')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(cysteineMethionineMet), name = "cysteineMethionineMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(cysteineMethionineMet), name = "cysteineMethionineMet", search=TRUE)


phenylalanineMet <- c('ALDH1A3', 'ALDH3A1', 'ALDH3B1', 'ALDH3B2', 'AOC2', 'AOC3', 'DDC', 'GOT1', 'GOT2', 'HPD', 'IL4I1', 'MAOA', 'MAOB', 'MIF', 'NAT6', 'PAH', 'PRDX6', 'TAT')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(phenylalanineMet), name = "phenylalanineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(phenylalanineMet), name = "phenylalanineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, attempting to find updated synonyms


taurineHypotaurMet <- c('ADO', 'BAAT', 'CDO1', 'CSAD', 'GAD1', 'GAD2', 'GGT1', 'GGT5', 'GGT6', 'GGT7')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(taurineHypotaurMet), name = "taurineHypotaurMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(taurineHypotaurMet), name = "taurineHypotaurMet", search=TRUE)


aminoacyltRNAbios <- c('AARS', 'AARS2', 'CARS', 'CARS2', 'DARS', 'DARS2', 'EARS2', 'EPRS', 'FARS2', 'FARSA', 'FARSB', 'GARS', 'HARS', 'HARS2', 'IARS', 'IARS2', 'KARS', 'LARS', 'LARS2', 'MARS', 'MARS2', 'MTFMT', 'NARS', 'NARS2', 'PARS2', 'PSTK', 'QARS', 'RARS', 'RARS2', 'SARS', 'SARS2', 'SEPSECS', 'TARS', 'TARS2', 'TARSL2', 'VARS', 'VARS2', 'WARS', 'WARS2', 'YARS', 'YARS2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(aminoacyltRNAbios), name = "aminoacyltRNAbios", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(aminoacyltRNAbios), name = "aminoacyltRNAbios", search=TRUE)


tryptophanMet <- c('AADAT', 'AANAT', 'ABP1', 'ACAT1', 'ACAT2', 'ACMSD', 'AFMID', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'AOX1', 'ASMT', 'CAT', 'CYP1A1', 'CYP1A2', 'CYP1B1', 'DDC', 'ECHS1', 'EHHADH', 'GCDH', 'HAAO', 'HADH', 'HADHA', 'IDO1', 'IDO2', 'IL4I1', 'INMT', 'KMO', 'KYNU', 'MAOA', 'MAOB', 'OGDH', 'OGDHL', 'TDO2', 'TPH1', 'TPH2', 'WARS', 'WARS2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(tryptophanMet), name = "tryptophanMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(tryptophanMet), name = "tryptophanMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, attempting to find updated synonyms


tyrosineMet <- c('ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'ALDH1A3', 'ALDH3A1', 'ALDH3B1', 'ALDH3B2', 'AOC2', 'AOC3', 'AOX1', 'COMT', 'DBH', 'DCT', 'DDC', 'FAH', 'GOT1', 'GOT2', 'GSTZ1', 'HEMK1', 'HGD', 'HPD', 'IL4I1', 'LCMT1', 'LCMT2', 'MAOA', 'MAOB', 'METTL2B', 'METTL6', 'MIF', 'NAT6', 'PNMT', 'TAT', 'TH', 'TPO', 'TRMT11', 'TYR', 'TYRP1', 'WBSCR22')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(tyrosineMet), name = "tyrosineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, WBSCR22, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(tyrosineMet), name = "tyrosineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, WBSCR22, attempting to find updated synonyms


valineLeucineIsoleucBios <- c('BCAT1', 'BCAT2', 'IARS', 'IARS2', 'LARS', 'LARS2', 'PDHA1', 'PDHA2', 'PDHB', 'VARS', 'VARS2')

OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(valineLeucineIsoleucBios), name = "valineLeucineIsoleucBios", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(valineLeucineIsoleucBios), name = "valineLeucineIsoleucBios", search=TRUE)

names(OvarianSetGrpd.2[[]])
names(OvarianSetGrpd.H.2[[]])

saveRDS(OvarianSetGrpd.2, paste(metadir2,"SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))
saveRDS(OvarianSetGrpd.H.2, paste(metadir2.H,"SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))



### Make per sample subsets and export all scores for the sample
OvarianCellLineGrpd.2 <- subset(x=OvarianSetGrpd.2, cells=celllinesonly.2)
OvarianSensitiveCellLines.2 <- subset(x=OvarianCellLineGrpd.2, cells=Sonly.2)
OvarianResistantCellLines.2 <- subset(x=OvarianCellLineGrpd.2, cells=Ronly.2)

OVCAR4pair.2 <- subset(x=OvarianCellLineGrpd.2, cells=c(OVCAR4.2_S_cells,OVCAR4.2_R_cells))
OVCA3pair.2 <- subset(x=OvarianCellLineGrpd.2, cells=c(OVCA3.2_S_cells,OVCA3.2_R_cells))


OvarianCellLineGrpd.H.2 <- subset(x=OvarianSetGrpd.H.2, cells=celllinesonly.H.2)
OvarianSensitiveCellLines.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=Sonly.H.2)
OvarianResistantCellLines.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=Ronly.H.2)

OVCAR4pair.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=c(OVCAR4.H.2_S_cells,OVCAR4.H.2_R_cells))
OVCA3pair.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=c(OVCA3.H.2_S_cells,OVCA3.H.2_R_cells))
```

##AFTER CALCULATING SCORES, SUBSET BY TYPE, THEN COMPUTE AVERAGE SCORE PER CELL LINE & EXPORT INDIVIDUAL SCORES

```{r}
OVCAR4.2_S <- subset(x=OvarianSetGrpd.2, cells=OVCAR4.2_S_cells)
OVCAR4.2_R <- subset(x=OvarianSetGrpd.2, cells=OVCAR4.2_R_cells)
OVCA3.2_S <- subset(x=OvarianSetGrpd.2, cells=OVCA3.2_S_cells)
OVCA3.2_R <- subset(x=OvarianSetGrpd.2, cells=OVCA3.2_R_cells)

OVCAR4.H.2_S <- subset(x=OvarianSetGrpd.H.2, cells=OVCAR4.H.2_S_cells)
OVCAR4.H.2_R <- subset(x=OvarianSetGrpd.H.2, cells=OVCAR4.H.2_R_cells)
OVCA3.H.2_S <- subset(x=OvarianSetGrpd.H.2, cells=OVCA3.H.2_S_cells)
OVCA3.H.2_R <- subset(x=OvarianSetGrpd.H.2, cells=OVCA3.H.2_R_cells)

scores.2 <- c("OXPHOS1","glycolysis1","citricAcid1","ascorbateAldarate1","chondroitinSulfate1","fructoseMannose1","galactose1","keratanSulfate1","heparanSulfate1","pentosePhosphate1","pyruvateMet1","starchSucrose1","etherLipidMet1","arachidonicAcidMet1","fattyAcidMet1","glycerolipidMet1","glycerophospholipidMet1","glyoxylateDicarbMet1","linoleicAcidMet1","sphingolipidMet1","propanoateMet1","pyrimidineMet1","purineMet1","alaniAspratGlutamMet1","arginineProlineMet1","butanoateMet1","glutathioneMet1","glycineSerineThreonMet1","histidineMet1","lysineDeg1","cysteineMethionineMet1","phenylalanineMet1","taurineHypotaurMet1","aminoacyltRNAbios1","tryptophanMet1","tyrosineMet1","valineLeucineIsoleucBios1")

scores.H.2 <- c("OXPHOS1","glycolysis1","citricAcid1","ascorbateAldarate1","chondroitinsulfate1","fructoseMannose1","galactose1","keratanSulfate1","heparanSulfate1","pentosePhosphate1","pyruvateMet1","starchSucrose1","etherLipidMet1","arachidonicAcidMet1","fattyAcidMet1","glycerolipidMet1","glycerophospholipidMet1","glyoxylateDicarbMet1","linoleicAcidMet1","sphingolipidMet1","propanoateMet1","pyrimidineMet1","purineMet1","alaniAspratGlutamMet1","arginineProlineMet1","butanoateMet1","glutathioneMet1","glycineSerineThreonMet1","histidineMet1","lysineDeg1","cysteineMethionineMet1","phenylalanineMet1","taurineHypotaurMet1","aminoacyltRNAbios1","tryptophanMet1","tyrosineMet1","valineLeucineIsoleucBios1")


averageScores.2 <- function(arg_1, arg_2) {
   # arg_1 == Seurat object 
   # arg_2 == string for use in exporting scores

# export data
  data_scores.2 <- as.data.frame(as.matrix(arg_1[[scores.2]]))

  fwrite(x = data_scores.2, file = paste(metadir2,arg_2,"_scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

  tmp <- list()
  for (val in 1:37)
  {
    tmp[[scores.2[val]]] <- mean(unlist(data_scores.2[val]))
  }
  tmp

  fwrite(x = as.data.frame(tmp), file = paste(metadir2,arg_2,"_average-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

 }




rm(arg_1,arg_2,tmp,val)

averageScoresH.2 <- function(arg_1, arg_2) {
   # arg_1 == Seurat object 
   # arg_2 == string for use in exporting scores

# export data
  data_scores.2 <- as.data.frame(as.matrix(arg_1[[scores.H.2]]))

  fwrite(x = data_scores.2, file = paste(metadir2.H,arg_2,"_scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

  tmp <- list()
  for (val in 1:36)
  {
    tmp[[scores.H.2[val]]] <- mean(unlist(data_scores.2[val]))
  }
  tmp

  fwrite(x = as.data.frame(tmp), file = paste(metadir2.H,arg_2,"_average-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

 }

rm(arg_1,arg_2,tmp,val)

# Call the functions
averageScores.2(OVCAR4.2_S,"OVCAR4_S")
averageScores.2(OVCAR4.2_R,"OVCAR4_R")
averageScores.2(OVCA3.2_S,"OVCA3_S")
averageScores.2(OVCA3.2_R,"OVCA3_R")

averageScoresH.2(OVCAR4.H.2_S,"OVCAR4_S")
averageScoresH.2(OVCAR4.H.2_R,"OVCAR4_R")
averageScoresH.2(OVCA3.H.2_S,"OVCA3_S")
averageScoresH.2(OVCA3.H.2_R,"OVCA3_R")

```

## Do UMAPs
```{r}
#Ovarian Set 
pdf(paste(metadir2,"UMAP_OXPHOS-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='OXPHOS1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Glycolysis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='glycolysis1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Citric-Acid-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='citricAcid1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Ascorbate-Aldarate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='ascorbateAldarate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Chondroitin-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='chondroitinSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Fructose-Mannose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='fructoseMannose1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Galactose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='galactose1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Keratan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='keratanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Heparan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='heparanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Pentose-Phosphate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='pentosePhosphate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Pyruvate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='pyruvateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Starch-Sucrose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='starchSucrose1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Ether-Lipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='etherLipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Arachidonic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='arachidonicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Fatty-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='fattyAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Glycerolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='glycerolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Glycerophospholipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='glycerophospholipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Glyoxylate-Dicarb-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='glyoxylateDicarbMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Linoleic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='linoleicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Sphingolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='sphingolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Propanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='propanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Pyrimidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='pyrimidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Purine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='purineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Alani-Asprat-Glutam-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='alaniAspratGlutamMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Arginine-Proline-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='arginineProlineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Butanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='butanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Glutathione-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='glutathioneMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Glycine-Serine-Threon-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='glycineSerineThreonMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Histidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='histidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Lysine-Degradation-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='lysineDeg1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Cysteine-Methionine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='cysteineMethionineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Phenylalanine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='phenylalanineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Taurine-Hypotaur-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='taurineHypotaurMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_aminoacyl-tRNA-biosynthesis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='aminoacyltRNAbios1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Tryptophan-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='tryptophanMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Tyrosine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='tyrosineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2,"UMAP_Valine-Leucine-Isoleucine-Biosynthesis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='valineLeucineIsoleucBios1') 
print(dPlot)
dev.off()



#Ovarian Set Harmony
pdf(paste(metadir2.H,"UMAP_OXPHOS-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='OXPHOS1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Glycolysis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='glycolysis1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Citric-Acid-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='citricAcid1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Ascorbate-Aldarate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='ascorbateAldarate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Chondroitin-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='chondroitinsulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Fructose-Mannose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='fructoseMannose1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Galactose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='galactose1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Keratan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='keratanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Heparan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='heparanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Pentose-Phosphate-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='pentosePhosphate1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Pyruvate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='pyruvateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Starch-Sucrose-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='starchSucrose1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Ether-Lipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='etherLipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Arachidonic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='arachidonicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Fatty-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='fattyAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Glycerolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='glycerolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Glycerophospholipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='glycerophospholipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Glyoxylate-Dicarb-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='glyoxylateDicarbMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Linoleic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='linoleicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Sphingolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='sphingolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Propanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='propanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Pyrimidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='pyrimidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Purine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='purineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Alani-Asprat-Glutam-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='alaniAspratGlutamMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Arginine-Proline-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='arginineProlineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Butanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='butanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Glutathione-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='glutathioneMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Glycine-Serine-Threon-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='glycineSerineThreonMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Histidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='histidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Lysine-Degradation-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='lysineDeg1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Cysteine-Methionine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='cysteineMethionineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Phenylalanine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='phenylalanineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Taurine-Hypotaur-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='taurineHypotaurMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_aminoacyl-tRNA-biosynthesis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='aminoacyltRNAbios1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Tryptophan-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='tryptophanMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Tyrosine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='tyrosineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir2.H,"UMAP_Valine-Leucine-Isoleucine-Biosynthesis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.H.2, features='valineLeucineIsoleucBios1') 
print(dPlot)
dev.off()
```

#New way to get the cvs files 
##Approach 1
###Import files with and without harmony 
```{r}
library(future)
library(ggplot2)
library(bigmemory)
library(Seurat)
library(data.table)
library(dplyr)
library(rdetools)
# library(clustree)
sessionInfo()

plan("multiprocess", workers=16)

options(future.globals.maxSize=134217728000) ### for 128GB * 1024*1024

date = "_2022-05-19"
#figdirOrg = "./Resolution-of-1/OvarianSet_All-Samples_"

metadir1.H <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_Approach1_Seurat-Metabolic-Analysis_'
metadir1.H.H <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_H_Approach1_Seurat-Metabolic-Analysis_'


## Ovarian Set
OvarianSet.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Cell Cycle analysis/Approach 1/OvarianSet_after-CC-genes_SeuratObj_post-diversity-score_Approach1_2022-04-08.rds") #this does not have the CC difference
names(OvarianSet.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident"  
### Setting a cluster tab
OvarianSet.1$Cluster <- OvarianSet.1$RNA_snn_res.0.6
OvarianSet.1$name <- OvarianSet.1$orig.ident
names(OvarianSet.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident"       "Cluster"         "name"   

### Labelling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.1$name)
tmp1 <- as.matrix(OvarianSet.1$name)
numCells <- 5091
for (val in 1:numCells) {
### check name
   tmpname <- OvarianSet.1[[]][val,'name']
## from name set CMML or normal
  if (isTRUE(tmpname == "OVCA3_R" || tmpname == "OVCAR4_R")) {
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }


OvarianSetGrpd.1 <- OvarianSet.1
#OvarianSetGrpd.1$samptype <- tmp1


names(OvarianSetGrpd.1[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_S"))
OVCA3.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_R"))
OVCAR4.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.1 <- c(OVCA3.1_S_cells, OVCA3.1_R_cells, OVCAR4.1_S_cells, OVCAR4.1_R_cells)

OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)

OvarianCellLineGrpd.1@active.ident <- OvarianCellLineGrpd.1$Cluster

Sonly.1 <- c(OVCA3.1_S_cells,OVCAR4.1_S_cells)
Ronly.1 <- c(OVCA3.1_R_cells,OVCAR4.1_R_cells)

OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))



##Ovarian Set Harmony
OvarianSet.H.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Cell Cycle analysis/Approach 1/OvarianSet_after_H-CC-genes_SeuratObj_post-diversity-score_Approach1_2022-04-08.rds")
names(OvarianSet.H.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident" 
### Setting a cluster tab
OvarianSet.H.1$Cluster <- OvarianSet.H.1$RNA_snn_res.0.6
OvarianSet.H.1$name <- OvarianSet.H.1$orig.ident
names(OvarianSet.H.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident"       "Cluster"         "name" 

### Labeling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.H.1$name)
tmp1 <- as.matrix(OvarianSet.H.1$name)
numCells <- 22710
for (val in 1:numCells) {
### check name
tmpname <- OvarianSet.H.1[[]][val,'name']
## from name set CMML or normal
if (isTRUE(tmpname  == "OVCA3_R" || tmpname == "OVCAR4_R")){
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }

OvarianSetGrpd.H.1 <- OvarianSet.H.1
#OvarianSetGrpd.H.1$samptype <- tmp1

names(OvarianSetGrpd.H.1[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.H.1_S_cells <- WhichCells(OvarianSetGrpd.H.1, expression = (orig.ident=="OVCA3_S"))
OVCA3.H.1_R_cells <- WhichCells(OvarianSetGrpd.H.1, expression = (orig.ident=="OVCA3_R"))
OVCAR4.H.1_S_cells <- WhichCells(OvarianSetGrpd.H.1, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.H.1_R_cells <- WhichCells(OvarianSetGrpd.H.1, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.H.1 <- c(OVCA3.H.1_S_cells, OVCA3.H.1_R_cells, OVCAR4.H.1_S_cells, OVCAR4.H.1_R_cells)

OvarianCellLineGrpd.H.1 <- subset(x=OvarianSetGrpd.H.1, cells=celllinesonly.H.1)

OvarianCellLineGrpd.H.1@active.ident <- OvarianCellLineGrpd.H.1$Cluster

Sonly.H.1 <- c(OVCA3.H.1_S_cells,OVCAR4.H.1_S_cells)
Ronly.H.1 <- c(OVCA3.H.1_R_cells,OVCAR4.H.1_R_cells)

OvarianSensitiveCellLines.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=Sonly.H.1)
OvarianResistantCellLines.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=Ronly.H.1)

OVCAR4pair.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=c(OVCAR4.H.1_S_cells,OVCAR4.H.1_R_cells))
OVCA3pair.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=c(OVCA3.H.1_S_cells,OVCA3.H.1_R_cells))

```
###Metabolic Pathway Score Analysis 
```{r}

OXPHOSgenes <- c('ATP12A', 'ATP4A', 'ATP4B', 'ATP5A1', 'ATP5B', 'ATP5C1', 'ATP5D', 'ATP5E', 'ATP5F1', 'ATP5G1', 'ATP5G1P5', 'ATP5G2', 'ATP5G3', 'ATP5H', 'ATP5I', 'ATP5J', 'ATP5J2', 'ATP5L', 'ATP5O', 'ATP6', 'ATP6AP1', 'ATP6V0A1', 'ATP6V0A2', 'ATP6V0A4', 'ATP6V0B', 'ATP6V0C', 'ATP6V0D1', 'ATP6V0D2', 'ATP6V0E1', 'ATP6V0E2', 'ATP6V1A', 'ATP6V1B1', 'ATP6V1B2', 'ATP6V1C1', 'ATP6V1C2', 'ATP6V1D', 'ATP6V1E1', 'ATP6V1E2', 'ATP6V1F', 'ATP6V1G1', 'ATP6V1G2', 'ATP6V1G3', 'ATP6V1H', 'ATP8', 'COX1', 'COX10', 'COX11', 'COX15', 'COX17', 'COX2', 'COX3', 'COX4I1', 'COX4I2', 'COX5A', 'COX5B', 'COX6A1', 'COX6A2', 'COX6B1', 'COX6B2', 'COX6C', 'COX6CP3', 'COX7A1', 'COX7A2', 'COX7A2L', 'COX7B', 'COX7B2', 'COX7C', 'COX8A', 'COX8C', 'CYC1', 'CYTB', 'LHPP', 'LOC100133737', 'LOC642502', 'LOC644310', 'LOC727947', 'ND1', 'ND2', 'ND3', 'ND4', 'ND4L', 'ND5', 'ND6', 'NDUFA1', 'NDUFA10', 'NDUFA11', 'NDUFA2', 'NDUFA3', 'NDUFA4', 'NDUFA4L2', 'NDUFA5', 'NDUFA6', 'NDUFA7', 'NDUFA8', 'NDUFA9', 'NDUFAB1', 'NDUFB1', 'NDUFB10', 'NDUFB2', 'NDUFB3', 'NDUFB4', 'NDUFB5', 'NDUFB6', 'NDUFB7', 'NDUFB8', 'NDUFB9', 'NDUFC1', 'NDUFC2', 'NDUFS1', 'NDUFS2', 'NDUFS3', 'NDUFS4', 'NDUFS5', 'NDUFS6', 'NDUFS7', 'NDUFS8', 'NDUFV1', 'NDUFV2', 'NDUFV3', 'PPA1', 'PPA2', 'SDHA', 'SDHB', 'SDHC', 'SDHD', 'TCIRG1', 'UQCR10', 'UQCR11', 'UQCRB', 'UQCRC1', 'UQCRC2', 'UQCRFS1', 'UQCRH', 'UQCRHL', 'UQCRQ')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(OXPHOSgenes), name = "OXPHOS", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(OXPHOSgenes), name = "OXPHOS", search=TRUE)



glycolysisGenes <- c('ACSS1', 'ACSS2', 'ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'AKR1A1', 'ALDH1A3', 'ALDH1B1', 'ALDH2', 'ALDH3A1', 'ALDH3A2', 'ALDH3B1', 'ALDH3B2', 'ALDH7A1', 'ALDH9A1', 'ALDOA', 'ALDOB', 'ALDOC', 'BPGM', 'DLAT', 'DLD', 'ENO1', 'ENO2', 'ENO3', 'FBP1', 'FBP2', 'G6PC', 'G6PC2', 'GALM', 'GAPDH', 'GCK', 'GPI', 'HK1', 'HK2', 'HK3', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'PFKL', 'PFKM', 'PFKP', 'PGAM1', 'PGAM2', 'PGAM4', 'PGK1', 'PGK2', 'PGM1', 'PGM2', 'PKLR', 'PKM2', 'TPI1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glycolysisGenes), name = "glycolysis", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glycolysisGenes), name = "glycolysis", search=TRUE)



citricAcidGenes <- c('ACLY', 'ACO1', 'ACO2', 'CS', 'DLAT', 'DLD', 'DLST', 'FH', 'IDH1', 'IDH2', 'IDH3A', 'IDH3B', 'IDH3G', 'LOC283398', 'LOC642502', 'MDH1', 'MDH2', 'OGDH', 'OGDHL', 'PC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'SDHA', 'SDHB', 'SDHC', 'SDHD', 'SUCLA2', 'SUCLG1', 'SUCLG2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(citricAcidGenes), name = "citricAcid", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(citricAcidGenes), name = "citricAcid", search=TRUE)



ascorbAldarMet <- c('ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'MIOX', 'UGDH', 'UGT1A1', 'UGT1A10', 'UGT1A3', 'UGT1A4', 'UGT1A5', 'UGT1A6', 'UGT1A7', 'UGT1A8', 'UGT1A9', 'UGT2A1', 'UGT2A3', 'UGT2B10', 'UGT2B11', 'UGT2B15', 'UGT2B17', 'UGT2B28', 'UGT2B4', 'UGT2B7')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(ascorbAldarMet), name = "ascorbateAldarate", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(ascorbAldarMet), name = "ascorbateAldarate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


chondroitinSulfateBios <- c('B3GALT6', 'B3GAT1', 'B3GAT2', 'B3GAT3', 'B4GALT7', 'CHPF', 'CHPF2', 'CHST11', 'CHST12', 'CHST13', 'CHST14', 'CHST15', 'CHST3', 'CHST7', 'CHSY1', 'CHSY3', 'CSGALNACT1', 'CSGALNACT2', 'DSE', 'UST', 'XYLT1', 'XYLT2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(chondroitinSulfateBios), name = "chondroitinSulfate", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(chondroitinSulfateBios), name = "chondroitinsulfate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


fructMannMet <- c('AKR1B1', 'AKR1B10', 'ALDOA', 'ALDOB', 'ALDOC', 'FBP1', 'FBP2', 'FPGT', 'FUK', 'GMDS', 'GMPPA', 'GMPPB', 'HK1', 'HK2', 'HK3', 'KHK', 'MPI', 'MTMR1', 'MTMR2', 'MTMR6', 'MTMR7', 'PFKFB1', 'PFKFB2', 'PFKFB3', 'PFKFB4', 'PFKL', 'PFKM', 'PFKP', 'PHPT1', 'PMM1', 'PMM2', 'SORD', 'TPI1', 'TSTA3')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(fructMannMet), name = "fructoseMannose", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(fructMannMet), name = "fructoseMannose", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


galactose <- c('AKR1B1', 'B4GALT1', 'B4GALT2', 'G6PC', 'G6PC2', 'GAA', 'GALE', 'GALK1', 'GALK2', 'GALT', 'GANC', 'GCK', 'GLA', 'GLB1', 'HK1', 'HK2', 'HK3', 'LALBA', 'LCT', 'MGAM', 'PFKL', 'PFKM', 'PFKP', 'PGM1', 'PGM2', 'UGP2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(galactose), name = "galactose", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(galactose), name = "galactose", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


keratanSulfate <- c('B3GNT1', 'B3GNT2', 'B3GNT7', 'B4GALT1', 'B4GALT2', 'B4GALT3', 'B4GALT4', 'CHST1', 'CHST2', 'CHST4', 'CHST6', 'FUT8', 'ST3GAL1', 'ST3GAL2', 'ST3GAL3')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(keratanSulfate), name = "keratanSulfate", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: B3GNT1, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(keratanSulfate), name = "keratanSulfate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: B3GNT1, attempting to find updated synonyms


heparanSulfate <- c('B3GALT6', 'B3GAT1', 'B3GAT2', 'B3GAT3', 'B4GALT7', 'EXT1', 'EXT2', 'EXTL1', 'EXTL2', 'EXTL3', 'GLCE', 'HS2ST1', 'HS3ST1', 'HS3ST2', 'HS3ST3A1', 'HS3ST3B1', 'HS3ST5', 'HS6ST1', 'HS6ST2', 'HS6ST3', 'NDST1', 'NDST2', 'NDST3', 'NDST4', 'XYLT1', 'XYLT2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(heparanSulfate), name = "heparanSulfate", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(heparanSulfate), name = "heparanSulfate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


pentosePhosphate <- c('ALDOA', 'ALDOB', 'ALDOC', 'DERA', 'FBP1', 'FBP2', 'G6PD', 'GPI', 'H6PD', 'LOC729020', 'PFKL', 'PFKM', 'PFKP', 'PGD', 'PGLS', 'PGM1', 'PGM2', 'PRPS1', 'PRPS1L1', 'PRPS2', 'RBKS', 'RPE', 'RPIA', 'TALDO1', 'TKT', 'TKTL1', 'TKTL2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(pentosePhosphate), name = "pentosePhosphate", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: LOC729020, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(pentosePhosphate), name = "pentosePhosphate", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: LOC729020, attempting to find updated synonyms


pyruvateMet <- c('ACACA', 'ACACB', 'ACAT1', 'ACAT2', 'ACOT12', 'ACSS1', 'ACSS2', 'ACYP1', 'ACYP2', 'AKR1B1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'DLAT', 'DLD', 'GLO1', 'GRHPR', 'HAGH', 'HAGHL', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'LDHD', 'MDH1', 'MDH2', 'ME1', 'ME2', 'ME3', 'PC', 'PCK1', 'PCK2', 'PDHA1', 'PDHA2', 'PDHB', 'PKLR', 'PKM2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(pyruvateMet), name = "pyruvateMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(pyruvateMet), name = "pyruvateMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms


starchSucrose <- c('AGL', 'AMY1A', 'AMY1B', 'AMY1C', 'AMY2A', 'AMY2B', 'ENPP1', 'ENPP3', 'G6PC', 'G6PC2', 'GAA', 'GANC', 'GBA3', 'GBE1', 'GCK', 'GPI', 'GUSB', 'GYS1', 'GYS2', 'HK1', 'HK2', 'HK3', 'MGAM', 'PGM1', 'PGM2', 'PGM2L1', 'PYGB', 'PYGL', 'PYGM', 'SI', 'TREH', 'UGDH', 'UGP2', 'UGT1A1', 'UGT1A10', 'UGT1A3', 'UGT1A4', 'UGT1A5', 'UGT1A6', 'UGT1A7', 'UGT1A8', 'UGT1A9', 'UGT2A1', 'UGT2A3', 'UGT2B10', 'UGT2B11', 'UGT2B15', 'UGT2B17', 'UGT2B28', 'UGT2B4', 'UGT2B7', 'UXS1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(starchSucrose), name = "starchSucrose", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: GBA3, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(starchSucrose), name = "starchSucrose", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: GBA3, attempting to find updated synonyms


etherLipidMet <- c('AGPS', 'CHPT1', 'ENPP2', 'ENPP6', 'JMJD7-PLA2G4B', 'LPCAT1', 'LPCAT2', 'LPCAT4', 'PAFAH1B1', 'PAFAH1B2', 'PAFAH1B3', 'PAFAH2', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PLA2G7', 'PLD1', 'PLD2', 'PPAP2A', 'PPAP2B', 'PPAP2C')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(etherLipidMet), name = "etherLipidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(etherLipidMet), name = "etherLipidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


arachidonicAcidMet <- c('AKR1C3', 'ALOX12', 'ALOX12B', 'ALOX15', 'ALOX15B', 'ALOX5', 'CBR1', 'CBR3', 'CYP2B6', 'CYP2C18', 'CYP2C19', 'CYP2C8', 'CYP2C9', 'CYP2E1', 'CYP2J2', 'CYP2U1', 'CYP4A11', 'CYP4A22', 'CYP4F2', 'CYP4F3', 'EPHX2', 'GGT1', 'GGT5', 'GGT6', 'GGT7', 'GPX1', 'GPX2', 'GPX3', 'GPX4', 'GPX5', 'GPX6', 'GPX7', 'HPGDS', 'JMJD7-PLA2G4B', 'LTA4H', 'LTC4S', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PTGDS', 'PTGES', 'PTGES2', 'PTGIS', 'PTGS1', 'PTGS2', 'TBXAS1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(arachidonicAcidMet), name = "arachidonicAcidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: GPX1, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(arachidonicAcidMet), name = "arachidonicAcidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: GPX1, attempting to find updated synonyms


fattyAcidMet <- c('ACAA1', 'ACAA2', 'ACADL', 'ACADM', 'ACADS', 'ACADSB', 'ACADVL', 'ACAT1', 'ACAT2', 'ACOX1', 'ACOX3', 'ACSL1', 'ACSL3', 'ACSL4', 'ACSL5', 'ACSL6', 'ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'CPT1A', 'CPT1B', 'CPT1C', 'CPT2', 'CYP4A11', 'CYP4A22', 'ECHS1', 'ECI1', 'ECI2', 'EHHADH', 'GCDH', 'HADH', 'HADHA', 'HADHB')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(fattyAcidMet), name = "fattyAcidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(fattyAcidMet), name = "fattyAcidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


glycerolipidMet <- c('AGK', 'AGPAT1', 'AGPAT2', 'AGPAT3', 'AGPAT4', 'AGPAT6', 'AGPAT9', 'AKR1A1', 'AKR1B1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'AWAT2', 'CEL', 'DAK', 'DGAT1', 'DGAT2', 'DGKA', 'DGKB', 'DGKD', 'DGKE', 'DGKG', 'DGKH', 'DGKI', 'DGKQ', 'DGKZ', 'GK', 'GK2', 'GLA', 'GLYCTK', 'GPAM', 'GPAT2', 'LCLAT1', 'LIPC', 'LIPF', 'LIPG', 'LPL', 'MBOAT1', 'MBOAT2', 'MGLL', 'PNLIP', 'PNLIPRP1', 'PNLIPRP2', 'PNPLA3', 'PPAP2A', 'PPAP2B', 'PPAP2C')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glycerolipidMet), name = "glycerolipidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, DAK, PNLIPRP2, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glycerolipidMet), name = "glycerolipidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, DAK, PNLIPRP2, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


glycerophospholipidMet <- c('ACHE', 'AGPAT1', 'AGPAT2', 'AGPAT3', 'AGPAT4', 'AGPAT6', 'AGPAT9', 'C17orf48', 'CDIPT', 'CDS1', 'CDS2', 'CHAT', 'CHKA', 'CHKB', 'CHPT1', 'CRLS1', 'DGKA', 'DGKB', 'DGKD', 'DGKE', 'DGKG', 'DGKH', 'DGKI', 'DGKQ', 'DGKZ', 'ETNK1', 'ETNK2', 'GNPAT', 'GPAM', 'GPAT2', 'GPD1', 'GPD1L', 'GPD2', 'JMJD7-PLA2G4B', 'LCAT', 'LCLAT1', 'LPCAT1', 'LPCAT2', 'LPCAT3', 'LPCAT4', 'LPGAT1', 'LYPLA1', 'LYPLA2', 'MBOAT1', 'MBOAT2', 'MBOAT7', 'PCYT1A', 'PCYT1B', 'PCYT2', 'PEMT', 'PGS1', 'PHOSPHO1', 'PISD', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G15', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6', 'PLD1', 'PLD2', 'PPAP2A', 'PPAP2B', 'PPAP2C', 'PTDSS1', 'PTDSS2', 'TAZ')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glycerophospholipidMet), name = "glycerophospholipidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, C17orf48, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glycerophospholipidMet), name = "glycerophospholipidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, C17orf48, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


glyoxylateDicarbMet <- c('ACO1', 'ACO2', 'AFMID', 'CS', 'GLYCTK', 'GRHPR', 'HAO1', 'HAO2', 'HYI', 'MDH1', 'MDH2', 'MTHFD1', 'MTHFD1L', 'MTHFD2', 'MTHFD2L', 'PGP')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glyoxylateDicarbMet), name = "glyoxylateDicarbMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glyoxylateDicarbMet), name = "glyoxylateDicarbMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


linoleicAcidMet <- c('AKR1B10', 'ALOX15', 'CYP1A2', 'CYP2C18', 'CYP2C19', 'CYP2C8', 'CYP2C9', 'CYP2E1', 'CYP2J2', 'CYP3A4', 'CYP3A43', 'CYP3A5', 'CYP3A7', 'JMJD7-PLA2G4B', 'PLA2G10', 'PLA2G12A', 'PLA2G12B', 'PLA2G1B', 'PLA2G2A', 'PLA2G2C', 'PLA2G2D', 'PLA2G2E', 'PLA2G2F', 'PLA2G3', 'PLA2G4A', 'PLA2G4B', 'PLA2G4E', 'PLA2G5', 'PLA2G6')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(linoleicAcidMet), name = "linoleicAcidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(linoleicAcidMet), name = "linoleicAcidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])


sphingolipidMet <- c('ACER1', 'ACER2', 'ACER3', 'ARSA', 'ASAH1', 'ASAH2', 'ASAH2C', 'B4GALT6', 'CERK', 'DEGS1', 'DEGS2', 'ENPP7', 'GAL3ST1', 'GALC', 'GBA', 'GLA', 'GLB1', 'KDSR', 'NEU1', 'NEU2', 'NEU3', 'NEU4', 'PPAP2A', 'PPAP2B', 'PPAP2C', 'SGMS1', 'SGMS2', 'SGPL1', 'SGPP1', 'SGPP2', 'SMPD1', 'SMPD2', 'SMPD3', 'SMPD4', 'SPHK1', 'SPHK2', 'SPTLC1', 'SPTLC2', 'UGCG', 'UGT8')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(sphingolipidMet), name = "sphingolipidMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: ASAH2C, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(sphingolipidMet), name = "sphingolipidMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: ASAH2C, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms


propanoateMet <- c('ABAT', 'ACACA', 'ACACB', 'ACADM', 'ACAT1', 'ACAT2', 'ACSS1', 'ACSS2', 'ACSS3', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH6A1', 'ALDH7A1', 'ALDH9A1', 'ECHS1', 'EHHADH', 'HADHA', 'HIBCH', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'LOC283398', 'MCEE', 'MLYCD', 'MUT', 'PCCA', 'PCCB', 'SUCLA2', 'SUCLG1', 'SUCLG2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(propanoateMet), name = "propanoateMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: LOC283398, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(propanoateMet), name = "propanoateMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: LOC283398, attempting to find updated synonyms


pyrimidineMet <- c('AK3', 'CAD', 'CANT1', 'CDA', 'CMPK1', 'CMPK2', 'CTPS', 'CTPS2', 'DCK', 'DCTD', 'DHODH', 'DPYD', 'DPYS', 'DTYMK', 'DUT', 'ENTPD1', 'ENTPD3', 'ENTPD4', 'ENTPD5', 'ENTPD6', 'ENTPD8', 'ITPA', 'NME1', 'NME1-NME2', 'NME2', 'NME3', 'NME4', 'NME5', 'NME6', 'NME7', 'NT5C', 'NT5C1A', 'NT5C1B', 'NT5C2', 'NT5C3', 'NT5E', 'NT5M', 'NUDT2', 'PNP', 'PNPT1', 'POLA1', 'POLA2', 'POLD1', 'POLD2', 'POLD3', 'POLD4', 'POLE', 'POLE2', 'POLE3', 'POLE4', 'POLR1A', 'POLR1B', 'POLR1C', 'POLR1D', 'POLR1E', 'POLR2A', 'POLR2B', 'POLR2C', 'POLR2D', 'POLR2E', 'POLR2F', 'POLR2G', 'POLR2H', 'POLR2I', 'POLR2J', 'POLR2J2', 'POLR2J3', 'POLR2K', 'POLR2L', 'POLR3A', 'POLR3B', 'POLR3C', 'POLR3D', 'POLR3F', 'POLR3G', 'POLR3GL', 'POLR3H', 'POLR3K', 'PRIM1', 'PRIM2', 'RRM1', 'RRM2', 'RRM2B', 'TK1', 'TK2', 'TXNRD1', 'TXNRD2', 'TYMP', 'TYMS', 'UCK1', 'UCK2', 'UCKL1', 'UMPS', 'UPB1', 'UPP1', 'UPP2', 'UPRT', 'ZNRD1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(pyrimidineMet), name = "pyrimidineMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: CTPS, NT5C3, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(pyrimidineMet), name = "pyrimidineMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: CTPS, NT5C3, attempting to find updated synonyms


purineMet <- c('ADA', 'ADCY1', 'ADCY10', 'ADCY2', 'ADCY3', 'ADCY4', 'ADCY5', 'ADCY6', 'ADCY7', 'ADCY8', 'ADCY9', 'ADK', 'ADSL', 'ADSS', 'ADSSL1', 'AK1', 'AK2', 'AK4', 'AK5', 'AK7', 'ALLC', 'AMPD1', 'AMPD2', 'AMPD3', 'APRT', 'ATIC', 'C17orf48', 'CANT1', 'DCK', 'DGUOK', 'ENPP1', 'ENPP3', 'ENTPD1', 'ENTPD2', 'ENTPD3', 'ENTPD4', 'ENTPD5', 'ENTPD6', 'ENTPD8', 'FHIT', 'GART', 'GDA', 'GMPR', 'GMPR2', 'GMPS', 'GUCY1A2', 'GUCY1A3', 'GUCY1B3', 'GUCY2C', 'GUCY2D', 'GUCY2F', 'GUK1', 'HPRT1', 'IMPDH1', 'IMPDH2', 'ITPA', 'NME1', 'NME1-NME2', 'NME2', 'NME3', 'NME4', 'NME5', 'NME6', 'NME7', 'NPR1', 'NPR2', 'NT5C', 'NT5C1A', 'NT5C1B', 'NT5C2', 'NT5C3', 'NT5E', 'NT5M', 'NUDT2', 'NUDT5', 'NUDT9', 'PAICS', 'PAPSS1', 'PAPSS2', 'PDE10A', 'PDE11A', 'PDE1A', 'PDE1B', 'PDE1C', 'PDE2A', 'PDE3A', 'PDE3B', 'PDE4A', 'PDE4B', 'PDE4C', 'PDE4D', 'PDE5A', 'PDE6A', 'PDE6B', 'PDE6C', 'PDE6D', 'PDE6G', 'PDE6H', 'PDE7A', 'PDE7B', 'PDE8A', 'PDE8B', 'PDE9A', 'PFAS', 'PKLR', 'PKM2', 'PNP', 'PNPT1', 'POLA1', 'POLA2', 'POLD1', 'POLD2', 'POLD3', 'POLD4', 'POLE', 'POLE2', 'POLE3', 'POLE4', 'POLR1A', 'POLR1B', 'POLR1C', 'POLR1D', 'POLR1E', 'POLR2A', 'POLR2B', 'POLR2C', 'POLR2D', 'POLR2E', 'POLR2F', 'POLR2G', 'POLR2H', 'POLR2I', 'POLR2J', 'POLR2J2', 'POLR2J3', 'POLR2K', 'POLR2L', 'POLR3A', 'POLR3B', 'POLR3C', 'POLR3D', 'POLR3F', 'POLR3G', 'POLR3GL', 'POLR3H', 'POLR3K', 'PPAT', 'PRHOXNB', 'PRIM1', 'PRIM2', 'PRPS1', 'PRPS1L1', 'PRPS2', 'PRUNE', 'RRM1', 'RRM2', 'RRM2B', 'XDH', 'ZNRD1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(purineMet), name = "purineMet", search=TRUE)
names(OvarianSetGrpd.1[[]])
#Warning: The following features are not present in the object: C17orf48, GUCY1A3, GUCY1B3, NT5C3, PKM2, PRHOXNB, PRUNE, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(purineMet), name = "purineMet", search=TRUE)
names(OvarianSetGrpd.H.1[[]])
#Warning: The following features are not present in the object: C17orf48, GUCY1A3, GUCY1B3, NT5C3, PKM2, PRHOXNB, PRUNE, attempting to find updated synonyms


alaniAspratGlutamMet <- c('ABAT', 'ACY3', 'ADSL', 'ADSS', 'ADSSL1', 'AGXT', 'AGXT2', 'ALDH4A1', 'ALDH5A1', 'ASL', 'ASNS', 'ASPA', 'ASS1', 'CAD', 'CPS1', 'DDO', 'GAD1', 'GAD2', 'GFPT1', 'GFPT2', 'GLS', 'GLS2', 'GLUD1', 'GLUD2', 'GLUL', 'GOT1', 'GOT2', 'GPT', 'GPT2', 'IL4I1', 'NIT2', 'PPAT')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(alaniAspratGlutamMet), name = "alaniAspratGlutamMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(alaniAspratGlutamMet), name = "alaniAspratGlutamMet", search=TRUE)


arginineProlineMet <- c('ABP1', 'ACY1', 'ADC', 'AGMAT', 'ALDH18A1', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH4A1', 'ALDH7A1', 'ALDH9A1', 'AMD1', 'ARG1', 'ARG2', 'ASL', 'ASS1', 'CKB', 'CKM', 'CKMT1A', 'CKMT1B', 'CKMT2', 'CPS1', 'DAO', 'GAMT', 'GATM', 'GLS', 'GLS2', 'GLUD1', 'GLUD2', 'GLUL', 'GOT1', 'GOT2', 'LAP3', 'MAOA', 'MAOB', 'NAGS', 'NOS1', 'NOS2', 'NOS3', 'OAT', 'ODC1', 'OTC', 'P4HA1', 'P4HA2', 'P4HA3', 'PRODH', 'PRODH2', 'PYCR1', 'PYCR2', 'PYCRL', 'SAT1', 'SAT2', 'SMS', 'SRM')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(arginineProlineMet), name = "arginineProlineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, ADC, PYCRL, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(arginineProlineMet), name = "arginineProlineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, ADC, PYCRL, attempting to find updated synonyms


butanoateMet <- c('AACS', 'ABAT', 'ACADS', 'ACAT1', 'ACAT2', 'ACSM1', 'ACSM2A', 'ACSM3', 'ACSM4', 'ACSM5', 'AKR1B10', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH5A1', 'ALDH7A1', 'ALDH9A1', 'BDH1', 'BDH2', 'ECHS1', 'EHHADH', 'GAD1', 'GAD2', 'HADH', 'HADHA', 'HMGCL', 'HMGCS1', 'HMGCS2', 'L2HGDH', 'OXCT1', 'OXCT2', 'PDHA1', 'PDHA2', 'PDHB')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(butanoateMet), name = "butanoateMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(butanoateMet), name = "butanoateMet", search=TRUE)


glutathioneMet <- c('ANPEP', 'G6PD', 'GCLC', 'GCLM', 'GGCT', 'GGT1', 'GGT5', 'GGT6', 'GGT7', 'GPX1', 'GPX2', 'GPX3', 'GPX4', 'GPX5', 'GPX6', 'GPX7', 'GSR', 'GSS', 'GSTA1', 'GSTA2', 'GSTA3', 'GSTA4', 'GSTA5', 'GSTK1', 'GSTM1', 'GSTM2', 'GSTM3', 'GSTM4', 'GSTM5', 'GSTO1', 'GSTO2', 'GSTP1', 'GSTT1', 'GSTT2', 'GSTZ1', 'IDH1', 'IDH2', 'LAP3', 'MGST1', 'MGST2', 'MGST3', 'ODC1', 'OPLAH', 'PGD', 'RRM1', 'RRM2', 'RRM2B', 'SMS', 'SRM', 'TXNDC12')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glutathioneMet), name = "glutathioneMet", search=TRUE)
#Warning: The following features are not present in the object: GPX1, GSTT1, GSTT2, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glutathioneMet), name = "glutathioneMet", search=TRUE)
#Warning: The following features are not present in the object: GPX1, GSTT1, GSTT2, attempting to find updated synonyms


glycineSerineThreonMet <- c('AGXT', 'AGXT2', 'ALAS1', 'ALAS2', 'AMT', 'AOC2', 'AOC3', 'BHMT', 'CBS', 'CHDH', 'CTH', 'DAO', 'DLD', 'DMGDH', 'GAMT', 'GATM', 'GCAT', 'GLDC', 'GLYCTK', 'GNMT', 'MAOA', 'MAOB', 'PHGDH', 'PIPOX', 'PSAT1', 'PSPH', 'SARDH', 'SDS', 'SHMT1', 'SHMT2', 'SRR')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(glycineSerineThreonMet), name = "glycineSerineThreonMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(glycineSerineThreonMet), name = "glycineSerineThreonMet", search=TRUE)


histidineMet <- c('ABP1', 'ACY3', 'ALDH1A3', 'ALDH1B1', 'ALDH2', 'ALDH3A1', 'ALDH3A2', 'ALDH3B1', 'ALDH3B2', 'ALDH7A1', 'ALDH9A1', 'AMDHD1', 'ASPA', 'CNDP1', 'DDC', 'FTCD', 'HAL', 'HDC', 'HEMK1', 'HNMT', 'LCMT1', 'LCMT2', 'MAOA', 'MAOB', 'METTL2B', 'METTL6', 'TRMT11', 'UROC1', 'WBSCR22')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(histidineMet), name = "histidineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, WBSCR22, attempting to find updated synonyms
OvarianSetGrpd.H.1<- AddModuleScore(OvarianSetGrpd.H.1, features = list(histidineMet), name = "histidineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, WBSCR22, attempting to find updated synonyms


lysineDeg <- c('AADAT', 'AASDH', 'AASDHPPT', 'AASS', 'ACAT1', 'ACAT2', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'ASH1L', 'BBOX1', 'DLST', 'DOT1L', 'ECHS1', 'EHHADH', 'EHMT1', 'EHMT2', 'GCDH', 'HADH', 'HADHA', 'NSD1', 'OGDH', 'OGDHL', 'PIPOX', 'PLOD1', 'PLOD2', 'PLOD3', 'SETD1A', 'SETD1B', 'SETD2', 'SETD7', 'SETD8', 'SETDB1', 'SETDB2', 'SETMAR', 'SUV39H1', 'SUV39H2', 'SUV420H1', 'SUV420H2', 'TMLHE', 'WHSC1', 'WHSC1L1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(lysineDeg), name = "lysineDeg", search=TRUE)
#Warning: The following features are not present in the object: SETD8, SUV420H1, SUV420H2, WHSC1, WHSC1L1, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(lysineDeg), name = "lysineDeg", search=TRUE)
#Warning: The following features are not present in the object: SETD8, SUV420H1, SUV420H2, WHSC1, WHSC1L1, attempting to find updated synonyms


cysteineMethionineMet <- c('ADI1', 'AHCY', 'AHCYL1', 'AHCYL2', 'AMD1', 'APIP', 'BHMT', 'CBS', 'CDO1', 'CTH', 'DNMT1', 'DNMT3A', 'DNMT3B', 'DNMT3L', 'ENOPH1', 'GOT1', 'GOT2', 'IL4I1', 'LDHA', 'LDHAL6A', 'LDHAL6B', 'LDHB', 'LDHC', 'MAT1A', 'MAT2A', 'MAT2B', 'MPST', 'MTAP', 'MTR', 'SDS', 'SMS', 'SRM', 'TAT', 'TRDMT1')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(cysteineMethionineMet), name = "cysteineMethionineMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(cysteineMethionineMet), name = "cysteineMethionineMet", search=TRUE)


phenylalanineMet <- c('ALDH1A3', 'ALDH3A1', 'ALDH3B1', 'ALDH3B2', 'AOC2', 'AOC3', 'DDC', 'GOT1', 'GOT2', 'HPD', 'IL4I1', 'MAOA', 'MAOB', 'MIF', 'NAT6', 'PAH', 'PRDX6', 'TAT')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(phenylalanineMet), name = "phenylalanineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(phenylalanineMet), name = "phenylalanineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, attempting to find updated synonyms


taurineHypotaurMet <- c('ADO', 'BAAT', 'CDO1', 'CSAD', 'GAD1', 'GAD2', 'GGT1', 'GGT5', 'GGT6', 'GGT7')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(taurineHypotaurMet), name = "taurineHypotaurMet", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(taurineHypotaurMet), name = "taurineHypotaurMet", search=TRUE)


aminoacyltRNAbios <- c('AARS', 'AARS2', 'CARS', 'CARS2', 'DARS', 'DARS2', 'EARS2', 'EPRS', 'FARS2', 'FARSA', 'FARSB', 'GARS', 'HARS', 'HARS2', 'IARS', 'IARS2', 'KARS', 'LARS', 'LARS2', 'MARS', 'MARS2', 'MTFMT', 'NARS', 'NARS2', 'PARS2', 'PSTK', 'QARS', 'RARS', 'RARS2', 'SARS', 'SARS2', 'SEPSECS', 'TARS', 'TARS2', 'TARSL2', 'VARS', 'VARS2', 'WARS', 'WARS2', 'YARS', 'YARS2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(aminoacyltRNAbios), name = "aminoacyltRNAbios", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(aminoacyltRNAbios), name = "aminoacyltRNAbios", search=TRUE)


tryptophanMet <- c('AADAT', 'AANAT', 'ABP1', 'ACAT1', 'ACAT2', 'ACMSD', 'AFMID', 'ALDH1B1', 'ALDH2', 'ALDH3A2', 'ALDH7A1', 'ALDH9A1', 'AOX1', 'ASMT', 'CAT', 'CYP1A1', 'CYP1A2', 'CYP1B1', 'DDC', 'ECHS1', 'EHHADH', 'GCDH', 'HAAO', 'HADH', 'HADHA', 'IDO1', 'IDO2', 'IL4I1', 'INMT', 'KMO', 'KYNU', 'MAOA', 'MAOB', 'OGDH', 'OGDHL', 'TDO2', 'TPH1', 'TPH2', 'WARS', 'WARS2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(tryptophanMet), name = "tryptophanMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(tryptophanMet), name = "tryptophanMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, attempting to find updated synonyms


tyrosineMet <- c('ADH1A', 'ADH1B', 'ADH1C', 'ADH4', 'ADH5', 'ADH6', 'ADH7', 'ALDH1A3', 'ALDH3A1', 'ALDH3B1', 'ALDH3B2', 'AOC2', 'AOC3', 'AOX1', 'COMT', 'DBH', 'DCT', 'DDC', 'FAH', 'GOT1', 'GOT2', 'GSTZ1', 'HEMK1', 'HGD', 'HPD', 'IL4I1', 'LCMT1', 'LCMT2', 'MAOA', 'MAOB', 'METTL2B', 'METTL6', 'MIF', 'NAT6', 'PNMT', 'TAT', 'TH', 'TPO', 'TRMT11', 'TYR', 'TYRP1', 'WBSCR22')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(tyrosineMet), name = "tyrosineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, WBSCR22, attempting to find updated synonyms
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(tyrosineMet), name = "tyrosineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, WBSCR22, attempting to find updated synonyms


valineLeucineIsoleucBios <- c('BCAT1', 'BCAT2', 'IARS', 'IARS2', 'LARS', 'LARS2', 'PDHA1', 'PDHA2', 'PDHB', 'VARS', 'VARS2')

OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(valineLeucineIsoleucBios), name = "valineLeucineIsoleucBios", search=TRUE)
OvarianSetGrpd.H.1 <- AddModuleScore(OvarianSetGrpd.H.1, features = list(valineLeucineIsoleucBios), name = "valineLeucineIsoleucBios", search=TRUE)

names(OvarianSetGrpd.1[[]])
names(OvarianSetGrpd.H.1[[]])

saveRDS(OvarianSetGrpd.1, paste(metadir1.H,"SeuratObj-with-Metabolic-Pathway-Scores1",date,".rds",sep=""))
saveRDS(OvarianSetGrpd.H.1, paste(metadir1.H,"SeuratObj-with-Metabolic-Pathway-Scores1",date,".rds",sep=""))



### Make per sample subsets and export all scores for the sample
OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)
OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))


OvarianCellLineGrpd.H.1 <- subset(x=OvarianSetGrpd.H.1, cells=celllinesonly.H.1)
OvarianSensitiveCellLines.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=Sonly.H.1)
OvarianResistantCellLines.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=Ronly.H.1)

OVCAR4pair.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=c(OVCAR4.H.1_S_cells,OVCAR4.H.1_R_cells))
OVCA3pair.H.1 <- subset(x=OvarianCellLineGrpd.H.1, cells=c(OVCA3.H.1_S_cells,OVCA3.H.1_R_cells))
```

###AFTER CALCULATING SCORES, SUBSET BY TYPE, THEN COMPUTE AVERAGE SCORE PER CELL LINE & EXPORT INDIVIDUAL SCORES

```{r}
OVCAR4.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_S_cells)
OVCAR4.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_R_cells)
OVCA3.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_S_cells)
OVCA3.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_R_cells)

OVCAR4.H.1_S <- subset(x=OvarianSetGrpd.H.1, cells=OVCAR4.H.1_S_cells)
OVCAR4.H.1_R <- subset(x=OvarianSetGrpd.H.1, cells=OVCAR4.H.1_R_cells)
OVCA3.H.1_S <- subset(x=OvarianSetGrpd.H.1, cells=OVCA3.H.1_S_cells)
OVCA3.H.1_R <- subset(x=OvarianSetGrpd.H.1, cells=OVCA3.H.1_R_cells)

scores.1 <- c("OXPHOS1","glycolysis1","citricAcid1","ascorbateAldarate1","chondroitinSulfate1","fructoseMannose1","galactose1","keratanSulfate1","heparanSulfate1","pentosePhosphate1","pyruvateMet1","starchSucrose1","etherLipidMet1","arachidonicAcidMet1","fattyAcidMet1","glycerolipidMet1","glycerophospholipidMet1","glyoxylateDicarbMet1","linoleicAcidMet1","sphingolipidMet1","propanoateMet1","pyrimidineMet1","purineMet1","alaniAspratGlutamMet1","arginineProlineMet1","butanoateMet1","glutathioneMet1","glycineSerineThreonMet1","histidineMet1","lysineDeg1","cysteineMethionineMet1","phenylalanineMet1","taurineHypotaurMet1","aminoacyltRNAbios1","tryptophanMet1","tyrosineMet1","valineLeucineIsoleucBios1")

scores.H.1 <- c("OXPHOS1","glycolysis1","citricAcid1","ascorbateAldarate1","chondroitinsulfate1","fructoseMannose1","galactose1","keratanSulfate1","heparanSulfate1","pentosePhosphate1","pyruvateMet1","starchSucrose1","etherLipidMet1","arachidonicAcidMet1","fattyAcidMet1","glycerolipidMet1","glycerophospholipidMet1","glyoxylateDicarbMet1","linoleicAcidMet1","sphingolipidMet1","propanoateMet1","pyrimidineMet1","purineMet1","alaniAspratGlutamMet1","arginineProlineMet1","butanoateMet1","glutathioneMet1","glycineSerineThreonMet1","histidineMet1","lysineDeg1","cysteineMethionineMet1","phenylalanineMet1","taurineHypotaurMet1","aminoacyltRNAbios1","tryptophanMet1","tyrosineMet1","valineLeucineIsoleucBios1")
```


###Make new cvs files with cell line, pathway scores and clusters
Sample code
```{r}
#No harmony
#OVCAR4 R 
data_scores_OVCAR4.1_R <- as.data.frame(as.matrix(OVCAR4.1_R[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.1_R_clusters <- OVCAR4.1_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.1_R_ALL <- cbind(data_scores_OVCAR4.1_R,OVCAR4.1_R_clusters) #save the whole three columns together
fwrite(x = OVCAR4.1_R_ALL, file = paste(metadir1,"OVCAR4_R","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.1_R_ALL, paste(metadir1,"OVCAR4_R","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCAR4 S 
data_scores_OVCAR4.1_S <- as.data.frame(as.matrix(OVCAR4.1_S[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.1_S_clusters <- OVCAR4.1_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.1_S_ALL <- cbind(data_scores_OVCAR4.1_S,OVCAR4.1_S_clusters) #save the whole three columns together
fwrite(x = OVCAR4.1_S_ALL, file = paste(metadir1,"OVCAR4_S","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.1_S_ALL, paste(metadir1,"OVCAR4_S","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3 R
data_scores_OVCA3.1_R <- as.data.frame(as.matrix(OVCA3.1_R[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCA3.1_R_clusters <- OVCA3.1_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.1_R_ALL <- cbind(data_scores_OVCA3.1_R,OVCA3.1_R_clusters) #save the whole three columns together
fwrite(x = OVCA3.1_R_ALL, file = paste(metadir1,"OVCA3_R","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.1_R_ALL, paste(metadir1,"OVCA3_R","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3 S
data_scores_OVCA3.1_S <- as.data.frame(as.matrix(OVCA3.1_S[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCA3.1_S_clusters <- OVCA3.1_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.1_S_ALL <- cbind(data_scores_OVCA3.1_S,OVCA3.1_S_clusters) #save the whole three columns together
fwrite(x = OVCA3.1_S_ALL, file = paste(metadir1,"OVCA3_S","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.1_S_ALL, paste(metadir1,"OVCA3_S","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))


#HARMONY
#OVCAR4.H.1 R
data_scores_OVCAR4.H.1_R <- as.data.frame(as.matrix(OVCAR4.H.1_R[[scores.H.1]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.H.1_R_clusters <- OVCAR4.H.1_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.H.1_R_ALL <- cbind(data_scores_OVCAR4.H.1_R,OVCAR4.H.1_R_clusters) #save the whole three columns together
fwrite(x = OVCAR4.H.1_R_ALL, file = paste(metadir1.H,"OVCAR4.H_R","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.H.1_R_ALL, paste(metadir1.H,"OVCAR4.H_R","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCAR4.H.1 S
data_scores_OVCAR4.H.1_S <- as.data.frame(as.matrix(OVCAR4.H.1_S[[scores.H.1]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.H.1_S_clusters <- OVCAR4.H.1_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.H.1_S_ALL <- cbind(data_scores_OVCAR4.H.1_S,OVCAR4.H.1_S_clusters) #save the whole three columns together
fwrite(x = OVCAR4.H.1_S_ALL, file = paste(metadir1.H,"OVCAR4.H_S","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.H.1_S_ALL, paste(metadir1.H,"OVCAR4.H_S","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3.H.1 R
data_scores_OVCA3.H.1_R <- as.data.frame(as.matrix(OVCA3.H.1_R[[scores.H.1]])) #save the scores and the cell names together
#Check the step below 
OVCA3.H.1_R_clusters <- OVCA3.H.1_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.H.1_R_ALL <- cbind(data_scores_OVCA3.H.1_R,OVCA3.H.1_R_clusters) #save the whole three columns together
fwrite(x = OVCA3.H.1_R_ALL, file = paste(metadir1.H,"OVCA3.H_R","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.H.1_R_ALL, paste(metadir1.H,"OVCA3.H_R","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3.H.1 S
data_scores_OVCA3.H.1_S <- as.data.frame(as.matrix(OVCA3.H.1_S[[scores.H.1]])) #save the scores and the cell names together
#Check the step below 
OVCA3.H.1_S_clusters <- OVCA3.H.1_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.H.1_S_ALL <- cbind(data_scores_OVCA3.H.1_S,OVCA3.H.1_S_clusters) #save the whole three columns together
fwrite(x = OVCA3.H.1_S_ALL, file = paste(metadir1.H,"OVCA3.H_S","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.H.1_S_ALL, paste(metadir1.H,"OVCA3.H_S","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))
```

data_scorestest <- as.data.frame(as.matrix(OVCAR4.2_S[[scores4.2]])) #save the scores and the cell names together
OVCAR4.2_S_clusters <- OVCAR4.2_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.2_S_ALL <- cbind(data_scorestest,OVCAR4.2_S_clusters) #save the whole three columns together
fwrite(x = OVCAR4.2_S_ALL, file = paste(metadir42,"OVCAR4_S","_average-scorestest",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 

##Approach 2
###Import file with and without harmony 
```{r}
metadir2 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 2/OvarianSet_Approach2_Seurat-Metabolic-Analysis_'
metadir2.H <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 2/OvarianSet_H_Approach2_Seurat-Metabolic-Analysis_'

#No harmony 
OvarianSet.2 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Cell Cycle analysis/Approach 2/OvarianSet_before-CC-genes_SeuratObj_thrStep8_post-res0.6-clustering_2022-04-08.rds")

OvarianSet.2$Cluster <- OvarianSet.2$RNA_snn_res.0.6
OvarianSet.2$name <- OvarianSet.2$orig.ident
names(OvarianSet.2[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "S.Score"         "G2M.Score"       "Phase"           "old.ident"      
# [9] "CC.Difference"   "RNA_snn_res.0.6" "seurat_clusters" "Cluster"         "name"   

### Labelling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.2$name)
tmp1 <- as.matrix(OvarianSet.2$name)
numCells <- 5091
for (val in 1:numCells) {
### check name
   tmpname <- OvarianSet.2[[]][val,'name']
## from name set CMML or normal
  if (isTRUE(tmpname == "OVCA3_R" || tmpname == "OVCAR4_R")) {
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }

OvarianSetGrpd.2 <- OvarianSet.2
#OvarianSetGrpd.2$samptype <- tmp1

names(OvarianSetGrpd.2[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.2_S_cells <- WhichCells(OvarianSetGrpd.2, expression = (orig.ident=="OVCA3_S"))
OVCA3.2_R_cells <- WhichCells(OvarianSetGrpd.2, expression = (orig.ident=="OVCA3_R"))
OVCAR4.2_S_cells <- WhichCells(OvarianSetGrpd.2, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.2_R_cells <- WhichCells(OvarianSetGrpd.2, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.2 <- c(OVCA3.2_S_cells, OVCA3.2_R_cells, OVCAR4.2_S_cells, OVCAR4.2_R_cells)

OvarianCellLineGrpd.2 <- subset(x=OvarianSetGrpd.2, cells=celllinesonly.2)

OvarianCellLineGrpd.2@active.ident <- OvarianCellLineGrpd.2$Cluster

Sonly.2 <- c(OVCA3.2_S_cells,OVCAR4.2_S_cells)
Ronly.2 <- c(OVCA3.2_R_cells,OVCAR4.2_R_cells)

OvarianSensitiveCellLines.2 <- subset(x=OvarianCellLineGrpd.2, cells=Sonly.2)
OvarianResistantCellLines.2 <- subset(x=OvarianCellLineGrpd.2, cells=Ronly.2)

OVCAR4pair.2 <- subset(x=OvarianCellLineGrpd.2, cells=c(OVCAR4.2_S_cells,OVCAR4.2_R_cells))
OVCA3pair.2 <- subset(x=OvarianCellLineGrpd.2, cells=c(OVCA3.2_S_cells,OVCA3.2_R_cells))


#Harmony 
OvarianSet.H.2 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Cell Cycle analysis/Approach 2/OvarianSet_before_H-CC-genes_SeuratObj_thrStep8_post-res0.6-clustering_2022-04-08.rds")

OvarianSet.H.2$Cluster <- OvarianSet.H.2$RNA_snn_res.0.6
OvarianSet.H.2$name <- OvarianSet.H.2$orig.ident
names(OvarianSet.H.2[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "S.Score"         "G2M.Score"       "Phase"           "old.ident"      
# [9] "CC.Difference"   "RNA_snn_res.0.6" "seurat_clusters" "Cluster"         "name"  

### Labelling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.H.2$name)
tmp1 <- as.matrix(OvarianSet.H.2$name)
numCells <- 5091
for (val in 1:numCells) {
### check name
   tmpname <- OvarianSet.H.2[[]][val,'name']
## from name set CMML or normal
  if (isTRUE(tmpname == "OVCA3_R" || tmpname == "OVCAR4_R")) {
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }


OvarianSetGrpd.H.2 <- OvarianSet.H.2
#OvarianSetGrpd.H.2$samptype <- tmp1

names(OvarianSetGrpd.H.2[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.H.2_S_cells <- WhichCells(OvarianSetGrpd.H.2, expression = (orig.ident=="OVCA3_S"))
OVCA3.H.2_R_cells <- WhichCells(OvarianSetGrpd.H.2, expression = (orig.ident=="OVCA3_R"))
OVCAR4.H.2_S_cells <- WhichCells(OvarianSetGrpd.H.2, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.H.2_R_cells <- WhichCells(OvarianSetGrpd.H.2, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.H.2 <- c(OVCA3.H.2_S_cells, OVCA3.H.2_R_cells, OVCAR4.H.2_S_cells, OVCAR4.H.2_R_cells)

OvarianCellLineGrpd.H.2 <- subset(x=OvarianSetGrpd.H.2, cells=celllinesonly.H.2)

OvarianCellLineGrpd.H.2@active.ident <- OvarianCellLineGrpd.H.2$Cluster

Sonly.H.2 <- c(OVCA3.H.2_S_cells,OVCAR4.H.2_S_cells)
Ronly.H.2 <- c(OVCA3.H.2_R_cells,OVCAR4.H.2_R_cells)

OvarianSensitiveCellLines.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=Sonly.H.2)
OvarianResistantCellLines.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=Ronly.H.2)

OVCAR4pair.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=c(OVCAR4.H.2_S_cells,OVCAR4.H.2_R_cells))
OVCA3pair.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=c(OVCA3.H.2_S_cells,OVCA3.H.2_R_cells))
```
###Metabolic Pathway Score Analysis 
```{r}
OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(OXPHOSgenes), name = "OXPHOS", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(OXPHOSgenes), name = "OXPHOS", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glycolysisGenes), name = "glycolysis", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glycolysisGenes), name = "glycolysis", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(citricAcidGenes), name = "citricAcid", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(citricAcidGenes), name = "citricAcid", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(ascorbAldarMet), name = "ascorbateAldarate", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(ascorbAldarMet), name = "ascorbateAldarate", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(chondroitinSulfateBios), name = "chondroitinSulfate", search=TRUE)

OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(chondroitinSulfateBios), name = "chondroitinsulfate", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(fructMannMet), name = "fructoseMannose", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(fructMannMet), name = "fructoseMannose", search=TRUE)
names(OvarianSetGrpd.H.2[[]])



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(galactose), name = "galactose", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(galactose), name = "galactose", search=TRUE)
names(OvarianSetGrpd.H.2[[]])



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(keratanSulfate), name = "keratanSulfate", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(keratanSulfate), name = "keratanSulfate", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(heparanSulfate), name = "heparanSulfate", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(heparanSulfate), name = "heparanSulfate", search=TRUE)
names(OvarianSetGrpd.H.2[[]])



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(pentosePhosphate), name = "pentosePhosphate", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: LOC729020, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(pentosePhosphate), name = "pentosePhosphate", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: LOC729020, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(pyruvateMet), name = "pyruvateMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(pyruvateMet), name = "pyruvateMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: PKM2, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(starchSucrose), name = "starchSucrose", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: GBA3, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(starchSucrose), name = "starchSucrose", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: GBA3, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(etherLipidMet), name = "etherLipidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(etherLipidMet), name = "etherLipidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(arachidonicAcidMet), name = "arachidonicAcidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: GPX1, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(arachidonicAcidMet), name = "arachidonicAcidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: GPX1, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(fattyAcidMet), name = "fattyAcidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(fattyAcidMet), name = "fattyAcidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glycerolipidMet), name = "glycerolipidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, DAK, PNLIPRP2, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glycerolipidMet), name = "glycerolipidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, DAK, PNLIPRP2, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glycerophospholipidMet), name = "glycerophospholipidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, C17orf48, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glycerophospholipidMet), name = "glycerophospholipidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: AGPAT6, AGPAT9, C17orf48, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glyoxylateDicarbMet), name = "glyoxylateDicarbMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glyoxylateDicarbMet), name = "glyoxylateDicarbMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(linoleicAcidMet), name = "linoleicAcidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(linoleicAcidMet), name = "linoleicAcidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(sphingolipidMet), name = "sphingolipidMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: ASAH2C, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(sphingolipidMet), name = "sphingolipidMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: ASAH2C, PPAP2A, PPAP2B, PPAP2C, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(propanoateMet), name = "propanoateMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: LOC283398, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(propanoateMet), name = "propanoateMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: LOC283398, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(pyrimidineMet), name = "pyrimidineMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: CTPS, NT5C3, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(pyrimidineMet), name = "pyrimidineMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: CTPS, NT5C3, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(purineMet), name = "purineMet", search=TRUE)
names(OvarianSetGrpd.2[[]])
#Warning: The following features are not present in the object: C17orf48, GUCY1A3, GUCY1B3, NT5C3, PKM2, PRHOXNB, PRUNE, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(purineMet), name = "purineMet", search=TRUE)
names(OvarianSetGrpd.H.2[[]])
#Warning: The following features are not present in the object: C17orf48, GUCY1A3, GUCY1B3, NT5C3, PKM2, PRHOXNB, PRUNE, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(alaniAspratGlutamMet), name = "alaniAspratGlutamMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(alaniAspratGlutamMet), name = "alaniAspratGlutamMet", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(arginineProlineMet), name = "arginineProlineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, ADC, PYCRL, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(arginineProlineMet), name = "arginineProlineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, ADC, PYCRL, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(butanoateMet), name = "butanoateMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(butanoateMet), name = "butanoateMet", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glutathioneMet), name = "glutathioneMet", search=TRUE)
#Warning: The following features are not present in the object: GPX1, GSTT1, GSTT2, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glutathioneMet), name = "glutathioneMet", search=TRUE)
#Warning: The following features are not present in the object: GPX1, GSTT1, GSTT2, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(glycineSerineThreonMet), name = "glycineSerineThreonMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(glycineSerineThreonMet), name = "glycineSerineThreonMet", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(histidineMet), name = "histidineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, WBSCR22, attempting to find updated synonyms
OvarianSetGrpd.H.2<- AddModuleScore(OvarianSetGrpd.H.2, features = list(histidineMet), name = "histidineMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, WBSCR22, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(lysineDeg), name = "lysineDeg", search=TRUE)
#Warning: The following features are not present in the object: SETD8, SUV420H1, SUV420H2, WHSC1, WHSC1L1, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(lysineDeg), name = "lysineDeg", search=TRUE)
#Warning: The following features are not present in the object: SETD8, SUV420H1, SUV420H2, WHSC1, WHSC1L1, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(cysteineMethionineMet), name = "cysteineMethionineMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(cysteineMethionineMet), name = "cysteineMethionineMet", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(phenylalanineMet), name = "phenylalanineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(phenylalanineMet), name = "phenylalanineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(taurineHypotaurMet), name = "taurineHypotaurMet", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(taurineHypotaurMet), name = "taurineHypotaurMet", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(aminoacyltRNAbios), name = "aminoacyltRNAbios", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(aminoacyltRNAbios), name = "aminoacyltRNAbios", search=TRUE)



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(tryptophanMet), name = "tryptophanMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(tryptophanMet), name = "tryptophanMet", search=TRUE)
#Warning: The following features are not present in the object: ABP1, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(tyrosineMet), name = "tyrosineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, WBSCR22, attempting to find updated synonyms
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(tyrosineMet), name = "tyrosineMet", search=TRUE)
#Warning: The following features are not present in the object: NAT6, WBSCR22, attempting to find updated synonyms



OvarianSetGrpd.2 <- AddModuleScore(OvarianSetGrpd.2, features = list(valineLeucineIsoleucBios), name = "valineLeucineIsoleucBios", search=TRUE)
OvarianSetGrpd.H.2 <- AddModuleScore(OvarianSetGrpd.H.2, features = list(valineLeucineIsoleucBios), name = "valineLeucineIsoleucBios", search=TRUE)

names(OvarianSetGrpd.2[[]])
names(OvarianSetGrpd.H.2[[]])

saveRDS(OvarianSetGrpd.2, paste(metadir2,"SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))
saveRDS(OvarianSetGrpd.H.2, paste(metadir2.H,"SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))



### Make per sample subsets and export all scores for the sample
OvarianCellLineGrpd.2 <- subset(x=OvarianSetGrpd.2, cells=celllinesonly.2)
OvarianSensitiveCellLines.2 <- subset(x=OvarianCellLineGrpd.2, cells=Sonly.2)
OvarianResistantCellLines.2 <- subset(x=OvarianCellLineGrpd.2, cells=Ronly.2)

OVCAR4pair.2 <- subset(x=OvarianCellLineGrpd.2, cells=c(OVCAR4.2_S_cells,OVCAR4.2_R_cells))
OVCA3pair.2 <- subset(x=OvarianCellLineGrpd.2, cells=c(OVCA3.2_S_cells,OVCA3.2_R_cells))


OvarianCellLineGrpd.H.2 <- subset(x=OvarianSetGrpd.H.2, cells=celllinesonly.H.2)
OvarianSensitiveCellLines.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=Sonly.H.2)
OvarianResistantCellLines.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=Ronly.H.2)

OVCAR4pair.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=c(OVCAR4.H.2_S_cells,OVCAR4.H.2_R_cells))
OVCA3pair.H.2 <- subset(x=OvarianCellLineGrpd.H.2, cells=c(OVCA3.H.2_S_cells,OVCA3.H.2_R_cells))
```
###AVERAGE SCORE PER CELL LINE, GETTING THE CELL LINES READY FOR EXPORTING 

```{r}
OVCAR4.2_S <- subset(x=OvarianSetGrpd.2, cells=OVCAR4.2_S_cells)
OVCAR4.2_R <- subset(x=OvarianSetGrpd.2, cells=OVCAR4.2_R_cells)
OVCA3.2_S <- subset(x=OvarianSetGrpd.2, cells=OVCA3.2_S_cells)
OVCA3.2_R <- subset(x=OvarianSetGrpd.2, cells=OVCA3.2_R_cells)

OVCAR4.H.2_S <- subset(x=OvarianSetGrpd.H.2, cells=OVCAR4.H.2_S_cells)
OVCAR4.H.2_R <- subset(x=OvarianSetGrpd.H.2, cells=OVCAR4.H.2_R_cells)
OVCA3.H.2_S <- subset(x=OvarianSetGrpd.H.2, cells=OVCA3.H.2_S_cells)
OVCA3.H.2_R <- subset(x=OvarianSetGrpd.H.2, cells=OVCA3.H.2_R_cells)

scores.2 <- c("OXPHOS1","glycolysis1","citricAcid1","ascorbateAldarate1","chondroitinSulfate1","fructoseMannose1","galactose1","keratanSulfate1","heparanSulfate1","pentosePhosphate1","pyruvateMet1","starchSucrose1","etherLipidMet1","arachidonicAcidMet1","fattyAcidMet1","glycerolipidMet1","glycerophospholipidMet1","glyoxylateDicarbMet1","linoleicAcidMet1","sphingolipidMet1","propanoateMet1","pyrimidineMet1","purineMet1","alaniAspratGlutamMet1","arginineProlineMet1","butanoateMet1","glutathioneMet1","glycineSerineThreonMet1","histidineMet1","lysineDeg1","cysteineMethionineMet1","phenylalanineMet1","taurineHypotaurMet1","aminoacyltRNAbios1","tryptophanMet1","tyrosineMet1","valineLeucineIsoleucBios1")

scores.H.2 <- c("OXPHOS1","glycolysis1","citricAcid1","ascorbateAldarate1","chondroitinsulfate1","fructoseMannose1","galactose1","keratanSulfate1","heparanSulfate1","pentosePhosphate1","pyruvateMet1","starchSucrose1","etherLipidMet1","arachidonicAcidMet1","fattyAcidMet1","glycerolipidMet1","glycerophospholipidMet1","glyoxylateDicarbMet1","linoleicAcidMet1","sphingolipidMet1","propanoateMet1","pyrimidineMet1","purineMet1","alaniAspratGlutamMet1","arginineProlineMet1","butanoateMet1","glutathioneMet1","glycineSerineThreonMet1","histidineMet1","lysineDeg1","cysteineMethionineMet1","phenylalanineMet1","taurineHypotaurMet1","aminoacyltRNAbios1","tryptophanMet1","tyrosineMet1","valineLeucineIsoleucBios1")
```

###Make new cvs files with cell lines, pathway scores and clusters 
This includes more information in the table
```{r}
#No harmony
#OVCAR4 R 
data_scores_OVCAR4.2_R <- as.data.frame(as.matrix(OVCAR4.2_R[[scores.2]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.2_R_clusters <- OVCAR4.2_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.2_R_ALL <- cbind(data_scores_OVCAR4.2_R,OVCAR4.2_R_clusters) #save the whole three columns together
fwrite(x = OVCAR4.2_R_ALL, file = paste(metadir2,"OVCAR4_R","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.2_R_ALL, paste(metadir2,"OVCAR4_R","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCAR4 S 
data_scores_OVCAR4.2_S <- as.data.frame(as.matrix(OVCAR4.2_S[[scores.2]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.2_S_clusters <- OVCAR4.2_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.2_S_ALL <- cbind(data_scores_OVCAR4.2_S,OVCAR4.2_S_clusters) #save the whole three columns together
fwrite(x = OVCAR4.2_S_ALL, file = paste(metadir2,"OVCAR4_S","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.2_S_ALL, paste(metadir2,"OVCAR4_S","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3 R
data_scores_OVCA3.2_R <- as.data.frame(as.matrix(OVCA3.2_R[[scores.2]])) #save the scores and the cell names together
#Check the step below 
OVCA3.2_R_clusters <- OVCA3.2_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.2_R_ALL <- cbind(data_scores_OVCA3.2_R,OVCA3.2_R_clusters) #save the whole three columns together
fwrite(x = OVCA3.2_R_ALL, file = paste(metadir2,"OVCA3_R","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.2_R_ALL, paste(metadir2,"OVCA3_R","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3 S
data_scores_OVCA3.2_S <- as.data.frame(as.matrix(OVCA3.2_S[[scores.2]])) #save the scores and the cell names together
#Check the step below 
OVCA3.2_S_clusters <- OVCA3.2_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.2_S_ALL <- cbind(data_scores_OVCA3.2_S,OVCA3.2_S_clusters) #save the whole three columns together
fwrite(x = OVCA3.2_S_ALL, file = paste(metadir2,"OVCA3_S","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.2_S_ALL, paste(metadir2,"OVCA3_S","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))


#HARMONY
#OVCAR4.H.2 R
data_scores_OVCAR4.H.2_R <- as.data.frame(as.matrix(OVCAR4.H.2_R[[scores.H.2]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.H.2_R_clusters <- OVCAR4.H.2_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.H.2_R_ALL <- cbind(data_scores_OVCAR4.H.2_R,OVCAR4.H.2_R_clusters) #save the whole three columns together
fwrite(x = OVCAR4.H.2_R_ALL, file = paste(metadir2.H,"OVCAR4.H_R","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.H.2_R_ALL, paste(metadir2.H,"OVCAR4.H_R","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCAR4.H.2 S
data_scores_OVCAR4.H.2_S <- as.data.frame(as.matrix(OVCAR4.H.2_S[[scores.H.2]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.H.2_S_clusters <- OVCAR4.H.2_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.H.2_S_ALL <- cbind(data_scores_OVCAR4.H.2_S,OVCAR4.H.2_S_clusters) #save the whole three columns together
fwrite(x = OVCAR4.H.2_S_ALL, file = paste(metadir2.H,"OVCAR4.H_S","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.H.2_S_ALL, paste(metadir2.H,"OVCAR4.H_S","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3.H.2 R
data_scores_OVCA3.H.2_R <- as.data.frame(as.matrix(OVCA3.H.2_R[[scores.H.2]])) #save the scores and the cell names together
#Check the step below 
OVCA3.H.2_R_clusters <- OVCA3.H.2_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.H.2_R_ALL <- cbind(data_scores_OVCA3.H.2_R,OVCA3.H.2_R_clusters) #save the whole three columns together
fwrite(x = OVCA3.H.2_R_ALL, file = paste(metadir2.H,"OVCA3.H_R","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.H.2_R_ALL, paste(metadir2.H,"OVCA3.H_R","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3.H.2 S
data_scores_OVCA3.H.2_S <- as.data.frame(as.matrix(OVCA3.H.2_S[[scores.H.2]])) #save the scores and the cell names together
#Check the step below 
OVCA3.H.2_S_clusters <- OVCA3.H.2_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.H.2_S_ALL <- cbind(data_scores_OVCA3.H.2_S,OVCA3.H.2_S_clusters) #save the whole three columns together
fwrite(x = OVCA3.H.2_S_ALL, file = paste(metadir2.H,"OVCA3.H_S","_average-scoresALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.H.2_S_ALL, paste(metadir2.H,"OVCA3.H_S","SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))
```
#Violin plots 
pdf("./OVCAR4_S+R_ViolinPlot_nFeatures_2019-10-28.pdf")
vPlot <- VlnPlot(object = OVCAR4, features = c("nFeature_RNA"))
print(vPlot)
dev.off() 

##Import files
```{r}
library(future)
library(ggplot2)
library(bigmemory)
library(Seurat)
library(data.table)
library(dplyr)
library(rdetools)
# library(clustree)
sessionInfo()

plan("multiprocess", workers=16)

options(future.globals.maxSize=134217728000) ### for 128GB * 1024*1024

date = "_2022-05-24"
#figdirOrg = "./Resolution-of-1/OvarianSet_All-Samples_"

metadir1 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_Approach1_Seurat-Metabolic-Analysis_'
metadir1.H <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_H_Approach1_Seurat-Metabolic-Analysis_'

OvarianSetGrpd.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_Approach1_Seurat-Metabolic-Analysis_SeuratObj-with-Metabolic-Pathway-Scores1_2022-05-19.rds")
OvarianSetGrpd.H.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_H_Approach1_Seurat-Metabolic-Analysis_SeuratObj-with-Metabolic-Pathway-Scores1_2022-05-19.rds") 

#Change the active identity 
OvarianSetGrpd.1.Orig <- SetIdent(OvarianSetGrpd.1, value= OvarianSetGrpd.1@meta.data$orig.ident) #change the active identity to give information about the resistant and sensitive cell lines 
OvarianSetGrpd.1.Orig@active.ident #check if the active identity is the resistant and sensitive cell lines 


OvarianSetGrpd.H.1.Orig <- SetIdent(OvarianSetGrpd.H.1, value=OvarianSetGrpd.1@meta.data$orig.ident)
OvarianSetGrpd.H.1.Orig@active.ident 
```
##Make the violin plots 
pdf(paste(metadir2,"UMAP_OXPHOS-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.2, features='OXPHOS1') 
print(dPlot)
dev.off()



pdf("./OVCAR4_S+R_ViolinPlot_nFeatures_2019-10-28.pdf")
vPlot <- VlnPlot(object = OvarianSetGrpd.1.Active, features = 'OXPHOS1')
print(vPlot)

```{r}
pdf(paste(metadir1,"Violin_OXPHOS-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1.Orig, features = 'OXPHOS1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Glycolysis-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1.Orig, features = 'glycolysis1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Citric-Acid-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1.Orig, features = 'citricAcid1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Ascorbate-Aldarate-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1.Orig, features = 'ascorbateAldarate1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Chondroitin-Sulfate-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='chondroitinSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Fructose-Mannose-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='fructoseMannose1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Galactose-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='galactose1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Keratan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='keratanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Heparan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='heparanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Pentose-Phosphate-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='pentosePhosphate1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Pyruvate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='pyruvateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Starch-Sucrose-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='starchSucrose1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Ether-Lipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='etherLipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Arachidonic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='arachidonicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Fatty-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='fattyAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Glycerolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='glycerolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Glycerophospholipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='glycerophospholipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Glyoxylate-Dicarb-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='glyoxylateDicarbMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Linoleic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='linoleicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Sphingolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='sphingolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Propanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='propanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Pyrimidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='pyrimidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Purine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='purineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Alani-Asprat-Glutam-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='alaniAspratGlutamMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Arginine-Proline-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='arginineProlineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Butanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='butanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Glutathione-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='glutathioneMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Glycine-Serine-Threon-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='glycineSerineThreonMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Histidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='histidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Lysine-Degradation-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='lysineDeg1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Cysteine-Methionine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='cysteineMethionineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Phenylalanine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='phenylalanineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Taurine-Hypotaur-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='taurineHypotaurMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_aminoacyl-tRNA-biosynthesis-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='aminoacyltRNAbios1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Tryptophan-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='tryptophanMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Tyrosine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='tyrosineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"Violin_Valine-Leucine-Isoleucine-Biosynthesis-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.1.Orig, features='valineLeucineIsoleucBios1') 
print(dPlot)
dev.off()



#Harmony plots
pdf(paste(metadir1.H,"Violin_OXPHOS-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.H.1.Orig, features = 'OXPHOS1')
print(vPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Glycolysis-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.H.1.Orig, features = 'glycolysis1')
print(vPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Citric-Acid-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.H.1.Orig, features = 'citricAcid1')
print(vPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Ascorbate-Aldarate-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.H.1.Orig, features = 'ascorbateAldarate1')
print(vPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Chondroitin-Sulfate-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='chondroitinsulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Fructose-Mannose-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='fructoseMannose1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Galactose-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='galactose1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Keratan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='keratanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Heparan-Sulfate-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='heparanSulfate1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Pentose-Phosphate-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='pentosePhosphate1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Pyruvate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='pyruvateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Starch-Sucrose-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='starchSucrose1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Ether-Lipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='etherLipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Arachidonic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='arachidonicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Fatty-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='fattyAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Glycerolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='glycerolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Glycerophospholipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='glycerophospholipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Glyoxylate-Dicarb-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='glyoxylateDicarbMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Linoleic-Acid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='linoleicAcidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Sphingolipid-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='sphingolipidMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Propanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='propanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Pyrimidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='pyrimidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Purine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='purineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Alani-Asprat-Glutam-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='alaniAspratGlutamMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Arginine-Proline-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='arginineProlineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Butanoate-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='butanoateMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Glutathione-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='glutathioneMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Glycine-Serine-Threon-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='glycineSerineThreonMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Histidine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='histidineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Lysine-Degradation-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='lysineDeg1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Cysteine-Methionine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='cysteineMethionineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Phenylalanine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='phenylalanineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Taurine-Hypotaur-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='taurineHypotaurMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_aminoacyl-tRNA-biosynthesis-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='aminoacyltRNAbios1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Tryptophan-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='tryptophanMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Tyrosine-Metabolism-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='tyrosineMet1') 
print(dPlot)
dev.off()

pdf(paste(metadir1.H,"Violin_Valine-Leucine-Isoleucine-Biosynthesis-Score",date,".pdf",sep=""))
dPlot <- VlnPlot(OvarianSetGrpd.H.1.Orig, features='valineLeucineIsoleucBios1') 
print(dPlot)
dev.off()

```


#Change active identity of a seurat object 
m <- SetIdent(objectname, value = m@meta.data$status)
example
OvarianSetGrpd.1.Resistance <- SetIdent(OvarianSetGrpd.1, value= OvarianSetGrpd.1@meta.data$orig.ident)
OvarianSetGrpd.1.Resistance@active.ident

#UMAPs for paper 
```{r}
OvarianSet.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_Approach1_Seurat-Metabolic-Analysis_SeuratObj-with-Metabolic-Pathway-Scores1_2022-05-19.rds")

metadir1 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_Approach1_Seurat-Metabolic-Analysis_'


pdf(paste(metadir1,"UMAP_OXPHOS-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSet.1, features='OXPHOS1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Glycolysis-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSet.1, features='glycolysis1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Purine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSet.1, features='purineMet1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Pyrimidine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSet.1, features='pyrimidineMet1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

```



#Purine metabolism 
##Import file
```{r}
library(future)
library(ggplot2)
library(bigmemory)
library(Seurat)
library(data.table)
library(dplyr)
library(rdetools)
# library(clustree)
sessionInfo()

plan("multiprocess", workers=16)

options(future.globals.maxSize=134217728000) ### for 128GB * 1024*1024

date = "_2022-06-14"
#figdirOrg = "./Resolution-of-1/OvarianSet_All-Samples_"

metadir1 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Purine Metabolism/OvarianSet_Approach1_Seurat-Purine-Analysis_'

OvarianSet.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Approach 1/OvarianSet_Approach1_Seurat-Metabolic-Analysis_SeuratObj-with-Metabolic-Pathway-Scores1_2022-05-19.rds")

names(OvarianSet.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident"  
### Setting a cluster tab
OvarianSet.1$Cluster <- OvarianSet.1$RNA_snn_res.0.6
OvarianSet.1$name <- OvarianSet.1$orig.ident
names(OvarianSet.1[[]])
# [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"    "RNA_snn_res.0.6" "seurat_clusters" "S.Score"         "G2M.Score"      
# [9] "Phase"           "old.ident"       "Cluster"         "name"   

### Labelling as sensitive and resistant, create structure of meta data based on name, to be filled with new annotations
nameListMtx <- as.matrix(OvarianSet.1$name)
tmp1 <- as.matrix(OvarianSet.1$name)
numCells <- 5091
for (val in 1:numCells) {
### check name
   tmpname <- OvarianSet.1[[]][val,'name']
## from name set CMML or normal
  if (isTRUE(tmpname == "OVCA3_R" || tmpname == "OVCAR4_R")) {
     tmp1[val] <- "resistant"
   } else {
     tmp1[val] <- "sensitive"
   }
 }


OvarianSetGrpd.1 <- OvarianSet.1
#OvarianSetGrpd.1$samptype <- tmp1


names(OvarianSetGrpd.1[[]])
#   [1] "orig.ident"      "nCount_RNA"      "nFeature_RNA"    "percent.mito"   
#   [5] "RNA_snn_res.0.6" "seurat_clusters" "RNA_snn_res.1"   "S.Score"        
#   [9] "G2M.Score"       "Phase"           "old.ident"       "CC.Difference"  
#  [13] "cluster"         "name"  

OVCA3.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_S"))
OVCA3.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_R"))
OVCAR4.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.1 <- c(OVCA3.1_S_cells, OVCA3.1_R_cells, OVCAR4.1_S_cells, OVCAR4.1_R_cells)

OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)

OvarianCellLineGrpd.1@active.ident <- OvarianCellLineGrpd.1$Cluster

Sonly.1 <- c(OVCA3.1_S_cells,OVCAR4.1_S_cells)
Ronly.1 <- c(OVCA3.1_R_cells,OVCAR4.1_R_cells)

OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))
```
##Metabolic Pathway Score Analysis 
```{r}
DeNovogenes <- c('GART','PAICS','ATIC','PPAT','PURL','PurL','ADSL','ADSS','IMPDH1','IMPDH2','GMPS','PKM2','PKM','mTORC1','MTORC1','ADE1','MTHFD2','ADSSL1')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(DeNovogenes), name = "DeNovo", search=TRUE)
#ADE1 not really important, it might not find it 
#Warning: The following features are not present in the object: PURL, PurL, PKM2, mTORC1, MTORC1, ADE1, attempting to find updated synonyms
#Found updated symbols for 1 symbols
#PKM2 -> PKM
#Warning: The following features are still not present in the object: PURL, PurL, mTORC1, MTORC1, ADE1


Salvagegenes <- c('HPRT1','APRT','ADA')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(Salvagegenes), name = "Salvage", search=TRUE)


names(OvarianSetGrpd.1[[]])
# [1] "orig.ident"                "nCount_RNA"                "nFeature_RNA"              "percent.mito"              "RNA_snn_res.0.6"          
# [6] "seurat_clusters"           "S.Score"                   "G2M.Score"                 "Phase"                     "old.ident"                
#[11] "Cluster"                   "name"                      "OXPHOS1"                   "glycolysis1"               "citricAcid1"              
#[16] "ascorbateAldarate1"        "chondroitinSulfate1"       "fructoseMannose1"          "galactose1"                "keratanSulfate1"          
#[21] "heparanSulfate1"           "pentosePhosphate1"         "pyruvateMet1"              "starchSucrose1"            "etherLipidMet1"           
#[26] "arachidonicAcidMet1"       "fattyAcidMet1"             "glycerolipidMet1"          "glycerophospholipidMet1"   "glyoxylateDicarbMet1"     
#[31] "linoleicAcidMet1"          "sphingolipidMet1"          "propanoateMet1"            "pyrimidineMet1"            "purineMet1"               
#[36] "alaniAspratGlutamMet1"     "arginineProlineMet1"       "butanoateMet1"             "glutathioneMet1"           "glycineSerineThreonMet1"  
#[41] "histidineMet1"             "lysineDeg1"                "cysteineMethionineMet1"    "phenylalanineMet1"         "taurineHypotaurMet1"      
#[46] "aminoacyltRNAbios1"        "tryptophanMet1"            "tyrosineMet1"              "valineLeucineIsoleucBios1" "DeNovo1"                  
#[51] "Salvage1"   

saveRDS(OvarianSetGrpd.1, paste(metadir1,"SeuratObj-with-Metabolic-Pathway-Scores-Purine-Metabolism",date,".rds",sep=""))


### Make per sample subsets and export all scores for the sample
OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)
OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))
```


##AFTER CALCULATING SCORES, SUBSET BY TYPE, THEN COMPUTE AVERAGE SCORE PER CELL LINE & EXPORT INDIVIDUAL SCORES
```{r}
OVCAR4.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_S_cells)
OVCAR4.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_R_cells)
OVCA3.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_S_cells)
OVCA3.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_R_cells)


scores.1 <- c("DeNovo1","Salvage1")


averageScores.1 <- function(arg_1, arg_2) {
   # arg_1 == Seurat object 
   # arg_2 == string for use in exporting scores

# export data
  data_scores.1 <- as.data.frame(as.matrix(arg_1[[scores.1]]))

  fwrite(x = data_scores.1, file = paste(metadir1,arg_2,"_scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

  tmp <- list()
  for (val in 1:2)
  {
    tmp[[scores.1[val]]] <- mean(unlist(data_scores.1[val]))
  }
  tmp

  fwrite(x = as.data.frame(tmp), file = paste(metadir1,arg_2,"_average-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

 }
rm(arg_1,arg_2,tmp,val)

# Call the functions
averageScores.1(OVCAR4.1_S,"OVCAR4_S")
averageScores.1(OVCAR4.1_R,"OVCAR4_R")
averageScores.1(OVCA3.1_S,"OVCA3_S")
averageScores.1(OVCA3.1_R,"OVCA3_R")
```


See if I need to change the active identity 

##Do UMAPs
```{r}
#Ovarian Set 
pdf(paste(metadir1,"UMAP_DeNovo-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='DeNovo1') 
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Salvage-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='Salvage1') 
print(dPlot)
dev.off()
```
Change active identity 
##Do violin plots
```{r}
#Change the active identity 
OvarianSetGrpd.1 <- SetIdent(OvarianSetGrpd.1, value= OvarianSetGrpd.1@meta.data$orig.ident) #change the active identity to give information about the resistant and sensitive cell lines 
OvarianSetGrpd.1@active.ident #check if the active identity is the resistant and sensitive cell lines 

pdf(paste(metadir1,"Violin_DeNovo-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'DeNovo1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Salvage-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'Salvage1')
print(vPlot)
dev.off()
```

##Feature plot for different genes 
```{r}
pdf(paste(metadir1,"Feature-Plot",date,".pdf"))
feature <- FeaturePlot(OvarianSetGrpd.1, features =c("PPAT","MTOR","MYC","SHMT2","GLUL","GOT1","GOT2"), min.cutoff="q7")
#The following requested variables were not found: IMPDH
print(feature)
dev.off()
```
Some ways to make feature plots 
FeaturePlot(immune.combined, features = c("CD3D", "SELL", "CREM", "CD8A", "GNLY", "CD79A", "FCGR3A",
    "CCL2", "PPBP"), min.cutoff = "q9")
    
FeaturePlot(immune.combined, features = c("CD3D", "GNLY", "IFI6"), split.by = "stim", max.cutoff = 3,
    cols = c("grey", "red"))
    
Look at PPAT, IMPDH, MYC, SHMT2 (glycine), GLUL, GOT1, GOT2

##Make cvs files including: cell lines, purine pathway scores and clusters 
```{r}
data_scores_OVCAR4.1_R <- as.data.frame(as.matrix(OVCAR4.1_R[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.1_R_clusters <- OVCAR4.1_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.1_R_ALL <- cbind(data_scores_OVCAR4.1_R,OVCAR4.1_R_clusters) #save the whole three columns together
fwrite(x = OVCAR4.1_R_ALL, file = paste(metadir1,"OVCAR4_R","_average-scores_ALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.1_R_ALL, paste(metadir1,"OVCAR4_R","_SeuratObj-with-Purine-Pathway-Scores",date,".rds",sep=""))

#OVCAR4 S 
data_scores_OVCAR4.1_S <- as.data.frame(as.matrix(OVCAR4.1_S[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.1_S_clusters <- OVCAR4.1_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.1_S_ALL <- cbind(data_scores_OVCAR4.1_S,OVCAR4.1_S_clusters) #save the whole three columns together
fwrite(x = OVCAR4.1_S_ALL, file = paste(metadir1,"OVCAR4_S","_average-scores_ALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.1_S_ALL, paste(metadir1,"OVCAR4_S","_SeuratObj-with-Purine-Pathway-Scores",date,".rds",sep=""))

#OVCA3 R
data_scores_OVCA3.1_R <- as.data.frame(as.matrix(OVCA3.1_R[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCA3.1_R_clusters <- OVCA3.1_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.1_R_ALL <- cbind(data_scores_OVCA3.1_R,OVCA3.1_R_clusters) #save the whole three columns together
fwrite(x = OVCA3.1_R_ALL, file = paste(metadir1,"OVCA3_R","_average-scores_ALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.1_R_ALL, paste(metadir1,"OVCA3_R","_SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))

#OVCA3 S
data_scores_OVCA3.1_S <- as.data.frame(as.matrix(OVCA3.1_S[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCA3.1_S_clusters <- OVCA3.1_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.1_S_ALL <- cbind(data_scores_OVCA3.1_S,OVCA3.1_S_clusters) #save the whole three columns together
fwrite(x = OVCA3.1_S_ALL, file = paste(metadir1,"OVCA3_S","_average-scores_ALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.1_S_ALL, paste(metadir1,"OVCA3_S","_SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))
```

##Genes of interest: Make cvs files including: cell lines, genes of interest scores and clusters
Genes of interest list 
feature <- FeaturePlot(OvarianSetGrpd.1, features =c("PPAT","IMPDH"(cant find this one),"MYC","SHMT2","GLUL","GOT1","GOT2"), min.cutoff="q7")

###PPAT 
```{r}
PPAT_gene_scores=FetchData(object=OvarianCellLineGrpd.1, vars=c("PPAT")) #get the scores for that gene paired with the cell type
OvarianSetGrpd.1_clusters <- OvarianSetGrpd.1@meta.data[["seurat_clusters"]] #save the clusters for the entire dataset 
PPAT_OvarianSetGrpd.1 <- cbind(PPAT_gene_scores,OvarianSetGrpd.1_clusters) #create a matrix containing: cell type, gene score, and cluster
fwrite(x= PPAT_OvarianSetGrpd.1, file=paste(metadir1,"_PPAT-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
```
###MYC
```{r}
MYC_gene_scores=FetchData(object=OvarianCellLineGrpd.1, vars=c("MYC")) #get the scores for that gene paired with the cell type
#OvarianSetGrpd.1_clusters <- OvarianSetGrpd.1@meta.data[["seurat_clusters"]] #save the clusters for the entire dataset 
MYC_OvarianSetGrpd.1 <- cbind(MYC_gene_scores,OvarianSetGrpd.1_clusters) #create a matrix containing: cell type, gene score, and cluster
fwrite(x= MYC_OvarianSetGrpd.1, file=paste(metadir1,"_MYC-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
```

###SHMT2
```{r}
SHMT2_gene_scores=FetchData(object=OvarianCellLineGrpd.1, vars=c("SHMT2")) #get the scores for that gene paired with the cell type
#OvarianSetGrpd.1_clusters <- OvarianSetGrpd.1@meta.data[["seurat_clusters"]] #save the clusters for the entire dataset 
SHMT2_OvarianSetGrpd.1 <- cbind(SHMT2_gene_scores,OvarianSetGrpd.1_clusters) #create a matrix containing: cell type, gene score, and cluster
fwrite(x= SHMT2_OvarianSetGrpd.1, file=paste(metadir1,"_SHMT2-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
```

###GLUL
```{r}
GLUL_gene_scores=FetchData(object=OvarianCellLineGrpd.1, vars=c("GLUL")) #get the scores for that gene paired with the cell type
#OvarianSetGrpd.1_clusters <- OvarianSetGrpd.1@meta.data[["seurat_clusters"]] #save the clusters for the entire dataset 
GLUL_OvarianSetGrpd.1 <- cbind(GLUL_gene_scores,OvarianSetGrpd.1_clusters) #create a matrix containing: cell type, gene score, and cluster
fwrite(x= GLUL_OvarianSetGrpd.1, file=paste(metadir1,"_GLUL-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
```

###GOT1
```{r}
GOT1_gene_scores=FetchData(object=OvarianCellLineGrpd.1, vars=c("GOT1")) #get the scores for that gene paired with the cell type
#OvarianSetGrpd.1_clusters <- OvarianSetGrpd.1@meta.data[["seurat_clusters"]] #save the clusters for the entire dataset 
GOT1_OvarianSetGrpd.1 <- cbind(GOT1_gene_scores,OvarianSetGrpd.1_clusters) #create a matrix containing: cell type, gene score, and cluster
fwrite(x= GOT1_OvarianSetGrpd.1, file=paste(metadir1,"_GOT1-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
```

###GOT2 
```{r}
GOT2_gene_scores=FetchData(object=OvarianCellLineGrpd.1, vars=c("GOT2")) #get the scores for that gene paired with the cell type
#OvarianSetGrpd.1_clusters <- OvarianSetGrpd.1@meta.data[["seurat_clusters"]] #save the clusters for the entire dataset 
GOT2_OvarianSetGrpd.1 <- cbind(GOT2_gene_scores,OvarianSetGrpd.1_clusters) #create a matrix containing: cell type, gene score, and cluster
fwrite(x= GOT2_OvarianSetGrpd.1, file=paste(metadir1,"_GOT2-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file
```

###MTORC1
mTORC1 is not on the dataset but M=mTOR is. mTOR is the core of two protein complexes after it has linked with mTORC1 and mTORC2, it is part of the de novo purine pathway
```{r}
MTOR_gene_scores=FetchData(object=OvarianCellLineGrpd.1, vars=c("MTOR")) #get the scores for that gene paired with the cell type
#OvarianSetGrpd.1_clusters <- OvarianSetGrpd.1@meta.data[["seurat_clusters"]] #save the clusters for the entire dataset 
MTOR_OvarianSetGrpd.1 <- cbind(MTOR_gene_scores,OvarianSetGrpd.1_clusters) #create a matrix containing: cell type, gene score, and cluster
fwrite(x= MTOR_OvarianSetGrpd.1, file=paste(metadir1,"_MTOR-scores",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file
```

#Specific pathway analysis 
##Import files
```{r}
library(future)
library(ggplot2)
library(bigmemory)
library(Seurat)
library(data.table)
library(dplyr)
library(rdetools)
# library(clustree)
sessionInfo()

plan("multiprocess", workers=16)

options(future.globals.maxSize=134217728000) ### for 128GB * 1024*1024

date = "_2022-07-07"
#figdirOrg = "./Resolution-of-1/OvarianSet_All-Samples_"

metadir1 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Specific pathways analysis/OvarianSet_Approach1_Seurat-Specific-Analysis_'

OvarianSet.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Purine Metabolism/OvarianSet_Approach1_Seurat-Purine-Analysis_SeuratObj-with-Metabolic-Pathway-Scores-Purine-Metabolism_2022-06-13.rds")

OvarianSetGrpd.1 <- OvarianSet.1
#OvarianSetGrpd.1$samptype <- tmp1


names(OvarianSetGrpd.1[[]])
# [1] "orig.ident"                "nCount_RNA"                "nFeature_RNA"              "percent.mito"              "RNA_snn_res.0.6"          
# [6] "seurat_clusters"           "S.Score"                   "G2M.Score"                 "Phase"                     "old.ident"                
#[11] "Cluster"                   "name"                      "OXPHOS1"                   "glycolysis1"               "citricAcid1"              
#[16] "ascorbateAldarate1"        "chondroitinSulfate1"       "fructoseMannose1"          "galactose1"                "keratanSulfate1"          
#[21] "heparanSulfate1"           "pentosePhosphate1"         "pyruvateMet1"              "starchSucrose1"            "etherLipidMet1"           
#[26] "arachidonicAcidMet1"       "fattyAcidMet1"             "glycerolipidMet1"          "glycerophospholipidMet1"   "glyoxylateDicarbMet1"     
#[31] "linoleicAcidMet1"          "sphingolipidMet1"          "propanoateMet1"            "pyrimidineMet1"            "purineMet1"               
#[36] "alaniAspratGlutamMet1"     "arginineProlineMet1"       "butanoateMet1"             "glutathioneMet1"           "glycineSerineThreonMet1"  
#[41] "histidineMet1"             "lysineDeg1"                "cysteineMethionineMet1"    "phenylalanineMet1"         "taurineHypotaurMet1"      
#[46] "aminoacyltRNAbios1"        "tryptophanMet1"            "tyrosineMet1"              "valineLeucineIsoleucBios1" "DeNovo1"                  
#[51] "Salvage1"  

OVCA3.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_S"))
OVCA3.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_R"))
OVCAR4.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.1 <- c(OVCA3.1_S_cells, OVCA3.1_R_cells, OVCAR4.1_S_cells, OVCAR4.1_R_cells)

OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)

OvarianCellLineGrpd.1@active.ident <- OvarianCellLineGrpd.1$Cluster

Sonly.1 <- c(OVCA3.1_S_cells,OVCAR4.1_S_cells)
Ronly.1 <- c(OVCA3.1_R_cells,OVCAR4.1_R_cells)

OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))
```

##Metabolic Pathway Score Analysis 2.0
Do a UMAP and a violin plot and the scores 
```{r}
#Purine metabolism
PuDeNovogenes <- c('IMPDH2','ADSS2','ATIC','PAICS','IMPDH1','GART','GMPS','LHPP','ADSS1','PFAS','PPAT','ADSL','ADSS','ADSSL1','PKM2')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(PuDeNovogenes), name = "PuDeNovo", search=TRUE)
#Warning: The following features are not present in the object: ADSS2, ADSS1, PKM2, attempting to find updated synonyms

PuSalvagegenes <- c('AMPD1','HPRT1','APRT','GMPR2','DGUOK','DCK','PNP','GMPR','ADK','ADA','AMPD2','AMPD3','ADAL')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(PuSalvagegenes), name = "PuSalvage", search=TRUE)

#Pyrimidine metabolism
PyDeNovogenes <- c('CAD','UMPS','DHODH')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features= list(PyDeNovogenes), name = "PyDeNovo", search=TRUE)

PySalavagegenes <- c('UPP2','DCK','TYMP','UCK1','UCKL1','CDA','PUDP','UPP1','TK2','UCK2')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features= list(PySalavagegenes), name= "PySalvage", search=TRUE)

#Glutamate and glutamine metabolism
Glutaminegenes <- c('ALDH18A1','OAT','PYCR3','GLS','GOT2','GLS2','GLUL','PYCR2','GLUD1','RIMKLB','KYAT1','RIMKLA','GLUD2','PYCR1','PYCR3','GLUD2')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, features = list(Glutaminegenes), name = "Glutamine", search=TRUE)

#Serine metabolism 
Serinegenes <- c('PSAT1','PHGDH','SERINC1','SERINC3','SERINC2','SERINC5','PSPH','SRR')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, feature = list(Serinegenes), name = "Serine", search=TRUE)

#Glycine 
Glycinegenes <- c('AGXT','AGXT2','SHMT1','SHMT2','GLY1')
OvarianSetGrpd.1 <- AddModuleScore(OvarianSetGrpd.1, feature = list(Glycinegenes), name = "Glycine", search=TRUE)
#Warning: The following features are not present in the object: GLY1, attempting to find updated synonyms

names(OvarianSetGrpd.1[[]])
# [1] "orig.ident"                "nCount_RNA"                "nFeature_RNA"              "percent.mito"              "RNA_snn_res.0.6"          
# [6] "seurat_clusters"           "S.Score"                   "G2M.Score"                 "Phase"                     "old.ident"                
#[11] "Cluster"                   "name"                      "OXPHOS1"                   "glycolysis1"               "citricAcid1"              
#[16] "ascorbateAldarate1"        "chondroitinSulfate1"       "fructoseMannose1"          "galactose1"                "keratanSulfate1"          
#[21] "heparanSulfate1"           "pentosePhosphate1"         "pyruvateMet1"              "starchSucrose1"            "etherLipidMet1"           
#[26] "arachidonicAcidMet1"       "fattyAcidMet1"             "glycerolipidMet1"          "glycerophospholipidMet1"   "glyoxylateDicarbMet1"     
#[31] "linoleicAcidMet1"          "sphingolipidMet1"          "propanoateMet1"            "pyrimidineMet1"            "purineMet1"               
#[36] "alaniAspratGlutamMet1"     "arginineProlineMet1"       "butanoateMet1"             "glutathioneMet1"           "glycineSerineThreonMet1"  
#[41] "histidineMet1"             "lysineDeg1"                "cysteineMethionineMet1"    "phenylalanineMet1"         "taurineHypotaurMet1"      
#[46] "aminoacyltRNAbios1"        "tryptophanMet1"            "tyrosineMet1"              "valineLeucineIsoleucBios1" "DeNovo1"                  
#[51] "Salvage1"                  "PuDeNovo1"                 "PuSalvage1"                "PyDeNovo1"                 "PySalvage1"               
#[56] "Glutamine1"                "Serine1"                   "Glycine1" 

saveRDS(OvarianSetGrpd.1, paste(metadir1,"SeuratObj-with-Metabolic-Pathway-Scores",date,".rds",sep=""))


### Make per sample subsets and export all scores for the sample
OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)
OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))
```

Check the name of the pathways 

##AFTER CALCULATING SCORES, SUBSET BY TYPE, THEN COMPUTE AVERAGE SCORE PER CELL LINE & EXPORT INDIVIDUAL SCORES
```{r}
OVCAR4.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_S_cells)
OVCAR4.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_R_cells)
OVCA3.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_S_cells)
OVCA3.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_R_cells)


scores.1 <- c("PuDeNovo1","PuSalvage1","PyDeNovo1","PySalvage1", "Glutamine1","Serine1","Glycine1")


averageScores.1 <- function(arg_1, arg_2) {
   # arg_1 == Seurat object 
   # arg_2 == string for use in exporting scores

# export data
  data_scores.1 <- as.data.frame(as.matrix(arg_1[[scores.1]]))

  fwrite(x = data_scores.1, file = paste(metadir1,arg_2,"_scores1",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

  tmp <- list()
  for (val in 1:2)
  {
    tmp[[scores.1[val]]] <- mean(unlist(data_scores.1[val]))
  }
  tmp

  fwrite(x = as.data.frame(tmp), file = paste(metadir1,arg_2,"_average-scores1",date,".csv",sep=""), row.names=TRUE, col.names=TRUE)

 }
rm(arg_1,arg_2,tmp,val)

# Call the functions
averageScores.1(OVCAR4.1_S,"OVCAR4_S")
averageScores.1(OVCAR4.1_R,"OVCAR4_R")
averageScores.1(OVCA3.1_S,"OVCA3_S")
averageScores.1(OVCA3.1_R,"OVCA3_R")
```
##Do UMAPs
```{r}
#Ovarian Set 
pdf(paste(metadir1,"UMAP_Purine_DeNovo-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='PuDeNovo1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Purine_Salvage-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='PuSalvage1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Pyrimidine_DeNovo-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='PyDeNovo1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Pyrimidine_Salvage-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='PySalvage1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Glutamine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='Glutamine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Serine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='Serine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir1,"UMAP_Glycine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OvarianSetGrpd.1, features='Glycine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()
```

Change active identity, check the active identity  
##Do violin plots
```{r}
#Change the active identity 
OvarianSetGrpd.1 <- SetIdent(OvarianSetGrpd.1, value= OvarianSetGrpd.1@meta.data$orig.ident) #change the active identity to give information about the resistant and sensitive cell lines 
OvarianSetGrpd.1@active.ident #check if the active identity is the resistant and sensitive cell lines 

pdf(paste(metadir1,"Violin_Purine_DeNovo-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'PuDeNovo1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Purine_Salvage-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'PuSalvage1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Pyrimidine_DeNovo-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'PyDeNovo1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Pyrimidine_Salvage-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'PySalvage1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Glutamine-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'Glutamine1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Serine-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'Serine1')
print(vPlot)
dev.off()

pdf(paste(metadir1,"Violin_Glycine-Score",date,".pdf",sep=""))
vPlot <- VlnPlot(object = OvarianSetGrpd.1, features = 'Glycine1')
print(vPlot)
dev.off()
```


##Make cvs files including: cell lines, purine (De Novo and Salvage), pyrimidine (De Novo and Salvage), glutamine, serine and glycine pathway scores and clusters 
```{r}
data_scores_OVCAR4.1_R <- as.data.frame(as.matrix(OVCAR4.1_R[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.1_R_clusters <- OVCAR4.1_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.1_R_ALL <- cbind(data_scores_OVCAR4.1_R,OVCAR4.1_R_clusters) #save the whole three columns together
fwrite(x = OVCAR4.1_R_ALL, file = paste(metadir1,"OVCAR4_R","_average-scores_ALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.1_R_ALL, paste(metadir1,"OVCAR4_R","_SeuratObj-with-Specifc-Pathway-Scores",date,".rds",sep=""))

#OVCAR4 S 
data_scores_OVCAR4.1_S <- as.data.frame(as.matrix(OVCAR4.1_S[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCAR4.1_S_clusters <- OVCAR4.1_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCAR4.1_S_ALL <- cbind(data_scores_OVCAR4.1_S,OVCAR4.1_S_clusters) #save the whole three columns together
fwrite(x = OVCAR4.1_S_ALL, file = paste(metadir1,"OVCAR4_S","_average-scores_ALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCAR4.1_S_ALL, paste(metadir1,"OVCAR4_S","_SeuratObj-with-Specific-Pathway-Scores",date,".rds",sep=""))

#OVCA3 R
data_scores_OVCA3.1_R <- as.data.frame(as.matrix(OVCA3.1_R[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCA3.1_R_clusters <- OVCA3.1_R@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.1_R_ALL <- cbind(data_scores_OVCA3.1_R,OVCA3.1_R_clusters) #save the whole three columns together
fwrite(x = OVCA3.1_R_ALL, file = paste(metadir1,"OVCA3_R","_average-scores_ALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.1_R_ALL, paste(metadir1,"OVCA3_R","_SeuratObj-with-Specific-Pathway-Scores",date,".rds",sep=""))

#OVCA3 S
data_scores_OVCA3.1_S <- as.data.frame(as.matrix(OVCA3.1_S[[scores.1]])) #save the scores and the cell names together
#Check the step below 
OVCA3.1_S_clusters <- OVCA3.1_S@meta.data[["seurat_clusters"]] #save the cluster labels on their own 
OVCA3.1_S_ALL <- cbind(data_scores_OVCA3.1_S,OVCA3.1_S_clusters) #save the whole three columns together
fwrite(x = OVCA3.1_S_ALL, file = paste(metadir1,"OVCA3_S","_average-scores_ALL",date,".csv",sep=""), row.names=TRUE, col.names=TRUE) #save the file 
saveRDS(OVCA3.1_S_ALL, paste(metadir1,"OVCA3_S","_SeuratObj-with-Specific-Pathway-Scores",date,".rds",sep=""))
```
##Feature plots
```{r}
#import the dataset
OvarianSetGrpd.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Specific pathways analysis/OvarianSet_Approach1_Seurat-Specific-Analysis_SeuratObj-with-Metabolic-Pathway-Scores_2022-07-05.rds")

metadir1 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Feature Plots/OvarianSet_Approach1_Seurat-Specific-Analysis_'

plan("multiprocess", workers=16)

options(future.globals.maxSize=134217728000) ### for 128GB * 1024*1024

date = "_2022-08-01"

#OXPHOS metabolism
pdf(paste(metadir1,"OXPHOS-Feature-Plot1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ATP12A", "ATP4A", "ATP4B", "ATP5A1", "ATP5B", "ATP5C1", "ATP5D", "ATP5E", "ATP5F1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q9")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot2",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ATP5G1", "ATP5G1P5", "ATP5G2", "ATP5G3", "ATP5H", "ATP5I", "ATP5J", "ATP5J2", "ATP5L"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q9")
print(feature1)
dev.off()
  #these don't exist

pdf(paste(metadir1,"OXPHOS-Feature-Plot3",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ATP5O", "ATP6", "ATP6AP1", "ATP6V0A1", "ATP6V0A2", "ATP6V0A4", "ATP6V0B", "ATP6V0C", "ATP6V0D1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q9")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot4",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ATP6V0D2", "ATP6V0E1", "ATP6V0E2", "ATP6V1A", "ATP6V1B1", "ATP6V1B2", "ATP6V1C1", "ATP6V1C2", "ATP6V1D", "ATP6V1E1", "ATP6V1E2", "ATP6V1F", "ATP6V1G1", "ATP6V1G2", "ATP6V1G3", "ATP6V1H"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot5",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ATP6V1E1", "ATP6V1E2", "ATP6V1F", "ATP6V1G1", "ATP6V1G2", "ATP6V1G3", "ATP6V1H", "ATP8", "COX1", "COX10", "COX11", "COX15", "COX17", "COX2", "COX3", "COX4I1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot6",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("COX4I2", "COX5A", "COX5B", "COX6A1", "COX6A2", "COX6B1", "COX6B2", "COX6C", "COX6CP3", "COX7A1", "COX7A2", "COX7A2L", "COX7B", "COX7B2", "COX7C", "COX8A"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot7",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("COX8C", "CYC1", "CYTB", "LHPP", "LOC100133737", "LOC642502", "LOC644310", "LOC727947", "ND1", "ND2", "ND3", "ND4", "ND4L", "ND5", "ND6", "NDUFA1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot8",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("NDUFA10", "NDUFA11", "NDUFA2", "NDUFA3", "NDUFA4", "NDUFA4L2", "NDUFA5", "NDUFA6", "NDUFA7", "NDUFA8", "NDUFA9", "NDUFAB1", "NDUFB1", "NDUFB10", "NDUFB2", "NDUFB3"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot9",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("NDUFB4", "NDUFB5", "NDUFB6", "NDUFB7", "NDUFB8", "NDUFB9", "NDUFC1", "NDUFC2", "NDUFS1", "NDUFS2", "NDUFS3", "NDUFS4", "NDUFS5", "NDUFS6", "NDUFS7", "NDUFS8"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot10",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("NDUFV1", "NDUFV2", "NDUFV3", "PPA1", "PPA2", "SDHA", "SDHB", "SDHC", "SDHD", "TCIRG1", "UQCR10", "UQCR11", "UQCRB", "UQCRC1", "UQCRC2", "UQCRFS1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"OXPHOS-Feature-Plot11",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("UQCRH", "UQCRHL", "UQCRQ"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q3")
print(feature1)
dev.off()


#Glycolysis 
pdf(paste(metadir1,"Glycolysis-Feature-Plot1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ACSS1", "ACSS2", "ADH1A", "ADH1B", "ADH1C", "ADH4", "ADH5", "ADH6", "ADH7", "AKR1A1", "ALDH1A3", "ALDH1B1", "ALDH2", "ALDH3A1", "ALDH3A2", "ALDH3B1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"Glycolysis-Feature-Plot2",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ALDH3B2", "ALDH7A1", "ALDH9A1", "ALDOA", "ALDOB", "ALDOC", "BPGM", "DLAT", "DLD", "ENO1", "ENO2", "ENO3", "FBP1", "FBP2", "G6PC", "G6PC2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"Glycolysis-Feature-Plot3",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("GALM", "GAPDH", "GCK", "GPI", "HK1", "HK2", "HK3", "LDHA", "LDHAL6A", "LDHAL6B", "LDHB", "LDHC", "PCK1", "PCK2", "PDHA1", "PDHA2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q16")
print(feature1)
dev.off()

pdf(paste(metadir1,"Glycolysis-Feature-Plot4",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("PDHB", "PFKL", "PFKM", "PFKP", "PGAM1", "PGAM2", "PGAM4", "PGK1", "PGK2", "PGM1", "PGM2", "PKLR", "PKM2", "TPI1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q14")
print(feature1)
dev.off()


#Purine metabolism 
pdf(paste(metadir1,"Purine-Feature-Plot1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ADA", "ADCY1", "ADCY10", "ADCY2", "ADCY3", "ADCY4", "ADCY5", "ADCY6"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot1.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ADCY7", "ADCY8", "ADCY9", "ADK", "ADSL", "ADSS", "ADSSL1", "AK1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot2",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("AK2", "AK4", "AK5", "AK7", "ALLC", "AMPD1", "AMPD2", "AMPD3"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot2.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("APRT", "ATIC", "C17orf48", "CANT1", "DCK", "DGUOK", "ENPP1", "ENPP3"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot3",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ENTPD1", "ENTPD2", "ENTPD3", "ENTPD4", "ENTPD5", "ENTPD6", "ENTPD8", "FHIT"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot3.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("GART", "GDA", "GMPR", "GMPR2", "GMPS", "GUCY1A2", "GUCY1A3", "GUCY1B3"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()


pdf(paste(metadir1,"Purine-Feature-Plot4",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("GUCY2C", "GUCY2D", "GUCY2F", "GUK1", "HPRT1", "IMPDH1", "IMPDH2", "ITPA"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot4.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("NME1", "NME1-NME2", "NME2", "NME3", "NME4", "NME5", "NME6", "NME7"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot5",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("NPR1", "NPR2", "NT5C", "NT5C1A", "NT5C1B", "NT5C2", "NT5C3", "NT5E"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot5.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("NT5M", "NUDT2", "NUDT5", "NUDT9", "PAICS", "PAPSS1", "PAPSS2", "PDE10A"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot6",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("PDE11A", "PDE1A", "PDE1B", "PDE1C", "PDE2A", "PDE3A", "PDE3B", "PDE4A"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot6.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("PDE4B", "PDE4C", "PDE4D", "PDE5A", "PDE6A", "PDE6B", "PDE6C", "PDE6D"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot7",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("PDE6G", "PDE6H", "PDE7A", "PDE7B", "PDE8A", "PDE8B", "PDE9A", "PFAS"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot7.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("PKLR", "PKM2", "PNP", "PNPT1", "POLA1", "POLA2", "POLD1", "POLD2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot8",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLD3", "POLD4", "POLE", "POLE2", "POLE3", "POLE4", "POLR1A", "POLR1B"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot8.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLR1C", "POLR1D", "POLR1E","POLR2A", "POLR2B", "POLR2C", "POLR2D", "POLR2E"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot9",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLR2F", "POLR2G", "POLR2H", "POLR2I", "POLR2J", "POLR2J2", "POLR2J3", "POLR2K"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot9.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLR2L", "POLR3A", "POLR3B", "POLR3C", "POLR3D", "POLR3F", "POLR3G", "POLR3GL"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot10",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLR3H", "POLR3K", "PPAT", "PRHOXNB", "PRIM1", "PRIM2", "PRPS1", "PRPS1L1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Purine-Feature-Plot10.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("PRPS2", "PRUNE", "RRM1", "RRM2", "RRM2B", "XDH", "ZNRD1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q7")
print(feature1)
dev.off()


#Pyrimidine metabolism 
pdf(paste(metadir1,"Pyrimidine-Feature-Plot1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("AK3", "CAD", "CANT1", "CDA", "CMPK1", "CMPK2", "CTPS", "CTPS2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot1.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("DCK", "DCTD", "DHODH", "DPYD", "DPYS", "DTYMK", "DUT", "ENTPD1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()


pdf(paste(metadir1,"Pyrimidine-Feature-Plot2",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ENTPD3", "ENTPD4", "ENTPD5", "ENTPD6", "ENTPD8", "ITPA", "NME1", "NME1-NME2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot2.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("NME2", "NME3", "NME4", "NME5", "NME6", "NME7", "NT5C", "NT5C1A"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot3",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("NT5C1B", "NT5C2", "NT5C3", "NT5E", "NT5M", "NUDT2", "PNP", "PNPT1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot3.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLA1", "POLA2", "POLD1", "POLD2", "POLD3", "POLD4", "POLE", "POLE2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot4",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLE3", "POLE4", "POLR1A", "POLR1B", "POLR1C", "POLR1D", "POLR1E", "POLR2A"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot4.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLR2B", "POLR2C", "POLR2D", "POLR2E", "POLR2F", "POLR2G", "POLR2H", "POLR2I"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot5",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLR2J", "POLR2J2", "POLR2J3", "POLR2K", "POLR2L", "POLR3A", "POLR3B", "POLR3C"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot5.1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("POLR3D", "POLR3F", "POLR3G", "POLR3GL", "POLR3H", "POLR3K", "PRIM1", "PRIM2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot6",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("RRM1", "RRM2", "RRM2B", "TK1", "TK2", "TXNRD1", "TXNRD2", "TYMP", "TYMS"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q9")
print(feature1)
dev.off()

pdf(paste(metadir1,"Pyrimidine-Feature-Plot7",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("UCK1", "UCK2", "UCKL1", "UMPS", "UPB1", "UPP1", "UPP2", "UPRT", "ZNRD1"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q9")
print(feature1)
dev.off()

# Glutamine metabolism 
pdf(paste(metadir1,"Glutamine-Feature-Plot1",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c("ALDH18A1","OAT","PYCR3","GLS","GOT2","GLS2","GLUL","PYCR2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir1,"Glutamine-Feature-Plot2",date,".pdf"))
feature2 <- FeaturePlot(OvarianSetGrpd.1, features=c("GLUD1","RIMKLB","KYAT1","RIMKLA","GLUD2","PYCR1","PYCR3","GLUD2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature2)
dev.off()

#Serine metabolism 
pdf(paste(metadir1,"Serine-Feature-Plot",date,".pdf"))
feature1 <- FeaturePlot(OvarianSetGrpd.1, features=c('PSAT1','PHGDH','SERINC1','SERINC3','SERINC2','SERINC5','PSPH','SRR'), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

```

#Separate cell lines

### Import data 
```{r}
library(future)
library(ggplot2)
library(bigmemory)
library(Seurat)
library(data.table)
library(dplyr)
library(rdetools)
# library(clustree)
sessionInfo()

plan("multiprocess", workers=16)

options(future.globals.maxSize=134217728000) ### for 128GB * 1024*1024

date = "_2022-07-19"
#figdirOrg = "./Resolution-of-1/OvarianSet_All-Samples_"

metadir4 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Separate cell lines from Ovarian Set/OVCAR4_Approach1_Seurat-Specific-Analysis_'
metadir3 <- 'C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Separate cell lines from Ovarian Set/OVCA3_Approach1_Seurat-Specific-Analysis_'

OvarianSet.1 <- readRDS("C:/Users/adelpinoherrera/Dropbox (UFL)/research-share/Adriana/scRNAseq/data/Metabolic Pathway Analysis/Ovarian Set/Specific pathways analysis/OvarianSet_Approach1_Seurat-Specific-Analysis_SeuratObj-with-Metabolic-Pathway-Scores_2022-07-05.rds")

OvarianSetGrpd.1 <- OvarianSet.1
#OvarianSetGrpd.1$samptype <- tmp1


names(OvarianSetGrpd.1[[]])


OVCA3.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_S"))
OVCA3.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCA3_R"))
OVCAR4.1_S_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_S"))
OVCAR4.1_R_cells <- WhichCells(OvarianSetGrpd.1, expression = (orig.ident=="OVCAR4_R"))

celllinesonly.1 <- c(OVCA3.1_S_cells, OVCA3.1_R_cells, OVCAR4.1_S_cells, OVCAR4.1_R_cells)

OvarianCellLineGrpd.1 <- subset(x=OvarianSetGrpd.1, cells=celllinesonly.1)

OvarianCellLineGrpd.1@active.ident <- OvarianCellLineGrpd.1$Cluster

Sonly.1 <- c(OVCA3.1_S_cells,OVCAR4.1_S_cells)
Ronly.1 <- c(OVCA3.1_R_cells,OVCAR4.1_R_cells)

OvarianSensitiveCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Sonly.1)
OvarianResistantCellLines.1 <- subset(x=OvarianCellLineGrpd.1, cells=Ronly.1)

OVCAR4pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCAR4.1_S_cells,OVCAR4.1_R_cells))
OVCA3pair.1 <- subset(x=OvarianCellLineGrpd.1, cells=c(OVCA3.1_S_cells,OVCA3.1_R_cells))
```
### Make per sample subsets and export all scores for the sample
```{r}



OVCAR4.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_S_cells)
OVCAR4.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCAR4.1_R_cells)
OVCA3.1_S <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_S_cells)
OVCA3.1_R <- subset(x=OvarianSetGrpd.1, cells=OVCA3.1_R_cells)
```

## OVCAR4 

### Do UMAPs
```{r}
pdf(paste(metadir4,"UMAP_Purine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='purineMet1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir4,"UMAP_Purine_DeNovo-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='PuDeNovo1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir4,"UMAP_Purine_Salvage-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='PuSalvage1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()


pdf(paste(metadir4,"UMAP_Pyrimidine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='pyrimidineMet1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir4,"UMAP_Pyrimidine_DeNovo-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='PyDeNovo1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir4,"UMAP_Pyrimidine_Salvage-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='PySalvage1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()


pdf(paste(metadir4,"UMAP_Glutamine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='Glutamine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()


pdf(paste(metadir4,"UMAP_Serine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='Serine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()


pdf(paste(metadir4,"UMAP_Glycine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCAR4pair.1, features='Glycine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()
```

### Feature plots
```{r}
# Glutamine metabolism 
pdf(paste(metadir4,"Glutamine-Feature-Plot1",date,".pdf"))
feature1 <- FeaturePlot(OVCAR4pair.1, features=c("ALDH18A1","OAT","PYCR3","GLS","GOT2","GLS2","GLUL","PYCR2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir4,"Glutamine-Feature-Plot2",date,".pdf"))
feature2 <- FeaturePlot(OVCAR4pair.1, features=c("GLUD1","RIMKLB","KYAT1","RIMKLA","GLUD2","PYCR1","PYCR3","GLUD2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature2)
dev.off()

#Serine metabolism 
pdf(paste(metadir4,"Serine-Feature-Plot",date,".pdf"))
feature1 <- FeaturePlot(OVCAR4pair.1, features=c('PSAT1','PHGDH','SERINC1','SERINC3','SERINC2','SERINC5','PSPH','SRR'), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()
```

### UMAP with cell identities
```{r}
pdf(paste(metadir4,"UMAP_CellIdentities",date,".pdf",sep=""), width=12, height=8)
d3Plot <- DimPlot(OVCAR4pair.1, reduction="umap", group.by='orig.ident') + xlim(-14, 14) + ylim(-6, 6)
print(d3Plot)
dev.off()
```

### UMAP with clusters
```{r}
pdf(paste(metadir4,"UMAP_Clusters",date,".pdf",sep=""), width=12, height=8)
d3Plot <- DimPlot(OVCAR4pair.1, reduction="umap", group.by='old.ident') + xlim(-14, 14) + ylim(-6, 6)
print(d3Plot)
dev.off()
```



## OVCA3 

### Do UMAPs
```{r}
pdf(paste(metadir3,"UMAP_Purine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='purineMet1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir3,"UMAP_Purine_DeNovo-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='PuDeNovo1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir3,"UMAP_Purine_Salvage-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='PuSalvage1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()


pdf(paste(metadir3,"UMAP_Pyrimidine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='pyrimidineMet1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir3,"UMAP_Pyrimidine_DeNovo-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='PyDeNovo1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()

pdf(paste(metadir3,"UMAP_Pyrimidine_Salvage-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='PySalvage1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()


pdf(paste(metadir3,"UMAP_Glutamine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='Glutamine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()


pdf(paste(metadir3,"UMAP_Serine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='Serine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()


pdf(paste(metadir3,"UMAP_Glycine-Score",date,".pdf",sep=""))
dPlot <- FeaturePlot(OVCA3pair.1, features='Glycine1') + xlim(-14, 14) + ylim(-6, 6)
print(dPlot)
dev.off()
```

### Feature plots
```{r}
# Glutamine metabolism 
pdf(paste(metadir3,"Glutamine-Feature-Plot1",date,".pdf"))
feature1 <- FeaturePlot(OVCA3pair.1, features=c("ALDH18A1","OAT","PYCR3","GLS","GOT2","GLS2","GLUL","PYCR2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()

pdf(paste(metadir3,"Glutamine-Feature-Plot2",date,".pdf"))
feature2 <- FeaturePlot(OVCA3pair.1, features=c("GLUD1","RIMKLB","KYAT1","RIMKLA","GLUD2","PYCR1","PYCR3","GLUD2"), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature2)
dev.off()

#Serine metabolism 
pdf(paste(metadir3,"Serine-Feature-Plot",date,".pdf"))
feature1 <- FeaturePlot(OVCA3pair.1, features=c('PSAT1','PHGDH','SERINC1','SERINC3','SERINC2','SERINC5','PSPH','SRR'), cols = c ("lightgrey", "blue"), pt.size = 0.05, min.cutoff="q8")
print(feature1)
dev.off()
```

### UMAP with cell identities
```{r}
pdf(paste(metadir3,"UMAP_CellIdentities",date,".pdf",sep=""), width=12, height=8)
d3Plot <- DimPlot(OVCA3pair.1, reduction="umap", group.by='orig.ident') + xlim(-14, 14) + ylim(-6, 6)
print(d3Plot)
dev.off()
```

### UMAP with clusters
```{r}
pdf(paste(metadir3,"UMAP_Clusters",date,".pdf",sep=""), width=12, height=8)
d3Plot <- DimPlot(OVCA3pair.1, reduction="umap", group.by='old.ident') + xlim(-14, 14) + ylim(-6, 6)
print(d3Plot)
dev.off()
```



